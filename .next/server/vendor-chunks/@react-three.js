"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@react-three";
exports.ids = ["vendor-chunks/@react-three"];
exports.modules = {

/***/ "(ssr)/./node_modules/@react-three/drei/core/AccumulativeShadows.js":
/*!********************************************************************!*\
  !*** ./node_modules/@react-three/drei/core/AccumulativeShadows.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AccumulativeShadows: () => (/* binding */ AccumulativeShadows),\n/* harmony export */   RandomizedLight: () => (/* binding */ RandomizedLight),\n/* harmony export */   accumulativeContext: () => (/* binding */ accumulativeContext)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n/* harmony import */ var _shaderMaterial_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shaderMaterial.js */ \"(ssr)/./node_modules/@react-three/drei/core/shaderMaterial.js\");\n/* harmony import */ var _materials_DiscardMaterial_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../materials/DiscardMaterial.js */ \"(ssr)/./node_modules/@react-three/drei/materials/DiscardMaterial.js\");\n/* harmony import */ var _helpers_constants_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/constants.js */ \"(ssr)/./node_modules/@react-three/drei/helpers/constants.js\");\n\n\n\n\n\n\n\nfunction isLight(object) {\n    return object.isLight;\n}\nfunction isGeometry(object) {\n    return !!object.geometry;\n}\nconst accumulativeContext = /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createContext(null);\nconst SoftShadowMaterial = /* @__PURE__ */ (0,_shaderMaterial_js__WEBPACK_IMPORTED_MODULE_2__.shaderMaterial)({\n    color: /* @__PURE__ */ new three__WEBPACK_IMPORTED_MODULE_3__.Color(),\n    blend: 2.0,\n    alphaTest: 0.75,\n    opacity: 0,\n    map: null\n}, `varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vUv = uv;\n   }`, `varying vec2 vUv;\n   uniform sampler2D map;\n   uniform vec3 color;\n   uniform float opacity;\n   uniform float alphaTest;\n   uniform float blend;\n   void main() {\n     vec4 sampledDiffuseColor = texture2D(map, vUv);\n     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);\n     #include <tonemapping_fragment>\n     #include <${_helpers_constants_js__WEBPACK_IMPORTED_MODULE_4__.version >= 154 ? \"colorspace_fragment\" : \"encodings_fragment\"}>\n   }`);\nconst AccumulativeShadows = /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({ children, temporal, frames = 40, limit = Infinity, blend = 20, scale = 10, opacity = 1, alphaTest = 0.75, color = \"black\", colorBlend = 2, resolution = 1024, toneMapped = true, ...props }, forwardRef)=>{\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.e)({\n        SoftShadowMaterial\n    });\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.A)((state)=>state.gl);\n    const scene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.A)((state)=>state.scene);\n    const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.A)((state)=>state.camera);\n    const invalidate = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.A)((state)=>state.invalidate);\n    const gPlane = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const gLights = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const [plm] = react__WEBPACK_IMPORTED_MODULE_1__.useState(()=>new ProgressiveLightMap(gl, scene, resolution));\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        plm.configure(gPlane.current);\n    }, []);\n    const api = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>({\n            lights: new Map(),\n            temporal: !!temporal,\n            frames: Math.max(2, frames),\n            blend: Math.max(2, frames === Infinity ? blend : frames),\n            count: 0,\n            getMesh: ()=>gPlane.current,\n            reset: ()=>{\n                // Clear buffers, reset opacities, set frame count to 0\n                plm.clear();\n                const material = gPlane.current.material;\n                material.opacity = 0;\n                material.alphaTest = 0;\n                api.count = 0;\n            },\n            update: (frames = 1)=>{\n                // Adapt the opacity-blend ratio to the number of frames\n                const material = gPlane.current.material;\n                if (!api.temporal) {\n                    material.opacity = opacity;\n                    material.alphaTest = alphaTest;\n                } else {\n                    material.opacity = Math.min(opacity, material.opacity + opacity / api.blend);\n                    material.alphaTest = Math.min(alphaTest, material.alphaTest + alphaTest / api.blend);\n                }\n                // Switch accumulative lights on\n                gLights.current.visible = true;\n                // Collect scene lights and meshes\n                plm.prepare();\n                // Update the lightmap and the accumulative lights\n                for(let i = 0; i < frames; i++){\n                    api.lights.forEach((light)=>light.update());\n                    plm.update(camera, api.blend);\n                }\n                // Switch lights off\n                gLights.current.visible = false;\n                // Restore lights and meshes\n                plm.finish();\n            }\n        }), [\n        plm,\n        camera,\n        scene,\n        temporal,\n        frames,\n        blend,\n        opacity,\n        alphaTest\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        // Reset internals, buffers, ...\n        api.reset();\n        // Update lightmap\n        if (!api.temporal && api.frames !== Infinity) api.update(api.blend);\n    });\n    // Expose api, allow children to set itself as the main light source\n    react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle(forwardRef, ()=>api, [\n        api\n    ]);\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.C)(()=>{\n        if ((api.temporal || api.frames === Infinity) && api.count < api.frames && api.count < limit) {\n            invalidate();\n            api.update();\n            api.count++;\n        }\n    });\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", props, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", {\n        traverse: ()=>null,\n        ref: gLights\n    }, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(accumulativeContext.Provider, {\n        value: api\n    }, children)), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"mesh\", {\n        receiveShadow: true,\n        ref: gPlane,\n        scale: scale,\n        rotation: [\n            -Math.PI / 2,\n            0,\n            0\n        ]\n    }, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"planeGeometry\", null), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"softShadowMaterial\", {\n        transparent: true,\n        depthWrite: false,\n        toneMapped: toneMapped,\n        color: color,\n        blend: colorBlend,\n        map: plm.progressiveLightMap2.texture\n    })));\n});\nconst RandomizedLight = /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({ castShadow = true, bias = 0.001, mapSize = 512, size = 5, near = 0.5, far = 500, frames = 1, position = [\n    0,\n    0,\n    0\n], radius = 1, amount = 8, intensity = _helpers_constants_js__WEBPACK_IMPORTED_MODULE_4__.version >= 155 ? Math.PI : 1, ambient = 0.5, ...props }, forwardRef)=>{\n    const gLights = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const length = new three__WEBPACK_IMPORTED_MODULE_3__.Vector3(...position).length();\n    const parent = react__WEBPACK_IMPORTED_MODULE_1__.useContext(accumulativeContext);\n    const update = react__WEBPACK_IMPORTED_MODULE_1__.useCallback(()=>{\n        let light;\n        if (gLights.current) {\n            for(let l = 0; l < gLights.current.children.length; l++){\n                light = gLights.current.children[l];\n                if (Math.random() > ambient) {\n                    light.position.set(position[0] + three__WEBPACK_IMPORTED_MODULE_3__.MathUtils.randFloatSpread(radius), position[1] + three__WEBPACK_IMPORTED_MODULE_3__.MathUtils.randFloatSpread(radius), position[2] + three__WEBPACK_IMPORTED_MODULE_3__.MathUtils.randFloatSpread(radius));\n                } else {\n                    let lambda = Math.acos(2 * Math.random() - 1) - Math.PI / 2.0;\n                    let phi = 2 * Math.PI * Math.random();\n                    light.position.set(Math.cos(lambda) * Math.cos(phi) * length, Math.abs(Math.cos(lambda) * Math.sin(phi) * length), Math.sin(lambda) * length);\n                }\n            }\n        }\n    }, [\n        radius,\n        ambient,\n        length,\n        ...position\n    ]);\n    const api = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>({\n            update\n        }), [\n        update\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle(forwardRef, ()=>api, [\n        api\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        var _parent$lights;\n        const group = gLights.current;\n        if (parent) (_parent$lights = parent.lights) == null || _parent$lights.set(group.uuid, api);\n        return ()=>{\n            var _parent$lights2;\n            return void (parent == null || (_parent$lights2 = parent.lights) == null ? void 0 : _parent$lights2.delete(group.uuid));\n        };\n    }, [\n        parent,\n        api\n    ]);\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        ref: gLights\n    }, props), Array.from({\n        length: amount\n    }, (_, index)=>/*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"directionalLight\", {\n            key: index,\n            castShadow: castShadow,\n            \"shadow-bias\": bias,\n            \"shadow-mapSize\": [\n                mapSize,\n                mapSize\n            ],\n            intensity: intensity / amount\n        }, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"orthographicCamera\", {\n            attach: \"shadow-camera\",\n            args: [\n                -size,\n                size,\n                size,\n                -size,\n                near,\n                far\n            ]\n        }))));\n});\n// Based on \"Progressive Light Map Accumulator\", by [zalo](https://github.com/zalo/)\nclass ProgressiveLightMap {\n    constructor(renderer, scene, res = 1024){\n        this.renderer = renderer;\n        this.res = res;\n        this.scene = scene;\n        this.buffer1Active = false;\n        this.lights = [];\n        this.meshes = [];\n        this.object = null;\n        this.clearColor = new three__WEBPACK_IMPORTED_MODULE_3__.Color();\n        this.clearAlpha = 0;\n        // Create the Progressive LightMap Texture\n        const textureParams = {\n            type: three__WEBPACK_IMPORTED_MODULE_3__.HalfFloatType,\n            magFilter: three__WEBPACK_IMPORTED_MODULE_3__.NearestFilter,\n            minFilter: three__WEBPACK_IMPORTED_MODULE_3__.NearestFilter\n        };\n        this.progressiveLightMap1 = new three__WEBPACK_IMPORTED_MODULE_3__.WebGLRenderTarget(this.res, this.res, textureParams);\n        this.progressiveLightMap2 = new three__WEBPACK_IMPORTED_MODULE_3__.WebGLRenderTarget(this.res, this.res, textureParams);\n        // Inject some spicy new logic into a standard phong material\n        this.discardMat = new _materials_DiscardMaterial_js__WEBPACK_IMPORTED_MODULE_6__.DiscardMaterial();\n        this.targetMat = new three__WEBPACK_IMPORTED_MODULE_3__.MeshLambertMaterial({\n            fog: false\n        });\n        this.previousShadowMap = {\n            value: this.progressiveLightMap1.texture\n        };\n        this.averagingWindow = {\n            value: 100\n        };\n        this.targetMat.onBeforeCompile = (shader)=>{\n            // Vertex Shader: Set Vertex Positions to the Unwrapped UV Positions\n            shader.vertexShader = \"varying vec2 vUv;\\n\" + shader.vertexShader.slice(0, -1) + \"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }\";\n            // Fragment Shader: Set Pixels to average in the Previous frame's Shadows\n            const bodyStart = shader.fragmentShader.indexOf(\"void main() {\");\n            shader.fragmentShader = \"varying vec2 vUv;\\n\" + shader.fragmentShader.slice(0, bodyStart) + \"uniform sampler2D previousShadowMap;\\n\tuniform float averagingWindow;\\n\" + shader.fragmentShader.slice(bodyStart - 1, -1) + `\\nvec3 texelOld = texture2D(previousShadowMap, vUv).rgb;\n        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);\n      }`;\n            // Set the Previous Frame's Texture Buffer and Averaging Window\n            shader.uniforms.previousShadowMap = this.previousShadowMap;\n            shader.uniforms.averagingWindow = this.averagingWindow;\n        };\n    }\n    clear() {\n        this.renderer.getClearColor(this.clearColor);\n        this.clearAlpha = this.renderer.getClearAlpha();\n        this.renderer.setClearColor(\"black\", 1);\n        this.renderer.setRenderTarget(this.progressiveLightMap1);\n        this.renderer.clear();\n        this.renderer.setRenderTarget(this.progressiveLightMap2);\n        this.renderer.clear();\n        this.renderer.setRenderTarget(null);\n        this.renderer.setClearColor(this.clearColor, this.clearAlpha);\n        this.lights = [];\n        this.meshes = [];\n        this.scene.traverse((object)=>{\n            if (isGeometry(object)) {\n                this.meshes.push({\n                    object,\n                    material: object.material\n                });\n            } else if (isLight(object)) {\n                this.lights.push({\n                    object,\n                    intensity: object.intensity\n                });\n            }\n        });\n    }\n    prepare() {\n        this.lights.forEach((light)=>light.object.intensity = 0);\n        this.meshes.forEach((mesh)=>mesh.object.material = this.discardMat);\n    }\n    finish() {\n        this.lights.forEach((light)=>light.object.intensity = light.intensity);\n        this.meshes.forEach((mesh)=>mesh.object.material = mesh.material);\n    }\n    configure(object) {\n        this.object = object;\n    }\n    update(camera, blendWindow = 100) {\n        if (!this.object) return;\n        // Set each object's material to the UV Unwrapped Surface Mapping Version\n        this.averagingWindow.value = blendWindow;\n        this.object.material = this.targetMat;\n        // Ping-pong two surface buffers for reading/writing\n        const activeMap = this.buffer1Active ? this.progressiveLightMap1 : this.progressiveLightMap2;\n        const inactiveMap = this.buffer1Active ? this.progressiveLightMap2 : this.progressiveLightMap1;\n        // Render the object's surface maps\n        const oldBg = this.scene.background;\n        this.scene.background = null;\n        this.renderer.setRenderTarget(activeMap);\n        this.previousShadowMap.value = inactiveMap.texture;\n        this.buffer1Active = !this.buffer1Active;\n        this.renderer.render(this.scene, camera);\n        this.renderer.setRenderTarget(null);\n        this.scene.background = oldBg;\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9BY2N1bXVsYXRpdmVTaGFkb3dzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQTBEO0FBQzNCO0FBQ0E7QUFDaUM7QUFDWDtBQUNhO0FBQ2hCO0FBRWxELFNBQVNTLFFBQVFDLE1BQU07SUFDckIsT0FBT0EsT0FBT0QsT0FBTztBQUN2QjtBQUNBLFNBQVNFLFdBQVdELE1BQU07SUFDeEIsT0FBTyxDQUFDLENBQUNBLE9BQU9FLFFBQVE7QUFDMUI7QUFDQSxNQUFNQyxzQkFBc0IsYUFBYSxpQkFBRVgsZ0RBQW1CLENBQUM7QUFDL0QsTUFBTWEscUJBQXFCLGFBQWEsR0FBRVQsa0VBQWNBLENBQUM7SUFDdkRVLE9BQU8sYUFBYSxHQUFFLElBQUlmLHdDQUFXO0lBQ3JDaUIsT0FBTztJQUNQQyxXQUFXO0lBQ1hDLFNBQVM7SUFDVEMsS0FBSztBQUNQLEdBQUcsQ0FBQzs7OztJQUlBLENBQUMsRUFBRSxDQUFDOzs7Ozs7Ozs7O2VBVU8sRUFBRWIsMERBQU9BLElBQUksTUFBTSx3QkFBd0IscUJBQXFCO0lBQzNFLENBQUM7QUFDTCxNQUFNYyxzQkFBc0IsYUFBYSxpQkFBRXBCLDZDQUFnQixDQUFDLENBQUMsRUFDM0RzQixRQUFRLEVBQ1JDLFFBQVEsRUFDUkMsU0FBUyxFQUFFLEVBQ1hDLFFBQVFDLFFBQVEsRUFDaEJWLFFBQVEsRUFBRSxFQUNWVyxRQUFRLEVBQUUsRUFDVlQsVUFBVSxDQUFDLEVBQ1hELFlBQVksSUFBSSxFQUNoQkgsUUFBUSxPQUFPLEVBQ2ZjLGFBQWEsQ0FBQyxFQUNkQyxhQUFhLElBQUksRUFDakJDLGFBQWEsSUFBSSxFQUNqQixHQUFHQyxPQUNKLEVBQUVWO0lBQ0RwQixxREFBTUEsQ0FBQztRQUNMWTtJQUNGO0lBQ0EsTUFBTW1CLEtBQUs5QixxREFBUUEsQ0FBQytCLENBQUFBLFFBQVNBLE1BQU1ELEVBQUU7SUFDckMsTUFBTUUsUUFBUWhDLHFEQUFR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SUFBSSxDQUFDLElBQUksQ0FBQ2pKLE1BQU0sRUFBRTtRQUNsQix5RUFBeUU7UUFDekUsSUFBSSxDQUFDa0ksZUFBZSxDQUFDcEUsS0FBSyxHQUFHbUY7UUFDN0IsSUFBSSxDQUFDakosTUFBTSxDQUFDZ0QsUUFBUSxHQUFHLElBQUksQ0FBQzhFLFNBQVM7UUFDckMsb0RBQW9EO1FBQ3BELE1BQU1vQixZQUFZLElBQUksQ0FBQ2pDLGFBQWEsR0FBRyxJQUFJLENBQUNVLG9CQUFvQixHQUFHLElBQUksQ0FBQ3ZELG9CQUFvQjtRQUM1RixNQUFNK0UsY0FBYyxJQUFJLENBQUNsQyxhQUFhLEdBQUcsSUFBSSxDQUFDN0Msb0JBQW9CLEdBQUcsSUFBSSxDQUFDdUQsb0JBQW9CO1FBQzlGLG1DQUFtQztRQUNuQyxNQUFNeUIsUUFBUSxJQUFJLENBQUMxSCxLQUFLLENBQUMySCxVQUFVO1FBQ25DLElBQUksQ0FBQzNILEtBQUssQ0FBQzJILFVBQVUsR0FBRztRQUN4QixJQUFJLENBQUN0QyxRQUFRLENBQUMrQixlQUFlLENBQUNJO1FBQzlCLElBQUksQ0FBQ2pCLGlCQUFpQixDQUFDbkUsS0FBSyxHQUFHcUYsWUFBWTlFLE9BQU87UUFDbEQsSUFBSSxDQUFDNEMsYUFBYSxHQUFHLENBQUMsSUFBSSxDQUFDQSxhQUFhO1FBQ3hDLElBQUksQ0FBQ0YsUUFBUSxDQUFDdUMsTUFBTSxDQUFDLElBQUksQ0FBQzVILEtBQUssRUFBRUM7UUFDakMsSUFBSSxDQUFDb0YsUUFBUSxDQUFDK0IsZUFBZSxDQUFDO1FBQzlCLElBQUksQ0FBQ3BILEtBQUssQ0FBQzJILFVBQVUsR0FBR0Q7SUFDMUI7QUFDRjtBQUVxRSIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2NvcmUvQWNjdW11bGF0aXZlU2hhZG93cy5qcz80MDI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfZXh0ZW5kcyBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzJztcbmltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGV4dGVuZCwgdXNlVGhyZWUsIHVzZUZyYW1lIH0gZnJvbSAnQHJlYWN0LXRocmVlL2ZpYmVyJztcbmltcG9ydCB7IHNoYWRlck1hdGVyaWFsIH0gZnJvbSAnLi9zaGFkZXJNYXRlcmlhbC5qcyc7XG5pbXBvcnQgeyBEaXNjYXJkTWF0ZXJpYWwgfSBmcm9tICcuLi9tYXRlcmlhbHMvRGlzY2FyZE1hdGVyaWFsLmpzJztcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tICcuLi9oZWxwZXJzL2NvbnN0YW50cy5qcyc7XG5cbmZ1bmN0aW9uIGlzTGlnaHQob2JqZWN0KSB7XG4gIHJldHVybiBvYmplY3QuaXNMaWdodDtcbn1cbmZ1bmN0aW9uIGlzR2VvbWV0cnkob2JqZWN0KSB7XG4gIHJldHVybiAhIW9iamVjdC5nZW9tZXRyeTtcbn1cbmNvbnN0IGFjY3VtdWxhdGl2ZUNvbnRleHQgPSAvKiBAX19QVVJFX18gKi9SZWFjdC5jcmVhdGVDb250ZXh0KG51bGwpO1xuY29uc3QgU29mdFNoYWRvd01hdGVyaWFsID0gLyogQF9fUFVSRV9fICovc2hhZGVyTWF0ZXJpYWwoe1xuICBjb2xvcjogLyogQF9fUFVSRV9fICovbmV3IFRIUkVFLkNvbG9yKCksXG4gIGJsZW5kOiAyLjAsXG4gIGFscGhhVGVzdDogMC43NSxcbiAgb3BhY2l0eTogMCxcbiAgbWFwOiBudWxsXG59LCBgdmFyeWluZyB2ZWMyIHZVdjtcbiAgIHZvaWQgbWFpbigpIHtcbiAgICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmlld01hdHJpeCAqIG1vZGVsTWF0cml4ICogdmVjNChwb3NpdGlvbiwgMS4pO1xuICAgICB2VXYgPSB1djtcbiAgIH1gLCBgdmFyeWluZyB2ZWMyIHZVdjtcbiAgIHVuaWZvcm0gc2FtcGxlcjJEIG1hcDtcbiAgIHVuaWZvcm0gdmVjMyBjb2xvcjtcbiAgIHVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbiAgIHVuaWZvcm0gZmxvYXQgYWxwaGFUZXN0O1xuICAgdW5pZm9ybSBmbG9hdCBibGVuZDtcbiAgIHZvaWQgbWFpbigpIHtcbiAgICAgdmVjNCBzYW1wbGVkRGlmZnVzZUNvbG9yID0gdGV4dHVyZTJEKG1hcCwgdlV2KTtcbiAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2xvciAqIHNhbXBsZWREaWZmdXNlQ29sb3IuciAqIGJsZW5kLCBtYXgoMC4wLCAoMS4wIC0gKHNhbXBsZWREaWZmdXNlQ29sb3IuciArIHNhbXBsZWREaWZmdXNlQ29sb3IuZyArIHNhbXBsZWREaWZmdXNlQ29sb3IuYikgLyBhbHBoYVRlc3QpKSAqIG9wYWNpdHkpO1xuICAgICAjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4gICAgICNpbmNsdWRlIDwke3ZlcnNpb24gPj0gMTU0ID8gJ2NvbG9yc3BhY2VfZnJhZ21lbnQnIDogJ2VuY29kaW5nc19mcmFnbWVudCd9PlxuICAgfWApO1xuY29uc3QgQWNjdW11bGF0aXZlU2hhZG93cyA9IC8qIEBfX1BVUkVfXyAqL1JlYWN0LmZvcndhcmRSZWYoKHtcbiAgY2hpbGRyZW4sXG4gIHRlbXBvcmFsLFxuICBmcmFtZXMgPSA0MCxcbiAgbGltaXQgPSBJbmZpbml0eSxcbiAgYmxlbmQgPSAyMCxcbiAgc2NhbGUgPSAxMCxcbiAgb3BhY2l0eSA9IDEsXG4gIGFscGhhVGVzdCA9IDAuNzUsXG4gIGNvbG9yID0gJ2JsYWNrJyxcbiAgY29sb3JCbGVuZCA9IDIsXG4gIHJlc29sdXRpb24gPSAxMDI0LFxuICB0b25lTWFwcGVkID0gdHJ1ZSxcbiAgLi4ucHJvcHNcbn0sIGZvcndhcmRSZWYpID0+IHtcbiAgZXh0ZW5kKHtcbiAgICBTb2Z0U2hhZG93TWF0ZXJpYWxcbiAgfSk7XG4gIGNvbnN0IGdsID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuZ2wpO1xuICBjb25zdCBzY2VuZSA9IHVzZVRocmVlKHN0YXRlID0+IHN0YXRlLnNjZW5lKTtcbiAgY29uc3QgY2FtZXJhID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuY2FtZXJhKTtcbiAgY29uc3QgaW52YWxpZGF0ZSA9IHVzZVRocmVlKHN0YXRlID0+IHN0YXRlLmludmFsaWRhdGUpO1xuICBjb25zdCBnUGxhbmUgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIGNvbnN0IGdMaWdodHMgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIGNvbnN0IFtwbG1dID0gUmVhY3QudXNlU3RhdGUoKCkgPT4gbmV3IFByb2dyZXNzaXZlTGlnaHRNYXAoZ2wsIHNjZW5lLCByZXNvbHV0aW9uKSk7XG4gIFJlYWN0LnVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgcGxtLmNvbmZpZ3VyZShnUGxhbmUuY3VycmVudCk7XG4gIH0sIFtdKTtcbiAgY29uc3QgYXBpID0gUmVhY3QudXNlTWVtbygoKSA9PiAoe1xuICAgIGxpZ2h0czogbmV3IE1hcCgpLFxuICAgIHRlbXBvcmFsOiAhIXRlbXBvcmFsLFxuICAgIGZyYW1lczogTWF0aC5tYXgoMiwgZnJhbWVzKSxcbiAgICBibGVuZDogTWF0aC5tYXgoMiwgZnJhbWVzID09PSBJbmZpbml0eSA/IGJsZW5kIDogZnJhbWVzKSxcbiAgICBjb3VudDogMCxcbiAgICBnZXRNZXNoOiAoKSA9PiBnUGxhbmUuY3VycmVudCxcbiAgICByZXNldDogKCkgPT4ge1xuICAgICAgLy8gQ2xlYXIgYnVmZmVycywgcmVzZXQgb3BhY2l0aWVzLCBzZXQgZnJhbWUgY291bnQgdG8gMFxuICAgICAgcGxtLmNsZWFyKCk7XG4gICAgICBjb25zdCBtYXRlcmlhbCA9IGdQbGFuZS5jdXJyZW50Lm1hdGVyaWFsO1xuICAgICAgbWF0ZXJpYWwub3BhY2l0eSA9IDA7XG4gICAgICBtYXRlcmlhbC5hbHBoYVRlc3QgPSAwO1xuICAgICAgYXBpLmNvdW50ID0gMDtcbiAgICB9LFxuICAgIHVwZGF0ZTogKGZyYW1lcyA9IDEpID0+IHtcbiAgICAgIC8vIEFkYXB0IHRoZSBvcGFjaXR5LWJsZW5kIHJhdGlvIHRvIHRoZSBudW1iZXIgb2YgZnJhbWVzXG4gICAgICBjb25zdCBtYXRlcmlhbCA9IGdQbGFuZS5jdXJyZW50Lm1hdGVyaWFsO1xuICAgICAgaWYgKCFhcGkudGVtcG9yYWwpIHtcbiAgICAgICAgbWF0ZXJpYWwub3BhY2l0eSA9IG9wYWNpdHk7XG4gICAgICAgIG1hdGVyaWFsLmFscGhhVGVzdCA9IGFscGhhVGVzdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1hdGVyaWFsLm9wYWNpdHkgPSBNYXRoLm1pbihvcGFjaXR5LCBtYXRlcmlhbC5vcGFjaXR5ICsgb3BhY2l0eSAvIGFwaS5ibGVuZCk7XG4gICAgICAgIG1hdGVyaWFsLmFscGhhVGVzdCA9IE1hdGgubWluKGFscGhhVGVzdCwgbWF0ZXJpYWwuYWxwaGFUZXN0ICsgYWxwaGFUZXN0IC8gYXBpLmJsZW5kKTtcbiAgICAgIH1cblxuICAgICAgLy8gU3dpdGNoIGFjY3VtdWxhdGl2ZSBsaWdodHMgb25cbiAgICAgIGdMaWdodHMuY3VycmVudC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIC8vIENvbGxlY3Qgc2NlbmUgbGlnaHRzIGFuZCBtZXNoZXNcbiAgICAgIHBsbS5wcmVwYXJlKCk7XG5cbiAgICAgIC8vIFVwZGF0ZSB0aGUgbGlnaHRtYXAgYW5kIHRoZSBhY2N1bXVsYXRpdmUgbGlnaHRzXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZyYW1lczsgaSsrKSB7XG4gICAgICAgIGFwaS5saWdodHMuZm9yRWFjaChsaWdodCA9PiBsaWdodC51cGRhdGUoKSk7XG4gICAgICAgIHBsbS51cGRhdGUoY2FtZXJhLCBhcGkuYmxlbmQpO1xuICAgICAgfVxuICAgICAgLy8gU3dpdGNoIGxpZ2h0cyBvZmZcbiAgICAgIGdMaWdodHMuY3VycmVudC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAvLyBSZXN0b3JlIGxpZ2h0cyBhbmQgbWVzaGVzXG4gICAgICBwbG0uZmluaXNoKCk7XG4gICAgfVxuICB9KSwgW3BsbSwgY2FtZXJhLCBzY2VuZSwgdGVtcG9yYWwsIGZyYW1lcywgYmxlbmQsIG9wYWNpdHksIGFscGhhVGVzdF0pO1xuICBSZWFjdC51c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFJlc2V0IGludGVybmFscywgYnVmZmVycywgLi4uXG4gICAgYXBpLnJlc2V0KCk7XG4gICAgLy8gVXBkYXRlIGxpZ2h0bWFwXG4gICAgaWYgKCFhcGkudGVtcG9yYWwgJiYgYXBpLmZyYW1lcyAhPT0gSW5maW5pdHkpIGFwaS51cGRhdGUoYXBpLmJsZW5kKTtcbiAgfSk7XG5cbiAgLy8gRXhwb3NlIGFwaSwgYWxsb3cgY2hpbGRyZW4gdG8gc2V0IGl0c2VsZiBhcyB0aGUgbWFpbiBsaWdodCBzb3VyY2VcbiAgUmVhY3QudXNlSW1wZXJhdGl2ZUhhbmRsZShmb3J3YXJkUmVmLCAoKSA9PiBhcGksIFthcGldKTtcbiAgdXNlRnJhbWUoKCkgPT4ge1xuICAgIGlmICgoYXBpLnRlbXBvcmFsIHx8IGFwaS5mcmFtZXMgPT09IEluZmluaXR5KSAmJiBhcGkuY291bnQgPCBhcGkuZnJhbWVzICYmIGFwaS5jb3VudCA8IGxpbWl0KSB7XG4gICAgICBpbnZhbGlkYXRlKCk7XG4gICAgICBhcGkudXBkYXRlKCk7XG4gICAgICBhcGkuY291bnQrKztcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJncm91cFwiLCBwcm9wcywgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJncm91cFwiLCB7XG4gICAgdHJhdmVyc2U6ICgpID0+IG51bGwsXG4gICAgcmVmOiBnTGlnaHRzXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KGFjY3VtdWxhdGl2ZUNvbnRleHQuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZTogYXBpXG4gIH0sIGNoaWxkcmVuKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwibWVzaFwiLCB7XG4gICAgcmVjZWl2ZVNoYWRvdzogdHJ1ZSxcbiAgICByZWY6IGdQbGFuZSxcbiAgICBzY2FsZTogc2NhbGUsXG4gICAgcm90YXRpb246IFstTWF0aC5QSSAvIDIsIDAsIDBdXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwicGxhbmVHZW9tZXRyeVwiLCBudWxsKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzb2Z0U2hhZG93TWF0ZXJpYWxcIiwge1xuICAgIHRyYW5zcGFyZW50OiB0cnVlLFxuICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxuICAgIHRvbmVNYXBwZWQ6IHRvbmVNYXBwZWQsXG4gICAgY29sb3I6IGNvbG9yLFxuICAgIGJsZW5kOiBjb2xvckJsZW5kLFxuICAgIG1hcDogcGxtLnByb2dyZXNzaXZlTGlnaHRNYXAyLnRleHR1cmVcbiAgfSkpKTtcbn0pO1xuY29uc3QgUmFuZG9taXplZExpZ2h0ID0gLyogQF9fUFVSRV9fICovUmVhY3QuZm9yd2FyZFJlZigoe1xuICBjYXN0U2hhZG93ID0gdHJ1ZSxcbiAgYmlhcyA9IDAuMDAxLFxuICBtYXBTaXplID0gNTEyLFxuICBzaXplID0gNSxcbiAgbmVhciA9IDAuNSxcbiAgZmFyID0gNTAwLFxuICBmcmFtZXMgPSAxLFxuICBwb3NpdGlvbiA9IFswLCAwLCAwXSxcbiAgcmFkaXVzID0gMSxcbiAgYW1vdW50ID0gOCxcbiAgaW50ZW5zaXR5ID0gdmVyc2lvbiA+PSAxNTUgPyBNYXRoLlBJIDogMSxcbiAgYW1iaWVudCA9IDAuNSxcbiAgLi4ucHJvcHNcbn0sIGZvcndhcmRSZWYpID0+IHtcbiAgY29uc3QgZ0xpZ2h0cyA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgY29uc3QgbGVuZ3RoID0gbmV3IFRIUkVFLlZlY3RvcjMoLi4ucG9zaXRpb24pLmxlbmd0aCgpO1xuICBjb25zdCBwYXJlbnQgPSBSZWFjdC51c2VDb250ZXh0KGFjY3VtdWxhdGl2ZUNvbnRleHQpO1xuICBjb25zdCB1cGRhdGUgPSBSZWFjdC51c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgbGV0IGxpZ2h0O1xuICAgIGlmIChnTGlnaHRzLmN1cnJlbnQpIHtcbiAgICAgIGZvciAobGV0IGwgPSAwOyBsIDwgZ0xpZ2h0cy5jdXJyZW50LmNoaWxkcmVuLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgIGxpZ2h0ID0gZ0xpZ2h0cy5jdXJyZW50LmNoaWxkcmVuW2xdO1xuICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IGFtYmllbnQpIHtcbiAgICAgICAgICBsaWdodC5wb3NpdGlvbi5zZXQocG9zaXRpb25bMF0gKyBUSFJFRS5NYXRoVXRpbHMucmFuZEZsb2F0U3ByZWFkKHJhZGl1cyksIHBvc2l0aW9uWzFdICsgVEhSRUUuTWF0aFV0aWxzLnJhbmRGbG9hdFNwcmVhZChyYWRpdXMpLCBwb3NpdGlvblsyXSArIFRIUkVFLk1hdGhVdGlscy5yYW5kRmxvYXRTcHJlYWQocmFkaXVzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGV0IGxhbWJkYSA9IE1hdGguYWNvcygyICogTWF0aC5yYW5kb20oKSAtIDEpIC0gTWF0aC5QSSAvIDIuMDtcbiAgICAgICAgICBsZXQgcGhpID0gMiAqIE1hdGguUEkgKiBNYXRoLnJhbmRvbSgpO1xuICAgICAgICAgIGxpZ2h0LnBvc2l0aW9uLnNldChNYXRoLmNvcyhsYW1iZGEpICogTWF0aC5jb3MocGhpKSAqIGxlbmd0aCwgTWF0aC5hYnMoTWF0aC5jb3MobGFtYmRhKSAqIE1hdGguc2luKHBoaSkgKiBsZW5ndGgpLCBNYXRoLnNpbihsYW1iZGEpICogbGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwgW3JhZGl1cywgYW1iaWVudCwgbGVuZ3RoLCAuLi5wb3NpdGlvbl0pO1xuICBjb25zdCBhcGkgPSBSZWFjdC51c2VNZW1vKCgpID0+ICh7XG4gICAgdXBkYXRlXG4gIH0pLCBbdXBkYXRlXSk7XG4gIFJlYWN0LnVzZUltcGVyYXRpdmVIYW5kbGUoZm9yd2FyZFJlZiwgKCkgPT4gYXBpLCBbYXBpXSk7XG4gIFJlYWN0LnVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgdmFyIF9wYXJlbnQkbGlnaHRzO1xuICAgIGNvbnN0IGdyb3VwID0gZ0xpZ2h0cy5jdXJyZW50O1xuICAgIGlmIChwYXJlbnQpIChfcGFyZW50JGxpZ2h0cyA9IHBhcmVudC5saWdodHMpID09IG51bGwgfHwgX3BhcmVudCRsaWdodHMuc2V0KGdyb3VwLnV1aWQsIGFwaSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHZhciBfcGFyZW50JGxpZ2h0czI7XG4gICAgICByZXR1cm4gdm9pZCAocGFyZW50ID09IG51bGwgfHwgKF9wYXJlbnQkbGlnaHRzMiA9IHBhcmVudC5saWdodHMpID09IG51bGwgPyB2b2lkIDAgOiBfcGFyZW50JGxpZ2h0czIuZGVsZXRlKGdyb3VwLnV1aWQpKTtcbiAgICB9O1xuICB9LCBbcGFyZW50LCBhcGldKTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZ3JvdXBcIiwgX2V4dGVuZHMoe1xuICAgIHJlZjogZ0xpZ2h0c1xuICB9LCBwcm9wcyksIEFycmF5LmZyb20oe1xuICAgIGxlbmd0aDogYW1vdW50XG4gIH0sIChfLCBpbmRleCkgPT4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXJlY3Rpb25hbExpZ2h0XCIsIHtcbiAgICBrZXk6IGluZGV4LFxuICAgIGNhc3RTaGFkb3c6IGNhc3RTaGFkb3csXG4gICAgXCJzaGFkb3ctYmlhc1wiOiBiaWFzLFxuICAgIFwic2hhZG93LW1hcFNpemVcIjogW21hcFNpemUsIG1hcFNpemVdLFxuICAgIGludGVuc2l0eTogaW50ZW5zaXR5IC8gYW1vdW50XG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwib3J0aG9ncmFwaGljQ2FtZXJhXCIsIHtcbiAgICBhdHRhY2g6IFwic2hhZG93LWNhbWVyYVwiLFxuICAgIGFyZ3M6IFstc2l6ZSwgc2l6ZSwgc2l6ZSwgLXNpemUsIG5lYXIsIGZhcl1cbiAgfSkpKSk7XG59KTtcblxuLy8gQmFzZWQgb24gXCJQcm9ncmVzc2l2ZSBMaWdodCBNYXAgQWNjdW11bGF0b3JcIiwgYnkgW3phbG9dKGh0dHBzOi8vZ2l0aHViLmNvbS96YWxvLylcbmNsYXNzIFByb2dyZXNzaXZlTGlnaHRNYXAge1xuICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgc2NlbmUsIHJlcyA9IDEwMjQpIHtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5yZXMgPSByZXM7XG4gICAgdGhpcy5zY2VuZSA9IHNjZW5lO1xuICAgIHRoaXMuYnVmZmVyMUFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMubGlnaHRzID0gW107XG4gICAgdGhpcy5tZXNoZXMgPSBbXTtcbiAgICB0aGlzLm9iamVjdCA9IG51bGw7XG4gICAgdGhpcy5jbGVhckNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCk7XG4gICAgdGhpcy5jbGVhckFscGhhID0gMDtcblxuICAgIC8vIENyZWF0ZSB0aGUgUHJvZ3Jlc3NpdmUgTGlnaHRNYXAgVGV4dHVyZVxuICAgIGNvbnN0IHRleHR1cmVQYXJhbXMgPSB7XG4gICAgICB0eXBlOiBUSFJFRS5IYWxmRmxvYXRUeXBlLFxuICAgICAgbWFnRmlsdGVyOiBUSFJFRS5OZWFyZXN0RmlsdGVyLFxuICAgICAgbWluRmlsdGVyOiBUSFJFRS5OZWFyZXN0RmlsdGVyXG4gICAgfTtcbiAgICB0aGlzLnByb2dyZXNzaXZlTGlnaHRNYXAxID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0KHRoaXMucmVzLCB0aGlzLnJlcywgdGV4dHVyZVBhcmFtcyk7XG4gICAgdGhpcy5wcm9ncmVzc2l2ZUxpZ2h0TWFwMiA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlclRhcmdldCh0aGlzLnJlcywgdGhpcy5yZXMsIHRleHR1cmVQYXJhbXMpO1xuXG4gICAgLy8gSW5qZWN0IHNvbWUgc3BpY3kgbmV3IGxvZ2ljIGludG8gYSBzdGFuZGFyZCBwaG9uZyBtYXRlcmlhbFxuICAgIHRoaXMuZGlzY2FyZE1hdCA9IG5ldyBEaXNjYXJkTWF0ZXJpYWwoKTtcbiAgICB0aGlzLnRhcmdldE1hdCA9IG5ldyBUSFJFRS5NZXNoTGFtYmVydE1hdGVyaWFsKHtcbiAgICAgIGZvZzogZmFsc2VcbiAgICB9KTtcbiAgICB0aGlzLnByZXZpb3VzU2hhZG93TWFwID0ge1xuICAgICAgdmFsdWU6IHRoaXMucHJvZ3Jlc3NpdmVMaWdodE1hcDEudGV4dHVyZVxuICAgIH07XG4gICAgdGhpcy5hdmVyYWdpbmdXaW5kb3cgPSB7XG4gICAgICB2YWx1ZTogMTAwXG4gICAgfTtcbiAgICB0aGlzLnRhcmdldE1hdC5vbkJlZm9yZUNvbXBpbGUgPSBzaGFkZXIgPT4ge1xuICAgICAgLy8gVmVydGV4IFNoYWRlcjogU2V0IFZlcnRleCBQb3NpdGlvbnMgdG8gdGhlIFVud3JhcHBlZCBVViBQb3NpdGlvbnNcbiAgICAgIHNoYWRlci52ZXJ0ZXhTaGFkZXIgPSAndmFyeWluZyB2ZWMyIHZVdjtcXG4nICsgc2hhZGVyLnZlcnRleFNoYWRlci5zbGljZSgwLCAtMSkgKyAndlV2ID0gdXY7IGdsX1Bvc2l0aW9uID0gdmVjNCgodXYgLSAwLjUpICogMi4wLCAxLjAsIDEuMCk7IH0nO1xuXG4gICAgICAvLyBGcmFnbWVudCBTaGFkZXI6IFNldCBQaXhlbHMgdG8gYXZlcmFnZSBpbiB0aGUgUHJldmlvdXMgZnJhbWUncyBTaGFkb3dzXG4gICAgICBjb25zdCBib2R5U3RhcnQgPSBzaGFkZXIuZnJhZ21lbnRTaGFkZXIuaW5kZXhPZigndm9pZCBtYWluKCkgeycpO1xuICAgICAgc2hhZGVyLmZyYWdtZW50U2hhZGVyID0gJ3ZhcnlpbmcgdmVjMiB2VXY7XFxuJyArIHNoYWRlci5mcmFnbWVudFNoYWRlci5zbGljZSgwLCBib2R5U3RhcnQpICsgJ3VuaWZvcm0gc2FtcGxlcjJEIHByZXZpb3VzU2hhZG93TWFwO1xcblx0dW5pZm9ybSBmbG9hdCBhdmVyYWdpbmdXaW5kb3c7XFxuJyArIHNoYWRlci5mcmFnbWVudFNoYWRlci5zbGljZShib2R5U3RhcnQgLSAxLCAtMSkgKyBgXFxudmVjMyB0ZXhlbE9sZCA9IHRleHR1cmUyRChwcmV2aW91c1NoYWRvd01hcCwgdlV2KS5yZ2I7XG4gICAgICAgIGdsX0ZyYWdDb2xvci5yZ2IgPSBtaXgodGV4ZWxPbGQsIGdsX0ZyYWdDb2xvci5yZ2IsIDEuMC8gYXZlcmFnaW5nV2luZG93KTtcbiAgICAgIH1gO1xuXG4gICAgICAvLyBTZXQgdGhlIFByZXZpb3VzIEZyYW1lJ3MgVGV4dHVyZSBCdWZmZXIgYW5kIEF2ZXJhZ2luZyBXaW5kb3dcbiAgICAgIHNoYWRlci51bmlmb3Jtcy5wcmV2aW91c1NoYWRvd01hcCA9IHRoaXMucHJldmlvdXNTaGFkb3dNYXA7XG4gICAgICBzaGFkZXIudW5pZm9ybXMuYXZlcmFnaW5nV2luZG93ID0gdGhpcy5hdmVyYWdpbmdXaW5kb3c7XG4gICAgfTtcbiAgfVxuICBjbGVhcigpIHtcbiAgICB0aGlzLnJlbmRlcmVyLmdldENsZWFyQ29sb3IodGhpcy5jbGVhckNvbG9yKTtcbiAgICB0aGlzLmNsZWFyQWxwaGEgPSB0aGlzLnJlbmRlcmVyLmdldENsZWFyQWxwaGEoKTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldENsZWFyQ29sb3IoJ2JsYWNrJywgMSk7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQodGhpcy5wcm9ncmVzc2l2ZUxpZ2h0TWFwMSk7XG4gICAgdGhpcy5yZW5kZXJlci5jbGVhcigpO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KHRoaXMucHJvZ3Jlc3NpdmVMaWdodE1hcDIpO1xuICAgIHRoaXMucmVuZGVyZXIuY2xlYXIoKTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldFJlbmRlclRhcmdldChudWxsKTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldENsZWFyQ29sb3IodGhpcy5jbGVhckNvbG9yLCB0aGlzLmNsZWFyQWxwaGEpO1xuICAgIHRoaXMubGlnaHRzID0gW107XG4gICAgdGhpcy5tZXNoZXMgPSBbXTtcbiAgICB0aGlzLnNjZW5lLnRyYXZlcnNlKG9iamVjdCA9PiB7XG4gICAgICBpZiAoaXNHZW9tZXRyeShvYmplY3QpKSB7XG4gICAgICAgIHRoaXMubWVzaGVzLnB1c2goe1xuICAgICAgICAgIG9iamVjdCxcbiAgICAgICAgICBtYXRlcmlhbDogb2JqZWN0Lm1hdGVyaWFsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChpc0xpZ2h0KG9iamVjdCkpIHtcbiAgICAgICAgdGhpcy5saWdodHMucHVzaCh7XG4gICAgICAgICAgb2JqZWN0LFxuICAgICAgICAgIGludGVuc2l0eTogb2JqZWN0LmludGVuc2l0eVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBwcmVwYXJlKCkge1xuICAgIHRoaXMubGlnaHRzLmZvckVhY2gobGlnaHQgPT4gbGlnaHQub2JqZWN0LmludGVuc2l0eSA9IDApO1xuICAgIHRoaXMubWVzaGVzLmZvckVhY2gobWVzaCA9PiBtZXNoLm9iamVjdC5tYXRlcmlhbCA9IHRoaXMuZGlzY2FyZE1hdCk7XG4gIH1cbiAgZmluaXNoKCkge1xuICAgIHRoaXMubGlnaHRzLmZvckVhY2gobGlnaHQgPT4gbGlnaHQub2JqZWN0LmludGVuc2l0eSA9IGxpZ2h0LmludGVuc2l0eSk7XG4gICAgdGhpcy5tZXNoZXMuZm9yRWFjaChtZXNoID0+IG1lc2gub2JqZWN0Lm1hdGVyaWFsID0gbWVzaC5tYXRlcmlhbCk7XG4gIH1cbiAgY29uZmlndXJlKG9iamVjdCkge1xuICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0O1xuICB9XG4gIHVwZGF0ZShjYW1lcmEsIGJsZW5kV2luZG93ID0gMTAwKSB7XG4gICAgaWYgKCF0aGlzLm9iamVjdCkgcmV0dXJuO1xuICAgIC8vIFNldCBlYWNoIG9iamVjdCdzIG1hdGVyaWFsIHRvIHRoZSBVViBVbndyYXBwZWQgU3VyZmFjZSBNYXBwaW5nIFZlcnNpb25cbiAgICB0aGlzLmF2ZXJhZ2luZ1dpbmRvdy52YWx1ZSA9IGJsZW5kV2luZG93O1xuICAgIHRoaXMub2JqZWN0Lm1hdGVyaWFsID0gdGhpcy50YXJnZXRNYXQ7XG4gICAgLy8gUGluZy1wb25nIHR3byBzdXJmYWNlIGJ1ZmZlcnMgZm9yIHJlYWRpbmcvd3JpdGluZ1xuICAgIGNvbnN0IGFjdGl2ZU1hcCA9IHRoaXMuYnVmZmVyMUFjdGl2ZSA/IHRoaXMucHJvZ3Jlc3NpdmVMaWdodE1hcDEgOiB0aGlzLnByb2dyZXNzaXZlTGlnaHRNYXAyO1xuICAgIGNvbnN0IGluYWN0aXZlTWFwID0gdGhpcy5idWZmZXIxQWN0aXZlID8gdGhpcy5wcm9ncmVzc2l2ZUxpZ2h0TWFwMiA6IHRoaXMucHJvZ3Jlc3NpdmVMaWdodE1hcDE7XG4gICAgLy8gUmVuZGVyIHRoZSBvYmplY3QncyBzdXJmYWNlIG1hcHNcbiAgICBjb25zdCBvbGRCZyA9IHRoaXMuc2NlbmUuYmFja2dyb3VuZDtcbiAgICB0aGlzLnNjZW5lLmJhY2tncm91bmQgPSBudWxsO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KGFjdGl2ZU1hcCk7XG4gICAgdGhpcy5wcmV2aW91c1NoYWRvd01hcC52YWx1ZSA9IGluYWN0aXZlTWFwLnRleHR1cmU7XG4gICAgdGhpcy5idWZmZXIxQWN0aXZlID0gIXRoaXMuYnVmZmVyMUFjdGl2ZTtcbiAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzLnNjZW5lLCBjYW1lcmEpO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KG51bGwpO1xuICAgIHRoaXMuc2NlbmUuYmFja2dyb3VuZCA9IG9sZEJnO1xuICB9XG59XG5cbmV4cG9ydCB7IEFjY3VtdWxhdGl2ZVNoYWRvd3MsIFJhbmRvbWl6ZWRMaWdodCwgYWNjdW11bGF0aXZlQ29udGV4dCB9O1xuIl0sIm5hbWVzIjpbIl9leHRlbmRzIiwiVEhSRUUiLCJSZWFjdCIsImV4dGVuZCIsInVzZVRocmVlIiwidXNlRnJhbWUiLCJzaGFkZXJNYXRlcmlhbCIsIkRpc2NhcmRNYXRlcmlhbCIsInZlcnNpb24iLCJpc0xpZ2h0Iiwib2JqZWN0IiwiaXNHZW9tZXRyeSIsImdlb21ldHJ5IiwiYWNjdW11bGF0aXZlQ29udGV4dCIsImNyZWF0ZUNvbnRleHQiLCJTb2Z0U2hhZG93TWF0ZXJpYWwiLCJjb2xvciIsIkNvbG9yIiwiYmxlbmQiLCJhbHBoYVRlc3QiLCJvcGFjaXR5IiwibWFwIiwiQWNjdW11bGF0aXZlU2hhZG93cyIsImZvcndhcmRSZWYiLCJjaGlsZHJlbiIsInRlbXBvcmFsIiwiZnJhbWVzIiwibGltaXQiLCJJbmZpbml0eSIsInNjYWxlIiwiY29sb3JCbGVuZCIsInJlc29sdXRpb24iLCJ0b25lTWFwcGVkIiwicHJvcHMiLCJnbCIsInN0YXRlIiwic2NlbmUiLCJjYW1lcmEiLCJpbnZhbGlkYXRlIiwiZ1BsYW5lIiwidXNlUmVmIiwiZ0xpZ2h0cyIsInBsbSIsInVzZVN0YXRlIiwiUHJvZ3Jlc3NpdmVMaWdodE1hcCIsInVzZUxheW91dEVmZmVjdCIsImNvbmZpZ3VyZSIsImN1cnJlbnQiLCJhcGkiLCJ1c2VNZW1vIiwibGlnaHRzIiwiTWFwIiwiTWF0aCIsIm1heCIsImNvdW50IiwiZ2V0TWVzaCIsInJlc2V0IiwiY2xlYXIiLCJtYXRlcmlhbCIsInVwZGF0ZSIsIm1pbiIsInZpc2libGUiLCJwcmVwYXJlIiwiaSIsImZvckVhY2giLCJsaWdodCIsImZpbmlzaCIsInVzZUltcGVyYXRpdmVIYW5kbGUiLCJjcmVhdGVFbGVtZW50IiwidHJhdmVyc2UiLCJyZWYiLCJQcm92aWRlciIsInZhbHVlIiwicmVjZWl2ZVNoYWRvdyIsInJvdGF0aW9uIiwiUEkiLCJ0cmFuc3BhcmVudCIsImRlcHRoV3JpdGUiLCJwcm9ncmVzc2l2ZUxpZ2h0TWFwMiIsInRleHR1cmUiLCJSYW5kb21pemVkTGlnaHQiLCJjYXN0U2hhZG93IiwiYmlhcyIsIm1hcFNpemUiLCJzaXplIiwibmVhciIsImZhciIsInBvc2l0aW9uIiwicmFkaXVzIiwiYW1vdW50IiwiaW50ZW5zaXR5IiwiYW1iaWVudCIsImxlbmd0aCIsIlZlY3RvcjMiLCJwYXJlbnQiLCJ1c2VDb250ZXh0IiwidXNlQ2FsbGJhY2siLCJsIiwicmFuZG9tIiwic2V0IiwiTWF0aFV0aWxzIiwicmFuZEZsb2F0U3ByZWFkIiwibGFtYmRhIiwiYWNvcyIsInBoaSIsImNvcyIsImFicyIsInNpbiIsIl9wYXJlbnQkbGlnaHRzIiwiZ3JvdXAiLCJ1dWlkIiwiX3BhcmVudCRsaWdodHMyIiwiZGVsZXRlIiwiQXJyYXkiLCJmcm9tIiwiXyIsImluZGV4Iiwia2V5IiwiYXR0YWNoIiwiYXJncyIsImNvbnN0cnVjdG9yIiwicmVuZGVyZXIiLCJyZXMiLCJidWZmZXIxQWN0aXZlIiwibWVzaGVzIiwiY2xlYXJDb2xvciIsImNsZWFyQWxwaGEiLCJ0ZXh0dXJlUGFyYW1zIiwidHlwZSIsIkhhbGZGbG9hdFR5cGUiLCJtYWdGaWx0ZXIiLCJOZWFyZXN0RmlsdGVyIiwibWluRmlsdGVyIiwicHJvZ3Jlc3NpdmVMaWdodE1hcDEiLCJXZWJHTFJlbmRlclRhcmdldCIsImRpc2NhcmRNYXQiLCJ0YXJnZXRNYXQiLCJNZXNoTGFtYmVydE1hdGVyaWFsIiwiZm9nIiwicHJldmlvdXNTaGFkb3dNYXAiLCJhdmVyYWdpbmdXaW5kb3ciLCJvbkJlZm9yZUNvbXBpbGUiLCJzaGFkZXIiLCJ2ZXJ0ZXhTaGFkZXIiLCJzbGljZSIsImJvZHlTdGFydCIsImZyYWdtZW50U2hhZGVyIiwiaW5kZXhPZiIsInVuaWZvcm1zIiwiZ2V0Q2xlYXJDb2xvciIsImdldENsZWFyQWxwaGEiLCJzZXRDbGVhckNvbG9yIiwic2V0UmVuZGVyVGFyZ2V0IiwicHVzaCIsIm1lc2giLCJibGVuZFdpbmRvdyIsImFjdGl2ZU1hcCIsImluYWN0aXZlTWFwIiwib2xkQmciLCJiYWNrZ3JvdW5kIiwicmVuZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/AccumulativeShadows.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/Bounds.js":
/*!*******************************************************!*\
  !*** ./node_modules/@react-three/drei/core/Bounds.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Bounds: () => (/* binding */ Bounds),\n/* harmony export */   useBounds: () => (/* binding */ useBounds)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n\n\n\n// eslint-disable-next-line no-shadow\nvar AnimationState = /*#__PURE__*/ function(AnimationState) {\n    AnimationState[AnimationState[\"NONE\"] = 0] = \"NONE\";\n    AnimationState[AnimationState[\"START\"] = 1] = \"START\";\n    AnimationState[AnimationState[\"ACTIVE\"] = 2] = \"ACTIVE\";\n    return AnimationState;\n}(AnimationState || {});\nconst isOrthographic = (def)=>def && def.isOrthographicCamera;\nconst isBox3 = (def)=>def && def.isBox3;\nconst interpolateFuncDefault = (t)=>{\n    // Imitates the previously used THREE.MathUtils.damp\n    return 1 - Math.exp(-5 * t) + 0.007 * t;\n};\nconst context = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createContext(null);\nfunction Bounds({ children, maxDuration = 1.0, margin = 1.2, observe, fit, clip, interpolateFunc = interpolateFuncDefault, onFit }) {\n    const ref = react__WEBPACK_IMPORTED_MODULE_0__.useRef(null);\n    const { camera, size, invalidate } = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_1__.A)();\n    const controls = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_1__.A)((state)=>state.controls);\n    const onFitRef = react__WEBPACK_IMPORTED_MODULE_0__.useRef(onFit);\n    onFitRef.current = onFit;\n    const origin = react__WEBPACK_IMPORTED_MODULE_0__.useRef({\n        camPos: new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(),\n        camRot: new three__WEBPACK_IMPORTED_MODULE_2__.Quaternion(),\n        camZoom: 1\n    });\n    const goal = react__WEBPACK_IMPORTED_MODULE_0__.useRef({\n        camPos: undefined,\n        camRot: undefined,\n        camZoom: undefined,\n        camUp: undefined,\n        target: undefined\n    });\n    const animationState = react__WEBPACK_IMPORTED_MODULE_0__.useRef(AnimationState.NONE);\n    const t = react__WEBPACK_IMPORTED_MODULE_0__.useRef(0); // represent animation state from 0 to 1\n    const [box] = react__WEBPACK_IMPORTED_MODULE_0__.useState(()=>new three__WEBPACK_IMPORTED_MODULE_2__.Box3());\n    const api = react__WEBPACK_IMPORTED_MODULE_0__.useMemo(()=>{\n        function getSize() {\n            const boxSize = box.getSize(new three__WEBPACK_IMPORTED_MODULE_2__.Vector3());\n            const center = box.getCenter(new three__WEBPACK_IMPORTED_MODULE_2__.Vector3());\n            const maxSize = Math.max(boxSize.x, boxSize.y, boxSize.z);\n            const fitHeightDistance = isOrthographic(camera) ? maxSize * 4 : maxSize / (2 * Math.atan(Math.PI * camera.fov / 360));\n            const fitWidthDistance = isOrthographic(camera) ? maxSize * 4 : fitHeightDistance / camera.aspect;\n            const distance = margin * Math.max(fitHeightDistance, fitWidthDistance);\n            return {\n                box,\n                size: boxSize,\n                center,\n                distance\n            };\n        }\n        return {\n            getSize,\n            refresh (object) {\n                if (isBox3(object)) box.copy(object);\n                else {\n                    const target = object || ref.current;\n                    if (!target) return this;\n                    target.updateWorldMatrix(true, true);\n                    box.setFromObject(target);\n                }\n                if (box.isEmpty()) {\n                    const max = camera.position.length() || 10;\n                    box.setFromCenterAndSize(new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(), new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(max, max, max));\n                }\n                origin.current.camPos.copy(camera.position);\n                origin.current.camRot.copy(camera.quaternion);\n                isOrthographic(camera) && (origin.current.camZoom = camera.zoom);\n                goal.current.camPos = undefined;\n                goal.current.camRot = undefined;\n                goal.current.camZoom = undefined;\n                goal.current.camUp = undefined;\n                goal.current.target = undefined;\n                return this;\n            },\n            reset () {\n                const { center, distance } = getSize();\n                const direction = camera.position.clone().sub(center).normalize();\n                goal.current.camPos = center.clone().addScaledVector(direction, distance);\n                goal.current.target = center.clone();\n                const mCamRot = new three__WEBPACK_IMPORTED_MODULE_2__.Matrix4().lookAt(goal.current.camPos, goal.current.target, camera.up);\n                goal.current.camRot = new three__WEBPACK_IMPORTED_MODULE_2__.Quaternion().setFromRotationMatrix(mCamRot);\n                animationState.current = AnimationState.START;\n                t.current = 0;\n                return this;\n            },\n            moveTo (position) {\n                goal.current.camPos = Array.isArray(position) ? new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(...position) : position.clone();\n                animationState.current = AnimationState.START;\n                t.current = 0;\n                return this;\n            },\n            lookAt ({ target, up }) {\n                goal.current.target = Array.isArray(target) ? new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(...target) : target.clone();\n                if (up) {\n                    goal.current.camUp = Array.isArray(up) ? new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(...up) : up.clone();\n                } else {\n                    goal.current.camUp = camera.up.clone();\n                }\n                const mCamRot = new three__WEBPACK_IMPORTED_MODULE_2__.Matrix4().lookAt(goal.current.camPos || camera.position, goal.current.target, goal.current.camUp);\n                goal.current.camRot = new three__WEBPACK_IMPORTED_MODULE_2__.Quaternion().setFromRotationMatrix(mCamRot);\n                animationState.current = AnimationState.START;\n                t.current = 0;\n                return this;\n            },\n            /**\n       * @deprecated Use moveTo and lookAt instead\n       */ to ({ position, target }) {\n                return this.moveTo(position).lookAt({\n                    target\n                });\n            },\n            fit () {\n                if (!isOrthographic(camera)) {\n                    // For non-orthographic cameras, fit should behave exactly like reset\n                    return this.reset();\n                }\n                // For orthographic cameras, fit should only modify the zoom value\n                let maxHeight = 0, maxWidth = 0;\n                const vertices = [\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.min.x, box.min.y, box.min.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.min.x, box.max.y, box.min.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.min.x, box.min.y, box.max.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.min.x, box.max.y, box.max.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.max.x, box.max.y, box.max.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.max.x, box.max.y, box.min.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.max.x, box.min.y, box.max.z),\n                    new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(box.max.x, box.min.y, box.min.z)\n                ];\n                // Transform the center and each corner to camera space\n                const pos = goal.current.camPos || camera.position;\n                const target = goal.current.target || (controls == null ? void 0 : controls.target);\n                const up = goal.current.camUp || camera.up;\n                const mCamWInv = target ? new three__WEBPACK_IMPORTED_MODULE_2__.Matrix4().lookAt(pos, target, up).setPosition(pos).invert() : camera.matrixWorldInverse;\n                for (const v of vertices){\n                    v.applyMatrix4(mCamWInv);\n                    maxHeight = Math.max(maxHeight, Math.abs(v.y));\n                    maxWidth = Math.max(maxWidth, Math.abs(v.x));\n                }\n                maxHeight *= 2;\n                maxWidth *= 2;\n                const zoomForHeight = (camera.top - camera.bottom) / maxHeight;\n                const zoomForWidth = (camera.right - camera.left) / maxWidth;\n                goal.current.camZoom = Math.min(zoomForHeight, zoomForWidth) / margin;\n                animationState.current = AnimationState.START;\n                t.current = 0;\n                onFitRef.current && onFitRef.current(this.getSize());\n                return this;\n            },\n            clip () {\n                const { distance } = getSize();\n                camera.near = distance / 100;\n                camera.far = distance * 100;\n                camera.updateProjectionMatrix();\n                if (controls) {\n                    controls.maxDistance = distance * 10;\n                    controls.update();\n                }\n                invalidate();\n                return this;\n            }\n        };\n    }, [\n        box,\n        camera,\n        controls,\n        margin,\n        invalidate\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect(()=>{\n        if (controls) {\n            // Try to prevent drag hijacking\n            const callback = ()=>{\n                if (controls && goal.current.target && animationState.current !== AnimationState.NONE) {\n                    const front = new three__WEBPACK_IMPORTED_MODULE_2__.Vector3().setFromMatrixColumn(camera.matrix, 2);\n                    const d0 = origin.current.camPos.distanceTo(controls.target);\n                    const d1 = (goal.current.camPos || origin.current.camPos).distanceTo(goal.current.target);\n                    const d = (1 - t.current) * d0 + t.current * d1;\n                    controls.target.copy(camera.position).addScaledVector(front, -d);\n                    controls.update();\n                }\n                animationState.current = AnimationState.NONE;\n            };\n            controls.addEventListener(\"start\", callback);\n            return ()=>controls.removeEventListener(\"start\", callback);\n        }\n    }, [\n        controls\n    ]);\n    // Scale pointer on window resize\n    const count = react__WEBPACK_IMPORTED_MODULE_0__.useRef(0);\n    react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect(()=>{\n        if (observe || count.current++ === 0) {\n            api.refresh();\n            if (fit) api.reset().fit();\n            if (clip) api.clip();\n        }\n    }, [\n        size,\n        clip,\n        fit,\n        observe,\n        camera,\n        controls\n    ]);\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_1__.C)((state, delta)=>{\n        // This [additional animation step START] is needed to guarantee that delta used in animation isn't absurdly high (2-3 seconds) which is actually possible if rendering happens on demand...\n        if (animationState.current === AnimationState.START) {\n            animationState.current = AnimationState.ACTIVE;\n            invalidate();\n        } else if (animationState.current === AnimationState.ACTIVE) {\n            t.current += delta / maxDuration;\n            if (t.current >= 1) {\n                goal.current.camPos && camera.position.copy(goal.current.camPos);\n                goal.current.camRot && camera.quaternion.copy(goal.current.camRot);\n                goal.current.camUp && camera.up.copy(goal.current.camUp);\n                goal.current.camZoom && isOrthographic(camera) && (camera.zoom = goal.current.camZoom);\n                camera.updateMatrixWorld();\n                camera.updateProjectionMatrix();\n                if (controls && goal.current.target) {\n                    controls.target.copy(goal.current.target);\n                    controls.update();\n                }\n                animationState.current = AnimationState.NONE;\n            } else {\n                const k = interpolateFunc(t.current);\n                goal.current.camPos && camera.position.lerpVectors(origin.current.camPos, goal.current.camPos, k);\n                goal.current.camRot && camera.quaternion.slerpQuaternions(origin.current.camRot, goal.current.camRot, k);\n                goal.current.camUp && camera.up.set(0, 1, 0).applyQuaternion(camera.quaternion);\n                goal.current.camZoom && isOrthographic(camera) && (camera.zoom = (1 - k) * origin.current.camZoom + k * goal.current.camZoom);\n                camera.updateMatrixWorld();\n                camera.updateProjectionMatrix();\n            }\n            invalidate();\n        }\n    });\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"group\", {\n        ref: ref\n    }, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(context.Provider, {\n        value: api\n    }, children));\n}\nfunction useBounds() {\n    return react__WEBPACK_IMPORTED_MODULE_0__.useContext(context);\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9Cb3VuZHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQStCO0FBQ0E7QUFDeUI7QUFFeEQscUNBQXFDO0FBQ3JDLElBQUlJLGlCQUFpQixXQUFXLEdBQUUsU0FBVUEsY0FBYztJQUN4REEsY0FBYyxDQUFDQSxjQUFjLENBQUMsT0FBTyxHQUFHLEVBQUUsR0FBRztJQUM3Q0EsY0FBYyxDQUFDQSxjQUFjLENBQUMsUUFBUSxHQUFHLEVBQUUsR0FBRztJQUM5Q0EsY0FBYyxDQUFDQSxjQUFjLENBQUMsU0FBUyxHQUFHLEVBQUUsR0FBRztJQUMvQyxPQUFPQTtBQUNULEVBQUVBLGtCQUFrQixDQUFDO0FBQ3JCLE1BQU1DLGlCQUFpQkMsQ0FBQUEsTUFBT0EsT0FBT0EsSUFBSUMsb0JBQW9CO0FBQzdELE1BQU1DLFNBQVNGLENBQUFBLE1BQU9BLE9BQU9BLElBQUlFLE1BQU07QUFDdkMsTUFBTUMseUJBQXlCQyxDQUFBQTtJQUM3QixvREFBb0Q7SUFDcEQsT0FBTyxJQUFJQyxLQUFLQyxHQUFHLENBQUMsQ0FBQyxJQUFJRixLQUFLLFFBQVFBO0FBQ3hDO0FBQ0EsTUFBTUcsVUFBVSxXQUFXLEdBQUViLGdEQUFtQixDQUFDO0FBQ2pELFNBQVNlLE9BQU8sRUFDZEMsUUFBUSxFQUNSQyxjQUFjLEdBQUcsRUFDakJDLFNBQVMsR0FBRyxFQUNaQyxPQUFPLEVBQ1BDLEdBQUcsRUFDSEMsSUFBSSxFQUNKQyxrQkFBa0JiLHNCQUFzQixFQUN4Q2MsS0FBSyxFQUNOO0lBQ0MsTUFBTUMsTUFBTXhCLHlDQUFZLENBQUM7SUFDekIsTUFBTSxFQUNKMEIsTUFBTSxFQUNOQyxJQUFJLEVBQ0pDLFVBQVUsRUFDWCxHQUFHMUIscURBQVFBO0lBQ1osTUFBTTJCLFdBQVczQixxREFBUUEsQ0FBQzRCLENBQUFBLFFBQVNBLE1BQU1ELFFBQVE7SUFDakQsTUFBTUUsV0FBVy9CLHlDQUFZLENBQUN1QjtJQUM5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STdHLGdCQUFnQlosRUFBRXNCLE9BQU87Z0JBQ25DTyxLQUFLUCxPQUFPLENBQUNFLE1BQU0sSUFBSVIsT0FBTzhDLFFBQVEsQ0FBQzRELFdBQVcsQ0FBQ25HLE9BQU9ELE9BQU8sQ0FBQ0UsTUFBTSxFQUFFSyxLQUFLUCxPQUFPLENBQUNFLE1BQU0sRUFBRWlHO2dCQUMvRjVGLEtBQUtQLE9BQU8sQ0FBQ0ksTUFBTSxJQUFJVixPQUFPaUQsVUFBVSxDQUFDMEQsZ0JBQWdCLENBQUNwRyxPQUFPRCxPQUFPLENBQUNJLE1BQU0sRUFBRUcsS0FBS1AsT0FBTyxDQUFDSSxNQUFNLEVBQUUrRjtnQkFDdEc1RixLQUFLUCxPQUFPLENBQUNTLEtBQUssSUFBSWYsT0FBTzRELEVBQUUsQ0FBQ2dELEdBQUcsQ0FBQyxHQUFHLEdBQUcsR0FBR0MsZUFBZSxDQUFDN0csT0FBT2lELFVBQVU7Z0JBQzlFcEMsS0FBS1AsT0FBTyxDQUFDTSxPQUFPLElBQUlqQyxlQUFlcUIsV0FBWUEsQ0FBQUEsT0FBT2tELElBQUksR0FBRyxDQUFDLElBQUl1RCxDQUFBQSxJQUFLbEcsT0FBT0QsT0FBTyxDQUFDTSxPQUFPLEdBQUc2RixJQUFJNUYsS0FBS1AsT0FBTyxDQUFDTSxPQUFPO2dCQUM1SFosT0FBT3dHLGlCQUFpQjtnQkFDeEJ4RyxPQUFPdUYsc0JBQXNCO1lBQy9CO1lBQ0FyRjtRQUNGO0lBQ0Y7SUFDQSxPQUFPLFdBQVcsR0FBRTVCLGdEQUFtQixDQUFDLFNBQVM7UUFDL0N3QixLQUFLQTtJQUNQLEdBQUcsV0FBVyxHQUFFeEIsZ0RBQW1CLENBQUNhLFFBQVE0SCxRQUFRLEVBQUU7UUFDcERDLE9BQU8xRjtJQUNULEdBQUdoQztBQUNMO0FBQ0EsU0FBUzJIO0lBQ1AsT0FBTzNJLDZDQUFnQixDQUFDYTtBQUMxQjtBQUU2QiIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2NvcmUvQm91bmRzLmpzP2U0OWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuaW1wb3J0IHsgdXNlVGhyZWUsIHVzZUZyYW1lIH0gZnJvbSAnQHJlYWN0LXRocmVlL2ZpYmVyJztcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xudmFyIEFuaW1hdGlvblN0YXRlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChBbmltYXRpb25TdGF0ZSkge1xuICBBbmltYXRpb25TdGF0ZVtBbmltYXRpb25TdGF0ZVtcIk5PTkVcIl0gPSAwXSA9IFwiTk9ORVwiO1xuICBBbmltYXRpb25TdGF0ZVtBbmltYXRpb25TdGF0ZVtcIlNUQVJUXCJdID0gMV0gPSBcIlNUQVJUXCI7XG4gIEFuaW1hdGlvblN0YXRlW0FuaW1hdGlvblN0YXRlW1wiQUNUSVZFXCJdID0gMl0gPSBcIkFDVElWRVwiO1xuICByZXR1cm4gQW5pbWF0aW9uU3RhdGU7XG59KEFuaW1hdGlvblN0YXRlIHx8IHt9KTtcbmNvbnN0IGlzT3J0aG9ncmFwaGljID0gZGVmID0+IGRlZiAmJiBkZWYuaXNPcnRob2dyYXBoaWNDYW1lcmE7XG5jb25zdCBpc0JveDMgPSBkZWYgPT4gZGVmICYmIGRlZi5pc0JveDM7XG5jb25zdCBpbnRlcnBvbGF0ZUZ1bmNEZWZhdWx0ID0gdCA9PiB7XG4gIC8vIEltaXRhdGVzIHRoZSBwcmV2aW91c2x5IHVzZWQgVEhSRUUuTWF0aFV0aWxzLmRhbXBcbiAgcmV0dXJuIDEgLSBNYXRoLmV4cCgtNSAqIHQpICsgMC4wMDcgKiB0O1xufTtcbmNvbnN0IGNvbnRleHQgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlQ29udGV4dChudWxsKTtcbmZ1bmN0aW9uIEJvdW5kcyh7XG4gIGNoaWxkcmVuLFxuICBtYXhEdXJhdGlvbiA9IDEuMCxcbiAgbWFyZ2luID0gMS4yLFxuICBvYnNlcnZlLFxuICBmaXQsXG4gIGNsaXAsXG4gIGludGVycG9sYXRlRnVuYyA9IGludGVycG9sYXRlRnVuY0RlZmF1bHQsXG4gIG9uRml0XG59KSB7XG4gIGNvbnN0IHJlZiA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgY29uc3Qge1xuICAgIGNhbWVyYSxcbiAgICBzaXplLFxuICAgIGludmFsaWRhdGVcbiAgfSA9IHVzZVRocmVlKCk7XG4gIGNvbnN0IGNvbnRyb2xzID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuY29udHJvbHMpO1xuICBjb25zdCBvbkZpdFJlZiA9IFJlYWN0LnVzZVJlZihvbkZpdCk7XG4gIG9uRml0UmVmLmN1cnJlbnQgPSBvbkZpdDtcbiAgY29uc3Qgb3JpZ2luID0gUmVhY3QudXNlUmVmKHtcbiAgICBjYW1Qb3M6IG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgY2FtUm90OiBuZXcgVEhSRUUuUXVhdGVybmlvbigpLFxuICAgIGNhbVpvb206IDFcbiAgfSk7XG4gIGNvbnN0IGdvYWwgPSBSZWFjdC51c2VSZWYoe1xuICAgIGNhbVBvczogdW5kZWZpbmVkLFxuICAgIGNhbVJvdDogdW5kZWZpbmVkLFxuICAgIGNhbVpvb206IHVuZGVmaW5lZCxcbiAgICBjYW1VcDogdW5kZWZpbmVkLFxuICAgIHRhcmdldDogdW5kZWZpbmVkXG4gIH0pO1xuICBjb25zdCBhbmltYXRpb25TdGF0ZSA9IFJlYWN0LnVzZVJlZihBbmltYXRpb25TdGF0ZS5OT05FKTtcbiAgY29uc3QgdCA9IFJlYWN0LnVzZVJlZigwKTsgLy8gcmVwcmVzZW50IGFuaW1hdGlvbiBzdGF0ZSBmcm9tIDAgdG8gMVxuXG4gIGNvbnN0IFtib3hdID0gUmVhY3QudXNlU3RhdGUoKCkgPT4gbmV3IFRIUkVFLkJveDMoKSk7XG4gIGNvbnN0IGFwaSA9IFJlYWN0LnVzZU1lbW8oKCkgPT4ge1xuICAgIGZ1bmN0aW9uIGdldFNpemUoKSB7XG4gICAgICBjb25zdCBib3hTaXplID0gYm94LmdldFNpemUobmV3IFRIUkVFLlZlY3RvcjMoKSk7XG4gICAgICBjb25zdCBjZW50ZXIgPSBib3guZ2V0Q2VudGVyKG5ldyBUSFJFRS5WZWN0b3IzKCkpO1xuICAgICAgY29uc3QgbWF4U2l6ZSA9IE1hdGgubWF4KGJveFNpemUueCwgYm94U2l6ZS55LCBib3hTaXplLnopO1xuICAgICAgY29uc3QgZml0SGVpZ2h0RGlzdGFuY2UgPSBpc09ydGhvZ3JhcGhpYyhjYW1lcmEpID8gbWF4U2l6ZSAqIDQgOiBtYXhTaXplIC8gKDIgKiBNYXRoLmF0YW4oTWF0aC5QSSAqIGNhbWVyYS5mb3YgLyAzNjApKTtcbiAgICAgIGNvbnN0IGZpdFdpZHRoRGlzdGFuY2UgPSBpc09ydGhvZ3JhcGhpYyhjYW1lcmEpID8gbWF4U2l6ZSAqIDQgOiBmaXRIZWlnaHREaXN0YW5jZSAvIGNhbWVyYS5hc3BlY3Q7XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IG1hcmdpbiAqIE1hdGgubWF4KGZpdEhlaWdodERpc3RhbmNlLCBmaXRXaWR0aERpc3RhbmNlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJveCxcbiAgICAgICAgc2l6ZTogYm94U2l6ZSxcbiAgICAgICAgY2VudGVyLFxuICAgICAgICBkaXN0YW5jZVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGdldFNpemUsXG4gICAgICByZWZyZXNoKG9iamVjdCkge1xuICAgICAgICBpZiAoaXNCb3gzKG9iamVjdCkpIGJveC5jb3B5KG9iamVjdCk7ZWxzZSB7XG4gICAgICAgICAgY29uc3QgdGFyZ2V0ID0gb2JqZWN0IHx8IHJlZi5jdXJyZW50O1xuICAgICAgICAgIGlmICghdGFyZ2V0KSByZXR1cm4gdGhpcztcbiAgICAgICAgICB0YXJnZXQudXBkYXRlV29ybGRNYXRyaXgodHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgYm94LnNldEZyb21PYmplY3QodGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYm94LmlzRW1wdHkoKSkge1xuICAgICAgICAgIGNvbnN0IG1heCA9IGNhbWVyYS5wb3NpdGlvbi5sZW5ndGgoKSB8fCAxMDtcbiAgICAgICAgICBib3guc2V0RnJvbUNlbnRlckFuZFNpemUobmV3IFRIUkVFLlZlY3RvcjMoKSwgbmV3IFRIUkVFLlZlY3RvcjMobWF4LCBtYXgsIG1heCkpO1xuICAgICAgICB9XG4gICAgICAgIG9yaWdpbi5jdXJyZW50LmNhbVBvcy5jb3B5KGNhbWVyYS5wb3NpdGlvbik7XG4gICAgICAgIG9yaWdpbi5jdXJyZW50LmNhbVJvdC5jb3B5KGNhbWVyYS5xdWF0ZXJuaW9uKTtcbiAgICAgICAgaXNPcnRob2dyYXBoaWMoY2FtZXJhKSAmJiAob3JpZ2luLmN1cnJlbnQuY2FtWm9vbSA9IGNhbWVyYS56b29tKTtcbiAgICAgICAgZ29hbC5jdXJyZW50LmNhbVBvcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgZ29hbC5jdXJyZW50LmNhbVJvdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgZ29hbC5jdXJyZW50LmNhbVpvb20gPSB1bmRlZmluZWQ7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1VcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgZ29hbC5jdXJyZW50LnRhcmdldCA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LFxuICAgICAgcmVzZXQoKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjZW50ZXIsXG4gICAgICAgICAgZGlzdGFuY2VcbiAgICAgICAgfSA9IGdldFNpemUoKTtcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gY2FtZXJhLnBvc2l0aW9uLmNsb25lKCkuc3ViKGNlbnRlcikubm9ybWFsaXplKCk7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1Qb3MgPSBjZW50ZXIuY2xvbmUoKS5hZGRTY2FsZWRWZWN0b3IoZGlyZWN0aW9uLCBkaXN0YW5jZSk7XG4gICAgICAgIGdvYWwuY3VycmVudC50YXJnZXQgPSBjZW50ZXIuY2xvbmUoKTtcbiAgICAgICAgY29uc3QgbUNhbVJvdCA9IG5ldyBUSFJFRS5NYXRyaXg0KCkubG9va0F0KGdvYWwuY3VycmVudC5jYW1Qb3MsIGdvYWwuY3VycmVudC50YXJnZXQsIGNhbWVyYS51cCk7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1Sb3QgPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpLnNldEZyb21Sb3RhdGlvbk1hdHJpeChtQ2FtUm90KTtcbiAgICAgICAgYW5pbWF0aW9uU3RhdGUuY3VycmVudCA9IEFuaW1hdGlvblN0YXRlLlNUQVJUO1xuICAgICAgICB0LmN1cnJlbnQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sXG4gICAgICBtb3ZlVG8ocG9zaXRpb24pIHtcbiAgICAgICAgZ29hbC5jdXJyZW50LmNhbVBvcyA9IEFycmF5LmlzQXJyYXkocG9zaXRpb24pID8gbmV3IFRIUkVFLlZlY3RvcjMoLi4ucG9zaXRpb24pIDogcG9zaXRpb24uY2xvbmUoKTtcbiAgICAgICAgYW5pbWF0aW9uU3RhdGUuY3VycmVudCA9IEFuaW1hdGlvblN0YXRlLlNUQVJUO1xuICAgICAgICB0LmN1cnJlbnQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sXG4gICAgICBsb29rQXQoe1xuICAgICAgICB0YXJnZXQsXG4gICAgICAgIHVwXG4gICAgICB9KSB7XG4gICAgICAgIGdvYWwuY3VycmVudC50YXJnZXQgPSBBcnJheS5pc0FycmF5KHRhcmdldCkgPyBuZXcgVEhSRUUuVmVjdG9yMyguLi50YXJnZXQpIDogdGFyZ2V0LmNsb25lKCk7XG4gICAgICAgIGlmICh1cCkge1xuICAgICAgICAgIGdvYWwuY3VycmVudC5jYW1VcCA9IEFycmF5LmlzQXJyYXkodXApID8gbmV3IFRIUkVFLlZlY3RvcjMoLi4udXApIDogdXAuY2xvbmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnb2FsLmN1cnJlbnQuY2FtVXAgPSBjYW1lcmEudXAuY2xvbmUoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtQ2FtUm90ID0gbmV3IFRIUkVFLk1hdHJpeDQoKS5sb29rQXQoZ29hbC5jdXJyZW50LmNhbVBvcyB8fCBjYW1lcmEucG9zaXRpb24sIGdvYWwuY3VycmVudC50YXJnZXQsIGdvYWwuY3VycmVudC5jYW1VcCk7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1Sb3QgPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpLnNldEZyb21Sb3RhdGlvbk1hdHJpeChtQ2FtUm90KTtcbiAgICAgICAgYW5pbWF0aW9uU3RhdGUuY3VycmVudCA9IEFuaW1hdGlvblN0YXRlLlNUQVJUO1xuICAgICAgICB0LmN1cnJlbnQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIEBkZXByZWNhdGVkIFVzZSBtb3ZlVG8gYW5kIGxvb2tBdCBpbnN0ZWFkXG4gICAgICAgKi9cbiAgICAgIHRvKHtcbiAgICAgICAgcG9zaXRpb24sXG4gICAgICAgIHRhcmdldFxuICAgICAgfSkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb3ZlVG8ocG9zaXRpb24pLmxvb2tBdCh7XG4gICAgICAgICAgdGFyZ2V0XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGZpdCgpIHtcbiAgICAgICAgaWYgKCFpc09ydGhvZ3JhcGhpYyhjYW1lcmEpKSB7XG4gICAgICAgICAgLy8gRm9yIG5vbi1vcnRob2dyYXBoaWMgY2FtZXJhcywgZml0IHNob3VsZCBiZWhhdmUgZXhhY3RseSBsaWtlIHJlc2V0XG4gICAgICAgICAgcmV0dXJuIHRoaXMucmVzZXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBvcnRob2dyYXBoaWMgY2FtZXJhcywgZml0IHNob3VsZCBvbmx5IG1vZGlmeSB0aGUgem9vbSB2YWx1ZVxuICAgICAgICBsZXQgbWF4SGVpZ2h0ID0gMCxcbiAgICAgICAgICBtYXhXaWR0aCA9IDA7XG4gICAgICAgIGNvbnN0IHZlcnRpY2VzID0gW25ldyBUSFJFRS5WZWN0b3IzKGJveC5taW4ueCwgYm94Lm1pbi55LCBib3gubWluLnopLCBuZXcgVEhSRUUuVmVjdG9yMyhib3gubWluLngsIGJveC5tYXgueSwgYm94Lm1pbi56KSwgbmV3IFRIUkVFLlZlY3RvcjMoYm94Lm1pbi54LCBib3gubWluLnksIGJveC5tYXgueiksIG5ldyBUSFJFRS5WZWN0b3IzKGJveC5taW4ueCwgYm94Lm1heC55LCBib3gubWF4LnopLCBuZXcgVEhSRUUuVmVjdG9yMyhib3gubWF4LngsIGJveC5tYXgueSwgYm94Lm1heC56KSwgbmV3IFRIUkVFLlZlY3RvcjMoYm94Lm1heC54LCBib3gubWF4LnksIGJveC5taW4ueiksIG5ldyBUSFJFRS5WZWN0b3IzKGJveC5tYXgueCwgYm94Lm1pbi55LCBib3gubWF4LnopLCBuZXcgVEhSRUUuVmVjdG9yMyhib3gubWF4LngsIGJveC5taW4ueSwgYm94Lm1pbi56KV07XG5cbiAgICAgICAgLy8gVHJhbnNmb3JtIHRoZSBjZW50ZXIgYW5kIGVhY2ggY29ybmVyIHRvIGNhbWVyYSBzcGFjZVxuICAgICAgICBjb25zdCBwb3MgPSBnb2FsLmN1cnJlbnQuY2FtUG9zIHx8IGNhbWVyYS5wb3NpdGlvbjtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZ29hbC5jdXJyZW50LnRhcmdldCB8fCAoY29udHJvbHMgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbnRyb2xzLnRhcmdldCk7XG4gICAgICAgIGNvbnN0IHVwID0gZ29hbC5jdXJyZW50LmNhbVVwIHx8IGNhbWVyYS51cDtcbiAgICAgICAgY29uc3QgbUNhbVdJbnYgPSB0YXJnZXQgPyBuZXcgVEhSRUUuTWF0cml4NCgpLmxvb2tBdChwb3MsIHRhcmdldCwgdXApLnNldFBvc2l0aW9uKHBvcykuaW52ZXJ0KCkgOiBjYW1lcmEubWF0cml4V29ybGRJbnZlcnNlO1xuICAgICAgICBmb3IgKGNvbnN0IHYgb2YgdmVydGljZXMpIHtcbiAgICAgICAgICB2LmFwcGx5TWF0cml4NChtQ2FtV0ludik7XG4gICAgICAgICAgbWF4SGVpZ2h0ID0gTWF0aC5tYXgobWF4SGVpZ2h0LCBNYXRoLmFicyh2LnkpKTtcbiAgICAgICAgICBtYXhXaWR0aCA9IE1hdGgubWF4KG1heFdpZHRoLCBNYXRoLmFicyh2LngpKTtcbiAgICAgICAgfVxuICAgICAgICBtYXhIZWlnaHQgKj0gMjtcbiAgICAgICAgbWF4V2lkdGggKj0gMjtcbiAgICAgICAgY29uc3Qgem9vbUZvckhlaWdodCA9IChjYW1lcmEudG9wIC0gY2FtZXJhLmJvdHRvbSkgLyBtYXhIZWlnaHQ7XG4gICAgICAgIGNvbnN0IHpvb21Gb3JXaWR0aCA9IChjYW1lcmEucmlnaHQgLSBjYW1lcmEubGVmdCkgLyBtYXhXaWR0aDtcbiAgICAgICAgZ29hbC5jdXJyZW50LmNhbVpvb20gPSBNYXRoLm1pbih6b29tRm9ySGVpZ2h0LCB6b29tRm9yV2lkdGgpIC8gbWFyZ2luO1xuICAgICAgICBhbmltYXRpb25TdGF0ZS5jdXJyZW50ID0gQW5pbWF0aW9uU3RhdGUuU1RBUlQ7XG4gICAgICAgIHQuY3VycmVudCA9IDA7XG4gICAgICAgIG9uRml0UmVmLmN1cnJlbnQgJiYgb25GaXRSZWYuY3VycmVudCh0aGlzLmdldFNpemUoKSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGNsaXAoKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBkaXN0YW5jZVxuICAgICAgICB9ID0gZ2V0U2l6ZSgpO1xuICAgICAgICBjYW1lcmEubmVhciA9IGRpc3RhbmNlIC8gMTAwO1xuICAgICAgICBjYW1lcmEuZmFyID0gZGlzdGFuY2UgKiAxMDA7XG4gICAgICAgIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICAgIGlmIChjb250cm9scykge1xuICAgICAgICAgIGNvbnRyb2xzLm1heERpc3RhbmNlID0gZGlzdGFuY2UgKiAxMDtcbiAgICAgICAgICBjb250cm9scy51cGRhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBpbnZhbGlkYXRlKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtib3gsIGNhbWVyYSwgY29udHJvbHMsIG1hcmdpbiwgaW52YWxpZGF0ZV0pO1xuICBSZWFjdC51c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChjb250cm9scykge1xuICAgICAgLy8gVHJ5IHRvIHByZXZlbnQgZHJhZyBoaWphY2tpbmdcbiAgICAgIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgICBpZiAoY29udHJvbHMgJiYgZ29hbC5jdXJyZW50LnRhcmdldCAmJiBhbmltYXRpb25TdGF0ZS5jdXJyZW50ICE9PSBBbmltYXRpb25TdGF0ZS5OT05FKSB7XG4gICAgICAgICAgY29uc3QgZnJvbnQgPSBuZXcgVEhSRUUuVmVjdG9yMygpLnNldEZyb21NYXRyaXhDb2x1bW4oY2FtZXJhLm1hdHJpeCwgMik7XG4gICAgICAgICAgY29uc3QgZDAgPSBvcmlnaW4uY3VycmVudC5jYW1Qb3MuZGlzdGFuY2VUbyhjb250cm9scy50YXJnZXQpO1xuICAgICAgICAgIGNvbnN0IGQxID0gKGdvYWwuY3VycmVudC5jYW1Qb3MgfHwgb3JpZ2luLmN1cnJlbnQuY2FtUG9zKS5kaXN0YW5jZVRvKGdvYWwuY3VycmVudC50YXJnZXQpO1xuICAgICAgICAgIGNvbnN0IGQgPSAoMSAtIHQuY3VycmVudCkgKiBkMCArIHQuY3VycmVudCAqIGQxO1xuICAgICAgICAgIGNvbnRyb2xzLnRhcmdldC5jb3B5KGNhbWVyYS5wb3NpdGlvbikuYWRkU2NhbGVkVmVjdG9yKGZyb250LCAtZCk7XG4gICAgICAgICAgY29udHJvbHMudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0aW9uU3RhdGUuY3VycmVudCA9IEFuaW1hdGlvblN0YXRlLk5PTkU7XG4gICAgICB9O1xuICAgICAgY29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcignc3RhcnQnLCBjYWxsYmFjayk7XG4gICAgICByZXR1cm4gKCkgPT4gY29udHJvbHMucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RhcnQnLCBjYWxsYmFjayk7XG4gICAgfVxuICB9LCBbY29udHJvbHNdKTtcblxuICAvLyBTY2FsZSBwb2ludGVyIG9uIHdpbmRvdyByZXNpemVcbiAgY29uc3QgY291bnQgPSBSZWFjdC51c2VSZWYoMCk7XG4gIFJlYWN0LnVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKG9ic2VydmUgfHwgY291bnQuY3VycmVudCsrID09PSAwKSB7XG4gICAgICBhcGkucmVmcmVzaCgpO1xuICAgICAgaWYgKGZpdCkgYXBpLnJlc2V0KCkuZml0KCk7XG4gICAgICBpZiAoY2xpcCkgYXBpLmNsaXAoKTtcbiAgICB9XG4gIH0sIFtzaXplLCBjbGlwLCBmaXQsIG9ic2VydmUsIGNhbWVyYSwgY29udHJvbHNdKTtcbiAgdXNlRnJhbWUoKHN0YXRlLCBkZWx0YSkgPT4ge1xuICAgIC8vIFRoaXMgW2FkZGl0aW9uYWwgYW5pbWF0aW9uIHN0ZXAgU1RBUlRdIGlzIG5lZWRlZCB0byBndWFyYW50ZWUgdGhhdCBkZWx0YSB1c2VkIGluIGFuaW1hdGlvbiBpc24ndCBhYnN1cmRseSBoaWdoICgyLTMgc2Vjb25kcykgd2hpY2ggaXMgYWN0dWFsbHkgcG9zc2libGUgaWYgcmVuZGVyaW5nIGhhcHBlbnMgb24gZGVtYW5kLi4uXG4gICAgaWYgKGFuaW1hdGlvblN0YXRlLmN1cnJlbnQgPT09IEFuaW1hdGlvblN0YXRlLlNUQVJUKSB7XG4gICAgICBhbmltYXRpb25TdGF0ZS5jdXJyZW50ID0gQW5pbWF0aW9uU3RhdGUuQUNUSVZFO1xuICAgICAgaW52YWxpZGF0ZSgpO1xuICAgIH0gZWxzZSBpZiAoYW5pbWF0aW9uU3RhdGUuY3VycmVudCA9PT0gQW5pbWF0aW9uU3RhdGUuQUNUSVZFKSB7XG4gICAgICB0LmN1cnJlbnQgKz0gZGVsdGEgLyBtYXhEdXJhdGlvbjtcbiAgICAgIGlmICh0LmN1cnJlbnQgPj0gMSkge1xuICAgICAgICBnb2FsLmN1cnJlbnQuY2FtUG9zICYmIGNhbWVyYS5wb3NpdGlvbi5jb3B5KGdvYWwuY3VycmVudC5jYW1Qb3MpO1xuICAgICAgICBnb2FsLmN1cnJlbnQuY2FtUm90ICYmIGNhbWVyYS5xdWF0ZXJuaW9uLmNvcHkoZ29hbC5jdXJyZW50LmNhbVJvdCk7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1VcCAmJiBjYW1lcmEudXAuY29weShnb2FsLmN1cnJlbnQuY2FtVXApO1xuICAgICAgICBnb2FsLmN1cnJlbnQuY2FtWm9vbSAmJiBpc09ydGhvZ3JhcGhpYyhjYW1lcmEpICYmIChjYW1lcmEuem9vbSA9IGdvYWwuY3VycmVudC5jYW1ab29tKTtcbiAgICAgICAgY2FtZXJhLnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgICAgIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICAgIGlmIChjb250cm9scyAmJiBnb2FsLmN1cnJlbnQudGFyZ2V0KSB7XG4gICAgICAgICAgY29udHJvbHMudGFyZ2V0LmNvcHkoZ29hbC5jdXJyZW50LnRhcmdldCk7XG4gICAgICAgICAgY29udHJvbHMudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0aW9uU3RhdGUuY3VycmVudCA9IEFuaW1hdGlvblN0YXRlLk5PTkU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBrID0gaW50ZXJwb2xhdGVGdW5jKHQuY3VycmVudCk7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1Qb3MgJiYgY2FtZXJhLnBvc2l0aW9uLmxlcnBWZWN0b3JzKG9yaWdpbi5jdXJyZW50LmNhbVBvcywgZ29hbC5jdXJyZW50LmNhbVBvcywgayk7XG4gICAgICAgIGdvYWwuY3VycmVudC5jYW1Sb3QgJiYgY2FtZXJhLnF1YXRlcm5pb24uc2xlcnBRdWF0ZXJuaW9ucyhvcmlnaW4uY3VycmVudC5jYW1Sb3QsIGdvYWwuY3VycmVudC5jYW1Sb3QsIGspO1xuICAgICAgICBnb2FsLmN1cnJlbnQuY2FtVXAgJiYgY2FtZXJhLnVwLnNldCgwLCAxLCAwKS5hcHBseVF1YXRlcm5pb24oY2FtZXJhLnF1YXRlcm5pb24pO1xuICAgICAgICBnb2FsLmN1cnJlbnQuY2FtWm9vbSAmJiBpc09ydGhvZ3JhcGhpYyhjYW1lcmEpICYmIChjYW1lcmEuem9vbSA9ICgxIC0gaykgKiBvcmlnaW4uY3VycmVudC5jYW1ab29tICsgayAqIGdvYWwuY3VycmVudC5jYW1ab29tKTtcbiAgICAgICAgY2FtZXJhLnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgICAgIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICB9XG4gICAgICBpbnZhbGlkYXRlKCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZ3JvdXBcIiwge1xuICAgIHJlZjogcmVmXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KGNvbnRleHQuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZTogYXBpXG4gIH0sIGNoaWxkcmVuKSk7XG59XG5mdW5jdGlvbiB1c2VCb3VuZHMoKSB7XG4gIHJldHVybiBSZWFjdC51c2VDb250ZXh0KGNvbnRleHQpO1xufVxuXG5leHBvcnQgeyBCb3VuZHMsIHVzZUJvdW5kcyB9O1xuIl0sIm5hbWVzIjpbIlJlYWN0IiwiVEhSRUUiLCJ1c2VUaHJlZSIsInVzZUZyYW1lIiwiQW5pbWF0aW9uU3RhdGUiLCJpc09ydGhvZ3JhcGhpYyIsImRlZiIsImlzT3J0aG9ncmFwaGljQ2FtZXJhIiwiaXNCb3gzIiwiaW50ZXJwb2xhdGVGdW5jRGVmYXVsdCIsInQiLCJNYXRoIiwiZXhwIiwiY29udGV4dCIsImNyZWF0ZUNvbnRleHQiLCJCb3VuZHMiLCJjaGlsZHJlbiIsIm1heER1cmF0aW9uIiwibWFyZ2luIiwib2JzZXJ2ZSIsImZpdCIsImNsaXAiLCJpbnRlcnBvbGF0ZUZ1bmMiLCJvbkZpdCIsInJlZiIsInVzZVJlZiIsImNhbWVyYSIsInNpemUiLCJpbnZhbGlkYXRlIiwiY29udHJvbHMiLCJzdGF0ZSIsIm9uRml0UmVmIiwiY3VycmVudCIsIm9yaWdpbiIsImNhbVBvcyIsIlZlY3RvcjMiLCJjYW1Sb3QiLCJRdWF0ZXJuaW9uIiwiY2FtWm9vbSIsImdvYWwiLCJ1bmRlZmluZWQiLCJjYW1VcCIsInRhcmdldCIsImFuaW1hdGlvblN0YXRlIiwiTk9ORSIsImJveCIsInVzZVN0YXRlIiwiQm94MyIsImFwaSIsInVzZU1lbW8iLCJnZXRTaXplIiwiYm94U2l6ZSIsImNlbnRlciIsImdldENlbnRlciIsIm1heFNpemUiLCJtYXgiLCJ4IiwieSIsInoiLCJmaXRIZWlnaHREaXN0YW5jZSIsImF0YW4iLCJQSSIsImZvdiIsImZpdFdpZHRoRGlzdGFuY2UiLCJhc3BlY3QiLCJkaXN0YW5jZSIsInJlZnJlc2giLCJvYmplY3QiLCJjb3B5IiwidXBkYXRlV29ybGRNYXRyaXgiLCJzZXRGcm9tT2JqZWN0IiwiaXNFbXB0eSIsInBvc2l0aW9uIiwibGVuZ3RoIiwic2V0RnJvbUNlbnRlckFuZFNpemUiLCJxdWF0ZXJuaW9uIiwiem9vbSIsInJlc2V0IiwiZGlyZWN0aW9uIiwiY2xvbmUiLCJzdWIiLCJub3JtYWxpemUiLCJhZGRTY2FsZWRWZWN0b3IiLCJtQ2FtUm90IiwiTWF0cml4NCIsImxvb2tBdCIsInVwIiwic2V0RnJvbVJvdGF0aW9uTWF0cml4IiwiU1RBUlQiLCJtb3ZlVG8iLCJBcnJheSIsImlzQXJyYXkiLCJ0byIsIm1heEhlaWdodCIsIm1heFdpZHRoIiwidmVydGljZXMiLCJtaW4iLCJwb3MiLCJtQ2FtV0ludiIsInNldFBvc2l0aW9uIiwiaW52ZXJ0IiwibWF0cml4V29ybGRJbnZlcnNlIiwidiIsImFwcGx5TWF0cml4NCIsImFicyIsInpvb21Gb3JIZWlnaHQiLCJ0b3AiLCJib3R0b20iLCJ6b29tRm9yV2lkdGgiLCJyaWdodCIsImxlZnQiLCJuZWFyIiwiZmFyIiwidXBkYXRlUHJvamVjdGlvbk1hdHJpeCIsIm1heERpc3RhbmNlIiwidXBkYXRlIiwidXNlTGF5b3V0RWZmZWN0IiwiY2FsbGJhY2siLCJmcm9udCIsInNldEZyb21NYXRyaXhDb2x1bW4iLCJtYXRyaXgiLCJkMCIsImRpc3RhbmNlVG8iLCJkMSIsImQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvdW50IiwiZGVsdGEiLCJBQ1RJVkUiLCJ1cGRhdGVNYXRyaXhXb3JsZCIsImsiLCJsZXJwVmVjdG9ycyIsInNsZXJwUXVhdGVybmlvbnMiLCJzZXQiLCJhcHBseVF1YXRlcm5pb24iLCJjcmVhdGVFbGVtZW50IiwiUHJvdmlkZXIiLCJ2YWx1ZSIsInVzZUJvdW5kcyIsInVzZUNvbnRleHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/Bounds.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/Center.js":
/*!*******************************************************!*\
  !*** ./node_modules/@react-three/drei/core/Center.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Center: () => (/* binding */ Center)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\n\nconst Center = /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(function Center({ children, disable, disableX, disableY, disableZ, left, right, top, bottom, front, back, onCentered, precise = true, cacheKey = 0, ...props }, fRef) {\n    const ref = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const outer = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const inner = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        outer.current.matrixWorld.identity();\n        const box3 = new three__WEBPACK_IMPORTED_MODULE_2__.Box3().setFromObject(inner.current, precise);\n        const center = new three__WEBPACK_IMPORTED_MODULE_2__.Vector3();\n        const sphere = new three__WEBPACK_IMPORTED_MODULE_2__.Sphere();\n        const width = box3.max.x - box3.min.x;\n        const height = box3.max.y - box3.min.y;\n        const depth = box3.max.z - box3.min.z;\n        box3.getCenter(center);\n        box3.getBoundingSphere(sphere);\n        const vAlign = top ? height / 2 : bottom ? -height / 2 : 0;\n        const hAlign = left ? -width / 2 : right ? width / 2 : 0;\n        const dAlign = front ? depth / 2 : back ? -depth / 2 : 0;\n        outer.current.position.set(disable || disableX ? 0 : -center.x + hAlign, disable || disableY ? 0 : -center.y + vAlign, disable || disableZ ? 0 : -center.z + dAlign);\n        // Only fire onCentered if the bounding box has changed\n        if (typeof onCentered !== \"undefined\") {\n            onCentered({\n                parent: ref.current.parent,\n                container: ref.current,\n                width,\n                height,\n                depth,\n                boundingBox: box3,\n                boundingSphere: sphere,\n                center: center,\n                verticalAlignment: vAlign,\n                horizontalAlignment: hAlign,\n                depthAlignment: dAlign\n            });\n        }\n    }, [\n        cacheKey,\n        onCentered,\n        top,\n        left,\n        front,\n        disable,\n        disableX,\n        disableY,\n        disableZ,\n        precise,\n        right,\n        bottom,\n        back\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle(fRef, ()=>ref.current, []);\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        ref: ref\n    }, props), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", {\n        ref: outer\n    }, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", {\n        ref: inner\n    }, children)));\n});\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9DZW50ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMEQ7QUFDWjtBQUNmO0FBRS9CLE1BQU1LLFNBQVMsYUFBYSxpQkFBRUQsNkNBQWdCLENBQUMsU0FBU0MsT0FBTyxFQUM3REUsUUFBUSxFQUNSQyxPQUFPLEVBQ1BDLFFBQVEsRUFDUkMsUUFBUSxFQUNSQyxRQUFRLEVBQ1JDLElBQUksRUFDSkMsS0FBSyxFQUNMQyxHQUFHLEVBQ0hDLE1BQU0sRUFDTkMsS0FBSyxFQUNMQyxJQUFJLEVBQ0pDLFVBQVUsRUFDVkMsVUFBVSxJQUFJLEVBQ2RDLFdBQVcsQ0FBQyxFQUNaLEdBQUdDLE9BQ0osRUFBRUMsSUFBSTtJQUNMLE1BQU1DLE1BQU1uQix5Q0FBWSxDQUFDO0lBQ3pCLE1BQU1xQixRQUFRckIseUNBQVksQ0FBQztJQUMzQixNQUFNc0IsUUFBUXRCLHlDQUFZLENBQUM7SUFDM0JBLGtEQUFxQixDQUFDO1FBQ3BCcUIsTUFBTUcsT0FBTyxDQUFDQyxXQUFXLENBQUNDLFFBQVE7UUFDbEMsTUFBTUMsT0FBTyxJQUFJOUIsdUNBQUlBLEdBQUcrQixhQUFhLENBQUNOLE1BQU1FLE9BQU8sRUFBRVQ7UUFDckQsTUFBTWMsU0FBUyxJQUFJL0IsMENBQU9BO1FBQzFCLE1BQU1nQyxTQUFTLElBQUkvQix5Q0FBTUE7UUFDekIsTUFBTWdDLFFBQVFKLEtBQUtLLEdBQUcsQ0FBQ0MsQ0FBQyxHQUFHTixLQUFLTyxHQUFHLENBQUNELENBQUM7UUFDckMsTUFBTUUsU0FBU1IsS0FBS0ssR0FBRyxDQUFDSSxDQUFDLEdBQUdULEtBQUtPLEdBQUcsQ0FBQ0UsQ0FBQztRQUN0QyxNQUFNQyxRQUFRVixLQUFLSyxHQUFHLENBQUNNLENBQUMsR0FBR1gsS0FBS08sR0FBRyxDQUFDSSxDQUFDO1FBQ3JDWCxLQUFLWSxTQUFTLENBQUNWO1FBQ2ZGLEtBQUthLGlCQUFpQixDQUFDVjtRQUN2QixNQUFNVyxTQUFTL0IsTUFBTXlCLFNBQVMsSUFBSXhCLFNBQVMsQ0FBQ3dCLFNBQVMsSUFBSTtRQUN6RCxNQUFNTyxTQUFTbEMsT0FBTyxDQUFDdUIsUUFBUSxJQUFJdEIsUUFBUXNCLFFBQVEsSUFBSTtRQUN2RCxNQUFNWSxTQUFTL0IsUUFBUXlCLFFBQVEsSUFBSXhCLE9BQU8sQ0FBQ3dCLFFBQVEsSUFBSTtRQUN2RGhCLE1BQU1HLE9BQU8sQ0FBQ29CLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDekMsV0FBV0MsV0FBVyxJQUFJLENBQUN3QixPQUFPSSxDQUFDLEdBQUdTLFFBQVF0QyxXQUFXRSxXQUFXLElBQUksQ0FBQ3VCLE9BQU9PLENBQUMsR0FBR0ssUUFBUXJDLFdBQVdHLFdBQVcsSUFBSSxDQUFDc0IsT0FBT1MsQ0FBQyxHQUFHSztRQUU3Six1REFBdUQ7UUFDdkQsSUFBSSxPQUFPN0IsZUFBZSxhQUFhO1lBQ3JDQSxXQUFXO2dCQUNUZ0MsUUFBUTNCLElBQUlLLE9BQU8sQ0FBQ3NCLE1BQU07Z0JBQzFCQyxXQUFXNUIsSUFBSUssT0FBTztnQkFDdEJPO2dCQUNBSTtnQkFDQUU7Z0JBQ0FXLGFBQWFyQjtnQkFDYnNCLGdCQUFnQm5CO2dCQUNoQkQsUUFBUUE7Z0JBQ1JxQixtQkFBbUJUO2dCQUNuQlUscUJBQXFCVDtnQkFDckJVLGdCQUFnQlQ7WUFDbEI7UUFDRjtJQUNGLEdBQUc7UUFBQzNCO1FBQVVGO1FBQVlKO1FBQUtGO1FBQU1JO1FBQU9SO1FBQVNDO1FBQVVDO1FBQVVDO1FBQVVRO1FBQVNOO1FBQU9FO1FBQVFFO0tBQUs7SUFDaEhiLHNEQUF5QixDQUFDa0IsTUFBTSxJQUFNQyxJQUFJSyxPQUFPLEVBQUUsRUFBRTtJQUNyRCxPQUFPLFdBQVcsR0FBRXhCLGdEQUFtQixDQUFDLFNBQVNKLDhFQUFRQSxDQUFDO1FBQ3hEdUIsS0FBS0E7SUFDUCxHQUFHRixRQUFRLFdBQVcsR0FBRWpCLGdEQUFtQixDQUFDLFNBQVM7UUFDbkRtQixLQUFLRTtJQUNQLEdBQUcsV0FBVyxHQUFFckIsZ0RBQW1CLENBQUMsU0FBUztRQUMzQ21CLEtBQUtHO0lBQ1AsR0FBR25CO0FBQ0w7QUFFa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW5qeW90aS1sZWFybmluZy8uL25vZGVfbW9kdWxlcy9AcmVhY3QtdGhyZWUvZHJlaS9jb3JlL0NlbnRlci5qcz9iYzYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfZXh0ZW5kcyBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzJztcbmltcG9ydCB7IEJveDMsIFZlY3RvcjMsIFNwaGVyZSB9IGZyb20gJ3RocmVlJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuY29uc3QgQ2VudGVyID0gLyogQF9fUFVSRV9fICovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiBDZW50ZXIoe1xuICBjaGlsZHJlbixcbiAgZGlzYWJsZSxcbiAgZGlzYWJsZVgsXG4gIGRpc2FibGVZLFxuICBkaXNhYmxlWixcbiAgbGVmdCxcbiAgcmlnaHQsXG4gIHRvcCxcbiAgYm90dG9tLFxuICBmcm9udCxcbiAgYmFjayxcbiAgb25DZW50ZXJlZCxcbiAgcHJlY2lzZSA9IHRydWUsXG4gIGNhY2hlS2V5ID0gMCxcbiAgLi4ucHJvcHNcbn0sIGZSZWYpIHtcbiAgY29uc3QgcmVmID0gUmVhY3QudXNlUmVmKG51bGwpO1xuICBjb25zdCBvdXRlciA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgY29uc3QgaW5uZXIgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIFJlYWN0LnVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgb3V0ZXIuY3VycmVudC5tYXRyaXhXb3JsZC5pZGVudGl0eSgpO1xuICAgIGNvbnN0IGJveDMgPSBuZXcgQm94MygpLnNldEZyb21PYmplY3QoaW5uZXIuY3VycmVudCwgcHJlY2lzZSk7XG4gICAgY29uc3QgY2VudGVyID0gbmV3IFZlY3RvcjMoKTtcbiAgICBjb25zdCBzcGhlcmUgPSBuZXcgU3BoZXJlKCk7XG4gICAgY29uc3Qgd2lkdGggPSBib3gzLm1heC54IC0gYm94My5taW4ueDtcbiAgICBjb25zdCBoZWlnaHQgPSBib3gzLm1heC55IC0gYm94My5taW4ueTtcbiAgICBjb25zdCBkZXB0aCA9IGJveDMubWF4LnogLSBib3gzLm1pbi56O1xuICAgIGJveDMuZ2V0Q2VudGVyKGNlbnRlcik7XG4gICAgYm94My5nZXRCb3VuZGluZ1NwaGVyZShzcGhlcmUpO1xuICAgIGNvbnN0IHZBbGlnbiA9IHRvcCA/IGhlaWdodCAvIDIgOiBib3R0b20gPyAtaGVpZ2h0IC8gMiA6IDA7XG4gICAgY29uc3QgaEFsaWduID0gbGVmdCA/IC13aWR0aCAvIDIgOiByaWdodCA/IHdpZHRoIC8gMiA6IDA7XG4gICAgY29uc3QgZEFsaWduID0gZnJvbnQgPyBkZXB0aCAvIDIgOiBiYWNrID8gLWRlcHRoIC8gMiA6IDA7XG4gICAgb3V0ZXIuY3VycmVudC5wb3NpdGlvbi5zZXQoZGlzYWJsZSB8fCBkaXNhYmxlWCA/IDAgOiAtY2VudGVyLnggKyBoQWxpZ24sIGRpc2FibGUgfHwgZGlzYWJsZVkgPyAwIDogLWNlbnRlci55ICsgdkFsaWduLCBkaXNhYmxlIHx8IGRpc2FibGVaID8gMCA6IC1jZW50ZXIueiArIGRBbGlnbik7XG5cbiAgICAvLyBPbmx5IGZpcmUgb25DZW50ZXJlZCBpZiB0aGUgYm91bmRpbmcgYm94IGhhcyBjaGFuZ2VkXG4gICAgaWYgKHR5cGVvZiBvbkNlbnRlcmVkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgb25DZW50ZXJlZCh7XG4gICAgICAgIHBhcmVudDogcmVmLmN1cnJlbnQucGFyZW50LFxuICAgICAgICBjb250YWluZXI6IHJlZi5jdXJyZW50LFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgaGVpZ2h0LFxuICAgICAgICBkZXB0aCxcbiAgICAgICAgYm91bmRpbmdCb3g6IGJveDMsXG4gICAgICAgIGJvdW5kaW5nU3BoZXJlOiBzcGhlcmUsXG4gICAgICAgIGNlbnRlcjogY2VudGVyLFxuICAgICAgICB2ZXJ0aWNhbEFsaWdubWVudDogdkFsaWduLFxuICAgICAgICBob3Jpem9udGFsQWxpZ25tZW50OiBoQWxpZ24sXG4gICAgICAgIGRlcHRoQWxpZ25tZW50OiBkQWxpZ25cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgW2NhY2hlS2V5LCBvbkNlbnRlcmVkLCB0b3AsIGxlZnQsIGZyb250LCBkaXNhYmxlLCBkaXNhYmxlWCwgZGlzYWJsZVksIGRpc2FibGVaLCBwcmVjaXNlLCByaWdodCwgYm90dG9tLCBiYWNrXSk7XG4gIFJlYWN0LnVzZUltcGVyYXRpdmVIYW5kbGUoZlJlZiwgKCkgPT4gcmVmLmN1cnJlbnQsIFtdKTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZ3JvdXBcIiwgX2V4dGVuZHMoe1xuICAgIHJlZjogcmVmXG4gIH0sIHByb3BzKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJncm91cFwiLCB7XG4gICAgcmVmOiBvdXRlclxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImdyb3VwXCIsIHtcbiAgICByZWY6IGlubmVyXG4gIH0sIGNoaWxkcmVuKSkpO1xufSk7XG5cbmV4cG9ydCB7IENlbnRlciB9O1xuIl0sIm5hbWVzIjpbIl9leHRlbmRzIiwiQm94MyIsIlZlY3RvcjMiLCJTcGhlcmUiLCJSZWFjdCIsIkNlbnRlciIsImZvcndhcmRSZWYiLCJjaGlsZHJlbiIsImRpc2FibGUiLCJkaXNhYmxlWCIsImRpc2FibGVZIiwiZGlzYWJsZVoiLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJmcm9udCIsImJhY2siLCJvbkNlbnRlcmVkIiwicHJlY2lzZSIsImNhY2hlS2V5IiwicHJvcHMiLCJmUmVmIiwicmVmIiwidXNlUmVmIiwib3V0ZXIiLCJpbm5lciIsInVzZUxheW91dEVmZmVjdCIsImN1cnJlbnQiLCJtYXRyaXhXb3JsZCIsImlkZW50aXR5IiwiYm94MyIsInNldEZyb21PYmplY3QiLCJjZW50ZXIiLCJzcGhlcmUiLCJ3aWR0aCIsIm1heCIsIngiLCJtaW4iLCJoZWlnaHQiLCJ5IiwiZGVwdGgiLCJ6IiwiZ2V0Q2VudGVyIiwiZ2V0Qm91bmRpbmdTcGhlcmUiLCJ2QWxpZ24iLCJoQWxpZ24iLCJkQWxpZ24iLCJwb3NpdGlvbiIsInNldCIsInBhcmVudCIsImNvbnRhaW5lciIsImJvdW5kaW5nQm94IiwiYm91bmRpbmdTcGhlcmUiLCJ2ZXJ0aWNhbEFsaWdubWVudCIsImhvcml6b250YWxBbGlnbm1lbnQiLCJkZXB0aEFsaWdubWVudCIsInVzZUltcGVyYXRpdmVIYW5kbGUiLCJjcmVhdGVFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/Center.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/ContactShadows.js":
/*!***************************************************************!*\
  !*** ./node_modules/@react-three/drei/core/ContactShadows.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContactShadows: () => (/* binding */ ContactShadows)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/shaders/HorizontalBlurShader.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/shaders/VerticalBlurShader.js\");\n\n\n\n\n\nconst ContactShadows = /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({ scale = 10, frames = Infinity, opacity = 1, width = 1, height = 1, blur = 1, near = 0, far = 10, resolution = 512, smooth = true, color = \"#000000\", depthWrite = false, renderOrder, ...props }, fref)=>{\n    const ref = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const scene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.scene);\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.gl);\n    const shadowCamera = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    width = width * (Array.isArray(scale) ? scale[0] : scale || 1);\n    height = height * (Array.isArray(scale) ? scale[1] : scale || 1);\n    const [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur] = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>{\n        const renderTarget = new three__WEBPACK_IMPORTED_MODULE_3__.WebGLRenderTarget(resolution, resolution);\n        const renderTargetBlur = new three__WEBPACK_IMPORTED_MODULE_3__.WebGLRenderTarget(resolution, resolution);\n        renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n        const planeGeometry = new three__WEBPACK_IMPORTED_MODULE_3__.PlaneGeometry(width, height).rotateX(Math.PI / 2);\n        const blurPlane = new three__WEBPACK_IMPORTED_MODULE_3__.Mesh(planeGeometry);\n        const depthMaterial = new three__WEBPACK_IMPORTED_MODULE_3__.MeshDepthMaterial();\n        depthMaterial.depthTest = depthMaterial.depthWrite = false;\n        depthMaterial.onBeforeCompile = (shader)=>{\n            shader.uniforms = {\n                ...shader.uniforms,\n                ucolor: {\n                    value: new three__WEBPACK_IMPORTED_MODULE_3__.Color(color)\n                }\n            };\n            shader.fragmentShader = shader.fragmentShader.replace(`void main() {`, //\n            `uniform vec3 ucolor;\n           void main() {\n          `);\n            shader.fragmentShader = shader.fragmentShader.replace(\"vec4( vec3( 1.0 - fragCoordZ ), opacity );\", // Colorize the shadow, multiply by the falloff so that the center can remain darker\n            \"vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );\");\n        };\n        const horizontalBlurMaterial = new three__WEBPACK_IMPORTED_MODULE_3__.ShaderMaterial(three_stdlib__WEBPACK_IMPORTED_MODULE_4__.HorizontalBlurShader);\n        const verticalBlurMaterial = new three__WEBPACK_IMPORTED_MODULE_3__.ShaderMaterial(three_stdlib__WEBPACK_IMPORTED_MODULE_5__.VerticalBlurShader);\n        verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n        return [\n            renderTarget,\n            planeGeometry,\n            depthMaterial,\n            blurPlane,\n            horizontalBlurMaterial,\n            verticalBlurMaterial,\n            renderTargetBlur\n        ];\n    }, [\n        resolution,\n        width,\n        height,\n        scale,\n        color\n    ]);\n    const blurShadows = (blur)=>{\n        blurPlane.visible = true;\n        blurPlane.material = horizontalBlurMaterial;\n        horizontalBlurMaterial.uniforms.tDiffuse.value = renderTarget.texture;\n        horizontalBlurMaterial.uniforms.h.value = blur * 1 / 256;\n        gl.setRenderTarget(renderTargetBlur);\n        gl.render(blurPlane, shadowCamera.current);\n        blurPlane.material = verticalBlurMaterial;\n        verticalBlurMaterial.uniforms.tDiffuse.value = renderTargetBlur.texture;\n        verticalBlurMaterial.uniforms.v.value = blur * 1 / 256;\n        gl.setRenderTarget(renderTarget);\n        gl.render(blurPlane, shadowCamera.current);\n        blurPlane.visible = false;\n    };\n    let count = 0;\n    let initialBackground;\n    let initialOverrideMaterial;\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.C)(()=>{\n        if (shadowCamera.current && (frames === Infinity || count < frames)) {\n            count++;\n            initialBackground = scene.background;\n            initialOverrideMaterial = scene.overrideMaterial;\n            ref.current.visible = false;\n            scene.background = null;\n            scene.overrideMaterial = depthMaterial;\n            gl.setRenderTarget(renderTarget);\n            gl.render(scene, shadowCamera.current);\n            blurShadows(blur);\n            if (smooth) blurShadows(blur * 0.4);\n            gl.setRenderTarget(null);\n            ref.current.visible = true;\n            scene.overrideMaterial = initialOverrideMaterial;\n            scene.background = initialBackground;\n        }\n    });\n    react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle(fref, ()=>ref.current, []);\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        \"rotation-x\": Math.PI / 2\n    }, props, {\n        ref: ref\n    }), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"mesh\", {\n        renderOrder: renderOrder,\n        geometry: planeGeometry,\n        scale: [\n            1,\n            -1,\n            1\n        ],\n        rotation: [\n            -Math.PI / 2,\n            0,\n            0\n        ]\n    }, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"meshBasicMaterial\", {\n        transparent: true,\n        map: renderTarget.texture,\n        opacity: opacity,\n        depthWrite: depthWrite\n    })), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"orthographicCamera\", {\n        ref: shadowCamera,\n        args: [\n            -width / 2,\n            width / 2,\n            height / 2,\n            -height / 2,\n            near,\n            far\n        ]\n    }));\n});\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9Db250YWN0U2hhZG93cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUEwRDtBQUMzQjtBQUNBO0FBQ3lCO0FBQ2dCO0FBRXhFLE1BQU1PLGlCQUFpQixhQUFhLGlCQUFFTiw2Q0FBZ0IsQ0FBQyxDQUFDLEVBQ3REUSxRQUFRLEVBQUUsRUFDVkMsU0FBU0MsUUFBUSxFQUNqQkMsVUFBVSxDQUFDLEVBQ1hDLFFBQVEsQ0FBQyxFQUNUQyxTQUFTLENBQUMsRUFDVkMsT0FBTyxDQUFDLEVBQ1JDLE9BQU8sQ0FBQyxFQUNSQyxNQUFNLEVBQUUsRUFDUkMsYUFBYSxHQUFHLEVBQ2hCQyxTQUFTLElBQUksRUFDYkMsUUFBUSxTQUFTLEVBQ2pCQyxhQUFhLEtBQUssRUFDbEJDLFdBQVcsRUFDWCxHQUFHQyxPQUNKLEVBQUVDO0lBQ0QsTUFBTUMsTUFBTXhCLHlDQUFZLENBQUM7SUFDekIsTUFBTTBCLFFBQVF4QixxREFBUUEsQ0FBQ3lCLENBQUFBLFFBQVNBLE1BQU1ELEtBQUs7SUFDM0MsTUFBTUUsS0FBSzFCLHFEQUFRQSxDQUFDeUIsQ0FBQUEsUUFBU0EsTUFBTUMsRUFBRTtJQUNyQyxNQUFNQyxlQUFlN0IseUNBQVksQ0FBQztJQUNsQ1ksUUFBUUEsUUFBU2tCLENBQUFBLE1BQU1DLE9BQU8sQ0FBQ3ZCLFNBQVNBLEtBQUssQ0FBQyxFQUFFLEdBQUdBLFNBQVM7SUFDNURLLFNBQVNBLFNBQVVpQixDQUFBQSxNQUFNQyxPQUFPLENBQUN2QixTQUFTQSxLQUFLLENBQUMsRUFBRSxHQUFHQSxTQUFTO0lBQzlELE1BQU0sQ0FBQ3dCLGNBQWNDLGVBQWVDLGVBQWVDLFdBQVdDLHdCQUF3QkMsc0JBQXNCQyxpQkFBaUIsR0FBR3RDLDBDQUFhLENBQUM7UUFDNUksTUFBTWdDLGVBQWUsSUFBSS9CLG9EQUF1QixDQUFDZ0IsWUFBWUE7UUFDN0QsTUFBTXFCLG1CQUFtQixJQUFJckMsb0RBQXVC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dEJsQyxNQUFNOEMsZ0JBQWdCLEdBQUdGO1lBQ3pCNUMsTUFBTTZDLFVBQVUsR0FBR0Y7UUFDckI7SUFDRjtJQUNBckUsc0RBQXlCLENBQUN1QixNQUFNLElBQU1DLElBQUkwQyxPQUFPLEVBQUUsRUFBRTtJQUNyRCxPQUFPLFdBQVcsR0FBRWxFLGdEQUFtQixDQUFDLFNBQVNELDhFQUFRQSxDQUFDO1FBQ3hELGNBQWM4QyxLQUFLQyxFQUFFLEdBQUc7SUFDMUIsR0FBR3hCLE9BQU87UUFDUkUsS0FBS0E7SUFDUCxJQUFJLFdBQVcsR0FBRXhCLGdEQUFtQixDQUFDLFFBQVE7UUFDM0NxQixhQUFhQTtRQUNic0QsVUFBVTFDO1FBQ1Z6QixPQUFPO1lBQUM7WUFBRyxDQUFDO1lBQUc7U0FBRTtRQUNqQm9FLFVBQVU7WUFBQyxDQUFDL0IsS0FBS0MsRUFBRSxHQUFHO1lBQUc7WUFBRztTQUFFO0lBQ2hDLEdBQUcsV0FBVyxHQUFFOUMsZ0RBQW1CLENBQUMscUJBQXFCO1FBQ3ZENkUsYUFBYTtRQUNiQyxLQUFLOUMsYUFBYVMsT0FBTztRQUN6QjlCLFNBQVNBO1FBQ1RTLFlBQVlBO0lBQ2QsS0FBSyxXQUFXLEdBQUVwQixnREFBbUIsQ0FBQyxzQkFBc0I7UUFDMUR3QixLQUFLSztRQUNMa0QsTUFBTTtZQUFDLENBQUNuRSxRQUFRO1lBQUdBLFFBQVE7WUFBR0MsU0FBUztZQUFHLENBQUNBLFNBQVM7WUFBR0U7WUFBTUM7U0FBSTtJQUNuRTtBQUNGO0FBRTBCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2FuanlvdGktbGVhcm5pbmcvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9Db250YWN0U2hhZG93cy5qcz8zNzU1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfZXh0ZW5kcyBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJztcbmltcG9ydCB7IHVzZVRocmVlLCB1c2VGcmFtZSB9IGZyb20gJ0ByZWFjdC10aHJlZS9maWJlcic7XG5pbXBvcnQgeyBIb3Jpem9udGFsQmx1clNoYWRlciwgVmVydGljYWxCbHVyU2hhZGVyIH0gZnJvbSAndGhyZWUtc3RkbGliJztcblxuY29uc3QgQ29udGFjdFNoYWRvd3MgPSAvKiBAX19QVVJFX18gKi9SZWFjdC5mb3J3YXJkUmVmKCh7XG4gIHNjYWxlID0gMTAsXG4gIGZyYW1lcyA9IEluZmluaXR5LFxuICBvcGFjaXR5ID0gMSxcbiAgd2lkdGggPSAxLFxuICBoZWlnaHQgPSAxLFxuICBibHVyID0gMSxcbiAgbmVhciA9IDAsXG4gIGZhciA9IDEwLFxuICByZXNvbHV0aW9uID0gNTEyLFxuICBzbW9vdGggPSB0cnVlLFxuICBjb2xvciA9ICcjMDAwMDAwJyxcbiAgZGVwdGhXcml0ZSA9IGZhbHNlLFxuICByZW5kZXJPcmRlcixcbiAgLi4ucHJvcHNcbn0sIGZyZWYpID0+IHtcbiAgY29uc3QgcmVmID0gUmVhY3QudXNlUmVmKG51bGwpO1xuICBjb25zdCBzY2VuZSA9IHVzZVRocmVlKHN0YXRlID0+IHN0YXRlLnNjZW5lKTtcbiAgY29uc3QgZ2wgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5nbCk7XG4gIGNvbnN0IHNoYWRvd0NhbWVyYSA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgd2lkdGggPSB3aWR0aCAqIChBcnJheS5pc0FycmF5KHNjYWxlKSA/IHNjYWxlWzBdIDogc2NhbGUgfHwgMSk7XG4gIGhlaWdodCA9IGhlaWdodCAqIChBcnJheS5pc0FycmF5KHNjYWxlKSA/IHNjYWxlWzFdIDogc2NhbGUgfHwgMSk7XG4gIGNvbnN0IFtyZW5kZXJUYXJnZXQsIHBsYW5lR2VvbWV0cnksIGRlcHRoTWF0ZXJpYWwsIGJsdXJQbGFuZSwgaG9yaXpvbnRhbEJsdXJNYXRlcmlhbCwgdmVydGljYWxCbHVyTWF0ZXJpYWwsIHJlbmRlclRhcmdldEJsdXJdID0gUmVhY3QudXNlTWVtbygoKSA9PiB7XG4gICAgY29uc3QgcmVuZGVyVGFyZ2V0ID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0KHJlc29sdXRpb24sIHJlc29sdXRpb24pO1xuICAgIGNvbnN0IHJlbmRlclRhcmdldEJsdXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQocmVzb2x1dGlvbiwgcmVzb2x1dGlvbik7XG4gICAgcmVuZGVyVGFyZ2V0Qmx1ci50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IHJlbmRlclRhcmdldC50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlO1xuICAgIGNvbnN0IHBsYW5lR2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSh3aWR0aCwgaGVpZ2h0KS5yb3RhdGVYKE1hdGguUEkgLyAyKTtcbiAgICBjb25zdCBibHVyUGxhbmUgPSBuZXcgVEhSRUUuTWVzaChwbGFuZUdlb21ldHJ5KTtcbiAgICBjb25zdCBkZXB0aE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hEZXB0aE1hdGVyaWFsKCk7XG4gICAgZGVwdGhNYXRlcmlhbC5kZXB0aFRlc3QgPSBkZXB0aE1hdGVyaWFsLmRlcHRoV3JpdGUgPSBmYWxzZTtcbiAgICBkZXB0aE1hdGVyaWFsLm9uQmVmb3JlQ29tcGlsZSA9IHNoYWRlciA9PiB7XG4gICAgICBzaGFkZXIudW5pZm9ybXMgPSB7XG4gICAgICAgIC4uLnNoYWRlci51bmlmb3JtcyxcbiAgICAgICAgdWNvbG9yOiB7XG4gICAgICAgICAgdmFsdWU6IG5ldyBUSFJFRS5Db2xvcihjb2xvcilcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHNoYWRlci5mcmFnbWVudFNoYWRlciA9IHNoYWRlci5mcmFnbWVudFNoYWRlci5yZXBsYWNlKGB2b2lkIG1haW4oKSB7YCxcbiAgICAgIC8vXG4gICAgICBgdW5pZm9ybSB2ZWMzIHVjb2xvcjtcbiAgICAgICAgICAgdm9pZCBtYWluKCkge1xuICAgICAgICAgIGApO1xuICAgICAgc2hhZGVyLmZyYWdtZW50U2hhZGVyID0gc2hhZGVyLmZyYWdtZW50U2hhZGVyLnJlcGxhY2UoJ3ZlYzQoIHZlYzMoIDEuMCAtIGZyYWdDb29yZFogKSwgb3BhY2l0eSApOycsXG4gICAgICAvLyBDb2xvcml6ZSB0aGUgc2hhZG93LCBtdWx0aXBseSBieSB0aGUgZmFsbG9mZiBzbyB0aGF0IHRoZSBjZW50ZXIgY2FuIHJlbWFpbiBkYXJrZXJcbiAgICAgICd2ZWM0KCB1Y29sb3IgKiBmcmFnQ29vcmRaICogMi4wLCAoIDEuMCAtIGZyYWdDb29yZFogKSAqIDEuMCApOycpO1xuICAgIH07XG4gICAgY29uc3QgaG9yaXpvbnRhbEJsdXJNYXRlcmlhbCA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbChIb3Jpem9udGFsQmx1clNoYWRlcik7XG4gICAgY29uc3QgdmVydGljYWxCbHVyTWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoVmVydGljYWxCbHVyU2hhZGVyKTtcbiAgICB2ZXJ0aWNhbEJsdXJNYXRlcmlhbC5kZXB0aFRlc3QgPSBob3Jpem9udGFsQmx1ck1hdGVyaWFsLmRlcHRoVGVzdCA9IGZhbHNlO1xuICAgIHJldHVybiBbcmVuZGVyVGFyZ2V0LCBwbGFuZUdlb21ldHJ5LCBkZXB0aE1hdGVyaWFsLCBibHVyUGxhbmUsIGhvcml6b250YWxCbHVyTWF0ZXJpYWwsIHZlcnRpY2FsQmx1ck1hdGVyaWFsLCByZW5kZXJUYXJnZXRCbHVyXTtcbiAgfSwgW3Jlc29sdXRpb24sIHdpZHRoLCBoZWlnaHQsIHNjYWxlLCBjb2xvcl0pO1xuICBjb25zdCBibHVyU2hhZG93cyA9IGJsdXIgPT4ge1xuICAgIGJsdXJQbGFuZS52aXNpYmxlID0gdHJ1ZTtcbiAgICBibHVyUGxhbmUubWF0ZXJpYWwgPSBob3Jpem9udGFsQmx1ck1hdGVyaWFsO1xuICAgIGhvcml6b250YWxCbHVyTWF0ZXJpYWwudW5pZm9ybXMudERpZmZ1c2UudmFsdWUgPSByZW5kZXJUYXJnZXQudGV4dHVyZTtcbiAgICBob3Jpem9udGFsQmx1ck1hdGVyaWFsLnVuaWZvcm1zLmgudmFsdWUgPSBibHVyICogMSAvIDI1NjtcbiAgICBnbC5zZXRSZW5kZXJUYXJnZXQocmVuZGVyVGFyZ2V0Qmx1cik7XG4gICAgZ2wucmVuZGVyKGJsdXJQbGFuZSwgc2hhZG93Q2FtZXJhLmN1cnJlbnQpO1xuICAgIGJsdXJQbGFuZS5tYXRlcmlhbCA9IHZlcnRpY2FsQmx1ck1hdGVyaWFsO1xuICAgIHZlcnRpY2FsQmx1ck1hdGVyaWFsLnVuaWZvcm1zLnREaWZmdXNlLnZhbHVlID0gcmVuZGVyVGFyZ2V0Qmx1ci50ZXh0dXJlO1xuICAgIHZlcnRpY2FsQmx1ck1hdGVyaWFsLnVuaWZvcm1zLnYudmFsdWUgPSBibHVyICogMSAvIDI1NjtcbiAgICBnbC5zZXRSZW5kZXJUYXJnZXQocmVuZGVyVGFyZ2V0KTtcbiAgICBnbC5yZW5kZXIoYmx1clBsYW5lLCBzaGFkb3dDYW1lcmEuY3VycmVudCk7XG4gICAgYmx1clBsYW5lLnZpc2libGUgPSBmYWxzZTtcbiAgfTtcbiAgbGV0IGNvdW50ID0gMDtcbiAgbGV0IGluaXRpYWxCYWNrZ3JvdW5kO1xuICBsZXQgaW5pdGlhbE92ZXJyaWRlTWF0ZXJpYWw7XG4gIHVzZUZyYW1lKCgpID0+IHtcbiAgICBpZiAoc2hhZG93Q2FtZXJhLmN1cnJlbnQgJiYgKGZyYW1lcyA9PT0gSW5maW5pdHkgfHwgY291bnQgPCBmcmFtZXMpKSB7XG4gICAgICBjb3VudCsrO1xuICAgICAgaW5pdGlhbEJhY2tncm91bmQgPSBzY2VuZS5iYWNrZ3JvdW5kO1xuICAgICAgaW5pdGlhbE92ZXJyaWRlTWF0ZXJpYWwgPSBzY2VuZS5vdmVycmlkZU1hdGVyaWFsO1xuICAgICAgcmVmLmN1cnJlbnQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgc2NlbmUuYmFja2dyb3VuZCA9IG51bGw7XG4gICAgICBzY2VuZS5vdmVycmlkZU1hdGVyaWFsID0gZGVwdGhNYXRlcmlhbDtcbiAgICAgIGdsLnNldFJlbmRlclRhcmdldChyZW5kZXJUYXJnZXQpO1xuICAgICAgZ2wucmVuZGVyKHNjZW5lLCBzaGFkb3dDYW1lcmEuY3VycmVudCk7XG4gICAgICBibHVyU2hhZG93cyhibHVyKTtcbiAgICAgIGlmIChzbW9vdGgpIGJsdXJTaGFkb3dzKGJsdXIgKiAwLjQpO1xuICAgICAgZ2wuc2V0UmVuZGVyVGFyZ2V0KG51bGwpO1xuICAgICAgcmVmLmN1cnJlbnQudmlzaWJsZSA9IHRydWU7XG4gICAgICBzY2VuZS5vdmVycmlkZU1hdGVyaWFsID0gaW5pdGlhbE92ZXJyaWRlTWF0ZXJpYWw7XG4gICAgICBzY2VuZS5iYWNrZ3JvdW5kID0gaW5pdGlhbEJhY2tncm91bmQ7XG4gICAgfVxuICB9KTtcbiAgUmVhY3QudXNlSW1wZXJhdGl2ZUhhbmRsZShmcmVmLCAoKSA9PiByZWYuY3VycmVudCwgW10pO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJncm91cFwiLCBfZXh0ZW5kcyh7XG4gICAgXCJyb3RhdGlvbi14XCI6IE1hdGguUEkgLyAyXG4gIH0sIHByb3BzLCB7XG4gICAgcmVmOiByZWZcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwibWVzaFwiLCB7XG4gICAgcmVuZGVyT3JkZXI6IHJlbmRlck9yZGVyLFxuICAgIGdlb21ldHJ5OiBwbGFuZUdlb21ldHJ5LFxuICAgIHNjYWxlOiBbMSwgLTEsIDFdLFxuICAgIHJvdGF0aW9uOiBbLU1hdGguUEkgLyAyLCAwLCAwXVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcIm1lc2hCYXNpY01hdGVyaWFsXCIsIHtcbiAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICBtYXA6IHJlbmRlclRhcmdldC50ZXh0dXJlLFxuICAgIG9wYWNpdHk6IG9wYWNpdHksXG4gICAgZGVwdGhXcml0ZTogZGVwdGhXcml0ZVxuICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwib3J0aG9ncmFwaGljQ2FtZXJhXCIsIHtcbiAgICByZWY6IHNoYWRvd0NhbWVyYSxcbiAgICBhcmdzOiBbLXdpZHRoIC8gMiwgd2lkdGggLyAyLCBoZWlnaHQgLyAyLCAtaGVpZ2h0IC8gMiwgbmVhciwgZmFyXVxuICB9KSk7XG59KTtcblxuZXhwb3J0IHsgQ29udGFjdFNoYWRvd3MgfTtcbiJdLCJuYW1lcyI6WyJfZXh0ZW5kcyIsIlJlYWN0IiwiVEhSRUUiLCJ1c2VUaHJlZSIsInVzZUZyYW1lIiwiSG9yaXpvbnRhbEJsdXJTaGFkZXIiLCJWZXJ0aWNhbEJsdXJTaGFkZXIiLCJDb250YWN0U2hhZG93cyIsImZvcndhcmRSZWYiLCJzY2FsZSIsImZyYW1lcyIsIkluZmluaXR5Iiwib3BhY2l0eSIsIndpZHRoIiwiaGVpZ2h0IiwiYmx1ciIsIm5lYXIiLCJmYXIiLCJyZXNvbHV0aW9uIiwic21vb3RoIiwiY29sb3IiLCJkZXB0aFdyaXRlIiwicmVuZGVyT3JkZXIiLCJwcm9wcyIsImZyZWYiLCJyZWYiLCJ1c2VSZWYiLCJzY2VuZSIsInN0YXRlIiwiZ2wiLCJzaGFkb3dDYW1lcmEiLCJBcnJheSIsImlzQXJyYXkiLCJyZW5kZXJUYXJnZXQiLCJwbGFuZUdlb21ldHJ5IiwiZGVwdGhNYXRlcmlhbCIsImJsdXJQbGFuZSIsImhvcml6b250YWxCbHVyTWF0ZXJpYWwiLCJ2ZXJ0aWNhbEJsdXJNYXRlcmlhbCIsInJlbmRlclRhcmdldEJsdXIiLCJ1c2VNZW1vIiwiV2ViR0xSZW5kZXJUYXJnZXQiLCJ0ZXh0dXJlIiwiZ2VuZXJhdGVNaXBtYXBzIiwiUGxhbmVHZW9tZXRyeSIsInJvdGF0ZVgiLCJNYXRoIiwiUEkiLCJNZXNoIiwiTWVzaERlcHRoTWF0ZXJpYWwiLCJkZXB0aFRlc3QiLCJvbkJlZm9yZUNvbXBpbGUiLCJzaGFkZXIiLCJ1bmlmb3JtcyIsInVjb2xvciIsInZhbHVlIiwiQ29sb3IiLCJmcmFnbWVudFNoYWRlciIsInJlcGxhY2UiLCJTaGFkZXJNYXRlcmlhbCIsImJsdXJTaGFkb3dzIiwidmlzaWJsZSIsIm1hdGVyaWFsIiwidERpZmZ1c2UiLCJoIiwic2V0UmVuZGVyVGFyZ2V0IiwicmVuZGVyIiwiY3VycmVudCIsInYiLCJjb3VudCIsImluaXRpYWxCYWNrZ3JvdW5kIiwiaW5pdGlhbE92ZXJyaWRlTWF0ZXJpYWwiLCJiYWNrZ3JvdW5kIiwib3ZlcnJpZGVNYXRlcmlhbCIsInVzZUltcGVyYXRpdmVIYW5kbGUiLCJjcmVhdGVFbGVtZW50IiwiZ2VvbWV0cnkiLCJyb3RhdGlvbiIsInRyYW5zcGFyZW50IiwibWFwIiwiYXJncyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/ContactShadows.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/Environment.js":
/*!************************************************************!*\
  !*** ./node_modules/@react-three/drei/core/Environment.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Environment: () => (/* binding */ Environment),\n/* harmony export */   EnvironmentCube: () => (/* binding */ EnvironmentCube),\n/* harmony export */   EnvironmentMap: () => (/* binding */ EnvironmentMap),\n/* harmony export */   EnvironmentPortal: () => (/* binding */ EnvironmentPortal)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/objects/GroundProjectedEnv.js\");\n/* harmony import */ var _useEnvironment_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./useEnvironment.js */ \"(ssr)/./node_modules/@react-three/drei/core/useEnvironment.js\");\n\n\n\n\n\n\nconst isRef = (obj)=>obj.current && obj.current.isScene;\nconst resolveScene = (scene)=>isRef(scene) ? scene.current : scene;\nfunction setEnvProps(background, scene, defaultScene, texture, sceneProps = {}) {\n    var _sceneProps$blur, _target$backgroundRot, _target$backgroundRot2, _target$environmentRo, _target$environmentRo2;\n    // defaults\n    sceneProps = {\n        backgroundBlurriness: (_sceneProps$blur = sceneProps.blur) !== null && _sceneProps$blur !== void 0 ? _sceneProps$blur : 0,\n        backgroundIntensity: 1,\n        backgroundRotation: [\n            0,\n            0,\n            0\n        ],\n        environmentIntensity: 1,\n        environmentRotation: [\n            0,\n            0,\n            0\n        ],\n        ...sceneProps\n    };\n    const target = resolveScene(scene || defaultScene);\n    const oldbg = target.background;\n    const oldenv = target.environment;\n    const oldSceneProps = {\n        // @ts-ignore\n        backgroundBlurriness: target.backgroundBlurriness,\n        // @ts-ignore\n        backgroundIntensity: target.backgroundIntensity,\n        // @ts-ignore\n        backgroundRotation: (_target$backgroundRot = (_target$backgroundRot2 = target.backgroundRotation) == null || _target$backgroundRot2.clone == null ? void 0 : _target$backgroundRot2.clone()) !== null && _target$backgroundRot !== void 0 ? _target$backgroundRot : [\n            0,\n            0,\n            0\n        ],\n        // @ts-ignore\n        environmentIntensity: target.environmentIntensity,\n        // @ts-ignore\n        environmentRotation: (_target$environmentRo = (_target$environmentRo2 = target.environmentRotation) == null || _target$environmentRo2.clone == null ? void 0 : _target$environmentRo2.clone()) !== null && _target$environmentRo !== void 0 ? _target$environmentRo : [\n            0,\n            0,\n            0\n        ]\n    };\n    if (background !== \"only\") target.environment = texture;\n    if (background) target.background = texture;\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.j)(target, sceneProps);\n    return ()=>{\n        if (background !== \"only\") target.environment = oldenv;\n        if (background) target.background = oldbg;\n        (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.j)(target, oldSceneProps);\n    };\n}\nfunction EnvironmentMap({ scene, background = false, map, ...config }) {\n    const defaultScene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.scene);\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        if (map) return setEnvProps(background, scene, defaultScene, map, config);\n    });\n    return null;\n}\nfunction EnvironmentCube({ background = false, scene, blur, backgroundBlurriness, backgroundIntensity, backgroundRotation, environmentIntensity, environmentRotation, ...rest }) {\n    const texture = (0,_useEnvironment_js__WEBPACK_IMPORTED_MODULE_3__.useEnvironment)(rest);\n    const defaultScene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.scene);\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        return setEnvProps(background, scene, defaultScene, texture, {\n            blur,\n            backgroundBlurriness,\n            backgroundIntensity,\n            backgroundRotation,\n            environmentIntensity,\n            environmentRotation\n        });\n    });\n    return null;\n}\nfunction EnvironmentPortal({ children, near = 1, far = 1000, resolution = 256, frames = 1, map, background = false, blur, backgroundBlurriness, backgroundIntensity, backgroundRotation, environmentIntensity, environmentRotation, scene, files, path, preset = undefined, extensions }) {\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.gl);\n    const defaultScene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.scene);\n    const camera = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n    const [virtualScene] = react__WEBPACK_IMPORTED_MODULE_1__.useState(()=>new three__WEBPACK_IMPORTED_MODULE_4__.Scene());\n    const fbo = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>{\n        const fbo = new three__WEBPACK_IMPORTED_MODULE_4__.WebGLCubeRenderTarget(resolution);\n        fbo.texture.type = three__WEBPACK_IMPORTED_MODULE_4__.HalfFloatType;\n        return fbo;\n    }, [\n        resolution\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect(()=>{\n        if (frames === 1) camera.current.update(gl, virtualScene);\n        return setEnvProps(background, scene, defaultScene, fbo.texture, {\n            blur,\n            backgroundBlurriness,\n            backgroundIntensity,\n            backgroundRotation,\n            environmentIntensity,\n            environmentRotation\n        });\n    }, [\n        children,\n        virtualScene,\n        fbo.texture,\n        scene,\n        defaultScene,\n        background,\n        frames,\n        gl\n    ]);\n    let count = 1;\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.C)(()=>{\n        if (frames === Infinity || count < frames) {\n            camera.current.update(gl, virtualScene);\n            count++;\n        }\n    });\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, null, (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.g)(/*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, null, children, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"cubeCamera\", {\n        ref: camera,\n        args: [\n            near,\n            far,\n            fbo\n        ]\n    }), files || preset ? /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentCube, {\n        background: true,\n        files: files,\n        preset: preset,\n        path: path,\n        extensions: extensions\n    }) : map ? /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentMap, {\n        background: true,\n        map: map,\n        extensions: extensions\n    }) : null), virtualScene));\n}\nfunction EnvironmentGround(props) {\n    var _props$ground, _props$ground2, _scale, _props$ground3;\n    const textureDefault = (0,_useEnvironment_js__WEBPACK_IMPORTED_MODULE_3__.useEnvironment)(props);\n    const texture = props.map || textureDefault;\n    react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>(0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.e)({\n            GroundProjectedEnvImpl: three_stdlib__WEBPACK_IMPORTED_MODULE_5__.GroundProjectedEnv\n        }), []);\n    const args = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>[\n            texture\n        ], [\n        texture\n    ]);\n    const height = (_props$ground = props.ground) == null ? void 0 : _props$ground.height;\n    const radius = (_props$ground2 = props.ground) == null ? void 0 : _props$ground2.radius;\n    const scale = (_scale = (_props$ground3 = props.ground) == null ? void 0 : _props$ground3.scale) !== null && _scale !== void 0 ? _scale : 1000;\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, null, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentMap, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, props, {\n        map: texture\n    })), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"groundProjectedEnvImpl\", {\n        args: args,\n        scale: scale,\n        height: height,\n        radius: radius\n    }));\n}\nfunction Environment(props) {\n    return props.ground ? /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentGround, props) : props.map ? /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentMap, props) : props.children ? /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentPortal, props) : /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(EnvironmentCube, props);\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9FbnZpcm9ubWVudC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUEwRDtBQUMzQjtBQUMyRDtBQUN0QjtBQUNsQjtBQUNHO0FBRXJELE1BQU1ZLFFBQVFDLENBQUFBLE1BQU9BLElBQUlDLE9BQU8sSUFBSUQsSUFBSUMsT0FBTyxDQUFDQyxPQUFPO0FBQ3ZELE1BQU1DLGVBQWVDLENBQUFBLFFBQVNMLE1BQU1LLFNBQVNBLE1BQU1ILE9BQU8sR0FBR0c7QUFDN0QsU0FBU0MsWUFBWUMsVUFBVSxFQUFFRixLQUFLLEVBQUVHLFlBQVksRUFBRUMsT0FBTyxFQUFFQyxhQUFhLENBQUMsQ0FBQztJQUM1RSxJQUFJQyxrQkFBa0JDLHVCQUF1QkMsd0JBQXdCQyx1QkFBdUJDO0lBQzVGLFdBQVc7SUFDWEwsYUFBYTtRQUNYTSxzQkFBc0IsQ0FBQ0wsbUJBQW1CRCxXQUFXTyxJQUFJLE1BQU0sUUFBUU4scUJBQXFCLEtBQUssSUFBSUEsbUJBQW1CO1FBQ3hITyxxQkFBcUI7UUFDckJDLG9CQUFvQjtZQUFDO1lBQUc7WUFBRztTQUFFO1FBQzdCQyxzQkFBc0I7UUFDdEJDLHFCQUFxQjtZQUFDO1lBQUc7WUFBRztTQUFFO1FBQzlCLEdBQUdYLFVBQVU7SUFDZjtJQUNBLE1BQU1ZLFNBQVNsQixhQUFhQyxTQUFTRztJQUNyQyxNQUFNZSxRQUFRRCxPQUFPZixVQUFVO0lBQy9CLE1BQU1pQixTQUFTRixPQUFPRyxXQUFXO0lBQ2pDLE1BQU1DLGdCQUFnQjtRQUNwQixhQUFhO1FBQ2JWLHNCQUFzQk0sT0FBT04sb0JBQW9CO1FBQ2pELGFBQWE7UUFDYkUscUJBQXFCSSxPQUFPSixtQkFBbUI7UUFDL0MsYUFBYTtRQUNiQyxvQkFBb0IsQ0FBQ1Asd0JBQXdCLENBQUNDLHlCQUF5QlMsT0FBT0gsa0JBQWtCLEtBQUssUUFBUU4sdUJBQXVCYyxLQUFLLElBQUksT0FBTyxLQUFLLElBQUlkLHVC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aW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2NvcmUvRW52aXJvbm1lbnQuanM/NjA0MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2V4dGVuZHMgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZXh0ZW5kcyc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VUaHJlZSwgdXNlRnJhbWUsIGNyZWF0ZVBvcnRhbCwgYXBwbHlQcm9wcywgZXh0ZW5kIH0gZnJvbSAnQHJlYWN0LXRocmVlL2ZpYmVyJztcbmltcG9ydCB7IFNjZW5lLCBXZWJHTEN1YmVSZW5kZXJUYXJnZXQsIEhhbGZGbG9hdFR5cGUgfSBmcm9tICd0aHJlZSc7XG5pbXBvcnQgeyBHcm91bmRQcm9qZWN0ZWRFbnYgfSBmcm9tICd0aHJlZS1zdGRsaWInO1xuaW1wb3J0IHsgdXNlRW52aXJvbm1lbnQgfSBmcm9tICcuL3VzZUVudmlyb25tZW50LmpzJztcblxuY29uc3QgaXNSZWYgPSBvYmogPT4gb2JqLmN1cnJlbnQgJiYgb2JqLmN1cnJlbnQuaXNTY2VuZTtcbmNvbnN0IHJlc29sdmVTY2VuZSA9IHNjZW5lID0+IGlzUmVmKHNjZW5lKSA/IHNjZW5lLmN1cnJlbnQgOiBzY2VuZTtcbmZ1bmN0aW9uIHNldEVudlByb3BzKGJhY2tncm91bmQsIHNjZW5lLCBkZWZhdWx0U2NlbmUsIHRleHR1cmUsIHNjZW5lUHJvcHMgPSB7fSkge1xuICB2YXIgX3NjZW5lUHJvcHMkYmx1ciwgX3RhcmdldCRiYWNrZ3JvdW5kUm90LCBfdGFyZ2V0JGJhY2tncm91bmRSb3QyLCBfdGFyZ2V0JGVudmlyb25tZW50Um8sIF90YXJnZXQkZW52aXJvbm1lbnRSbzI7XG4gIC8vIGRlZmF1bHRzXG4gIHNjZW5lUHJvcHMgPSB7XG4gICAgYmFja2dyb3VuZEJsdXJyaW5lc3M6IChfc2NlbmVQcm9wcyRibHVyID0gc2NlbmVQcm9wcy5ibHVyKSAhPT0gbnVsbCAmJiBfc2NlbmVQcm9wcyRibHVyICE9PSB2b2lkIDAgPyBfc2NlbmVQcm9wcyRibHVyIDogMCxcbiAgICBiYWNrZ3JvdW5kSW50ZW5zaXR5OiAxLFxuICAgIGJhY2tncm91bmRSb3RhdGlvbjogWzAsIDAsIDBdLFxuICAgIGVudmlyb25tZW50SW50ZW5zaXR5OiAxLFxuICAgIGVudmlyb25tZW50Um90YXRpb246IFswLCAwLCAwXSxcbiAgICAuLi5zY2VuZVByb3BzXG4gIH07XG4gIGNvbnN0IHRhcmdldCA9IHJlc29sdmVTY2VuZShzY2VuZSB8fCBkZWZhdWx0U2NlbmUpO1xuICBjb25zdCBvbGRiZyA9IHRhcmdldC5iYWNrZ3JvdW5kO1xuICBjb25zdCBvbGRlbnYgPSB0YXJnZXQuZW52aXJvbm1lbnQ7XG4gIGNvbnN0IG9sZFNjZW5lUHJvcHMgPSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGJhY2tncm91bmRCbHVycmluZXNzOiB0YXJnZXQuYmFja2dyb3VuZEJsdXJyaW5lc3MsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGJhY2tncm91bmRJbnRlbnNpdHk6IHRhcmdldC5iYWNrZ3JvdW5kSW50ZW5zaXR5LFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBiYWNrZ3JvdW5kUm90YXRpb246IChfdGFyZ2V0JGJhY2tncm91bmRSb3QgPSAoX3RhcmdldCRiYWNrZ3JvdW5kUm90MiA9IHRhcmdldC5iYWNrZ3JvdW5kUm90YXRpb24pID09IG51bGwgfHwgX3RhcmdldCRiYWNrZ3JvdW5kUm90Mi5jbG9uZSA9PSBudWxsID8gdm9pZCAwIDogX3RhcmdldCRiYWNrZ3JvdW5kUm90Mi5jbG9uZSgpKSAhPT0gbnVsbCAmJiBfdGFyZ2V0JGJhY2tncm91bmRSb3QgIT09IHZvaWQgMCA/IF90YXJnZXQkYmFja2dyb3VuZFJvdCA6IFswLCAwLCAwXSxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZW52aXJvbm1lbnRJbnRlbnNpdHk6IHRhcmdldC5lbnZpcm9ubWVudEludGVuc2l0eSxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZW52aXJvbm1lbnRSb3RhdGlvbjogKF90YXJnZXQkZW52aXJvbm1lbnRSbyA9IChfdGFyZ2V0JGVudmlyb25tZW50Um8yID0gdGFyZ2V0LmVudmlyb25tZW50Um90YXRpb24pID09IG51bGwgfHwgX3RhcmdldCRlbnZpcm9ubWVudFJvMi5jbG9uZSA9PSBudWxsID8gdm9pZCAwIDogX3RhcmdldCRlbnZpcm9ubWVudFJvMi5jbG9uZSgpKSAhPT0gbnVsbCAmJiBfdGFyZ2V0JGVudmlyb25tZW50Um8gIT09IHZvaWQgMCA/IF90YXJnZXQkZW52aXJvbm1lbnRSbyA6IFswLCAwLCAwXVxuICB9O1xuICBpZiAoYmFja2dyb3VuZCAhPT0gJ29ubHknKSB0YXJnZXQuZW52aXJvbm1lbnQgPSB0ZXh0dXJlO1xuICBpZiAoYmFja2dyb3VuZCkgdGFyZ2V0LmJhY2tncm91bmQgPSB0ZXh0dXJlO1xuICBhcHBseVByb3BzKHRhcmdldCwgc2NlbmVQcm9wcyk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgaWYgKGJhY2tncm91bmQgIT09ICdvbmx5JykgdGFyZ2V0LmVudmlyb25tZW50ID0gb2xkZW52O1xuICAgIGlmIChiYWNrZ3JvdW5kKSB0YXJnZXQuYmFja2dyb3VuZCA9IG9sZGJnO1xuICAgIGFwcGx5UHJvcHModGFyZ2V0LCBvbGRTY2VuZVByb3BzKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIEVudmlyb25tZW50TWFwKHtcbiAgc2NlbmUsXG4gIGJhY2tncm91bmQgPSBmYWxzZSxcbiAgbWFwLFxuICAuLi5jb25maWdcbn0pIHtcbiAgY29uc3QgZGVmYXVsdFNjZW5lID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuc2NlbmUpO1xuICBSZWFjdC51c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChtYXApIHJldHVybiBzZXRFbnZQcm9wcyhiYWNrZ3JvdW5kLCBzY2VuZSwgZGVmYXVsdFNjZW5lLCBtYXAsIGNvbmZpZyk7XG4gIH0pO1xuICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIEVudmlyb25tZW50Q3ViZSh7XG4gIGJhY2tncm91bmQgPSBmYWxzZSxcbiAgc2NlbmUsXG4gIGJsdXIsXG4gIGJhY2tncm91bmRCbHVycmluZXNzLFxuICBiYWNrZ3JvdW5kSW50ZW5zaXR5LFxuICBiYWNrZ3JvdW5kUm90YXRpb24sXG4gIGVudmlyb25tZW50SW50ZW5zaXR5LFxuICBlbnZpcm9ubWVudFJvdGF0aW9uLFxuICAuLi5yZXN0XG59KSB7XG4gIGNvbnN0IHRleHR1cmUgPSB1c2VFbnZpcm9ubWVudChyZXN0KTtcbiAgY29uc3QgZGVmYXVsdFNjZW5lID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuc2NlbmUpO1xuICBSZWFjdC51c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiBzZXRFbnZQcm9wcyhiYWNrZ3JvdW5kLCBzY2VuZSwgZGVmYXVsdFNjZW5lLCB0ZXh0dXJlLCB7XG4gICAgICBibHVyLFxuICAgICAgYmFja2dyb3VuZEJsdXJyaW5lc3MsXG4gICAgICBiYWNrZ3JvdW5kSW50ZW5zaXR5LFxuICAgICAgYmFja2dyb3VuZFJvdGF0aW9uLFxuICAgICAgZW52aXJvbm1lbnRJbnRlbnNpdHksXG4gICAgICBlbnZpcm9ubWVudFJvdGF0aW9uXG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIEVudmlyb25tZW50UG9ydGFsKHtcbiAgY2hpbGRyZW4sXG4gIG5lYXIgPSAxLFxuICBmYXIgPSAxMDAwLFxuICByZXNvbHV0aW9uID0gMjU2LFxuICBmcmFtZXMgPSAxLFxuICBtYXAsXG4gIGJhY2tncm91bmQgPSBmYWxzZSxcbiAgYmx1cixcbiAgYmFja2dyb3VuZEJsdXJyaW5lc3MsXG4gIGJhY2tncm91bmRJbnRlbnNpdHksXG4gIGJhY2tncm91bmRSb3RhdGlvbixcbiAgZW52aXJvbm1lbnRJbnRlbnNpdHksXG4gIGVudmlyb25tZW50Um90YXRpb24sXG4gIHNjZW5lLFxuICBmaWxlcyxcbiAgcGF0aCxcbiAgcHJlc2V0ID0gdW5kZWZpbmVkLFxuICBleHRlbnNpb25zXG59KSB7XG4gIGNvbnN0IGdsID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuZ2wpO1xuICBjb25zdCBkZWZhdWx0U2NlbmUgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5zY2VuZSk7XG4gIGNvbnN0IGNhbWVyYSA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgY29uc3QgW3ZpcnR1YWxTY2VuZV0gPSBSZWFjdC51c2VTdGF0ZSgoKSA9PiBuZXcgU2NlbmUoKSk7XG4gIGNvbnN0IGZibyA9IFJlYWN0LnVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGZibyA9IG5ldyBXZWJHTEN1YmVSZW5kZXJUYXJnZXQocmVzb2x1dGlvbik7XG4gICAgZmJvLnRleHR1cmUudHlwZSA9IEhhbGZGbG9hdFR5cGU7XG4gICAgcmV0dXJuIGZibztcbiAgfSwgW3Jlc29sdXRpb25dKTtcbiAgUmVhY3QudXNlTGF5b3V0RWZmZWN0KCgpID0+IHtcbiAgICBpZiAoZnJhbWVzID09PSAxKSBjYW1lcmEuY3VycmVudC51cGRhdGUoZ2wsIHZpcnR1YWxTY2VuZSk7XG4gICAgcmV0dXJuIHNldEVudlByb3BzKGJhY2tncm91bmQsIHNjZW5lLCBkZWZhdWx0U2NlbmUsIGZiby50ZXh0dXJlLCB7XG4gICAgICBibHVyLFxuICAgICAgYmFja2dyb3VuZEJsdXJyaW5lc3MsXG4gICAgICBiYWNrZ3JvdW5kSW50ZW5zaXR5LFxuICAgICAgYmFja2dyb3VuZFJvdGF0aW9uLFxuICAgICAgZW52aXJvbm1lbnRJbnRlbnNpdHksXG4gICAgICBlbnZpcm9ubWVudFJvdGF0aW9uXG4gICAgfSk7XG4gIH0sIFtjaGlsZHJlbiwgdmlydHVhbFNjZW5lLCBmYm8udGV4dHVyZSwgc2NlbmUsIGRlZmF1bHRTY2VuZSwgYmFja2dyb3VuZCwgZnJhbWVzLCBnbF0pO1xuICBsZXQgY291bnQgPSAxO1xuICB1c2VGcmFtZSgoKSA9PiB7XG4gICAgaWYgKGZyYW1lcyA9PT0gSW5maW5pdHkgfHwgY291bnQgPCBmcmFtZXMpIHtcbiAgICAgIGNhbWVyYS5jdXJyZW50LnVwZGF0ZShnbCwgdmlydHVhbFNjZW5lKTtcbiAgICAgIGNvdW50Kys7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCBjcmVhdGVQb3J0YWwoIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCBjaGlsZHJlbiwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJjdWJlQ2FtZXJhXCIsIHtcbiAgICByZWY6IGNhbWVyYSxcbiAgICBhcmdzOiBbbmVhciwgZmFyLCBmYm9dXG4gIH0pLCBmaWxlcyB8fCBwcmVzZXQgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFbnZpcm9ubWVudEN1YmUsIHtcbiAgICBiYWNrZ3JvdW5kOiB0cnVlLFxuICAgIGZpbGVzOiBmaWxlcyxcbiAgICBwcmVzZXQ6IHByZXNldCxcbiAgICBwYXRoOiBwYXRoLFxuICAgIGV4dGVuc2lvbnM6IGV4dGVuc2lvbnNcbiAgfSkgOiBtYXAgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFbnZpcm9ubWVudE1hcCwge1xuICAgIGJhY2tncm91bmQ6IHRydWUsXG4gICAgbWFwOiBtYXAsXG4gICAgZXh0ZW5zaW9uczogZXh0ZW5zaW9uc1xuICB9KSA6IG51bGwpLCB2aXJ0dWFsU2NlbmUpKTtcbn1cbmZ1bmN0aW9uIEVudmlyb25tZW50R3JvdW5kKHByb3BzKSB7XG4gIHZhciBfcHJvcHMkZ3JvdW5kLCBfcHJvcHMkZ3JvdW5kMiwgX3NjYWxlLCBfcHJvcHMkZ3JvdW5kMztcbiAgY29uc3QgdGV4dHVyZURlZmF1bHQgPSB1c2VFbnZpcm9ubWVudChwcm9wcyk7XG4gIGNvbnN0IHRleHR1cmUgPSBwcm9wcy5tYXAgfHwgdGV4dHVyZURlZmF1bHQ7XG4gIFJlYWN0LnVzZU1lbW8oKCkgPT4gZXh0ZW5kKHtcbiAgICBHcm91bmRQcm9qZWN0ZWRFbnZJbXBsOiBHcm91bmRQcm9qZWN0ZWRFbnZcbiAgfSksIFtdKTtcbiAgY29uc3QgYXJncyA9IFJlYWN0LnVzZU1lbW8oKCkgPT4gW3RleHR1cmVdLCBbdGV4dHVyZV0pO1xuICBjb25zdCBoZWlnaHQgPSAoX3Byb3BzJGdyb3VuZCA9IHByb3BzLmdyb3VuZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9wcm9wcyRncm91bmQuaGVpZ2h0O1xuICBjb25zdCByYWRpdXMgPSAoX3Byb3BzJGdyb3VuZDIgPSBwcm9wcy5ncm91bmQpID09IG51bGwgPyB2b2lkIDAgOiBfcHJvcHMkZ3JvdW5kMi5yYWRpdXM7XG4gIGNvbnN0IHNjYWxlID0gKF9zY2FsZSA9IChfcHJvcHMkZ3JvdW5kMyA9IHByb3BzLmdyb3VuZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9wcm9wcyRncm91bmQzLnNjYWxlKSAhPT0gbnVsbCAmJiBfc2NhbGUgIT09IHZvaWQgMCA/IF9zY2FsZSA6IDEwMDA7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChSZWFjdC5GcmFnbWVudCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRW52aXJvbm1lbnRNYXAsIF9leHRlbmRzKHt9LCBwcm9wcywge1xuICAgIG1hcDogdGV4dHVyZVxuICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZ3JvdW5kUHJvamVjdGVkRW52SW1wbFwiLCB7XG4gICAgYXJnczogYXJncyxcbiAgICBzY2FsZTogc2NhbGUsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgcmFkaXVzOiByYWRpdXNcbiAgfSkpO1xufVxuZnVuY3Rpb24gRW52aXJvbm1lbnQocHJvcHMpIHtcbiAgcmV0dXJuIHByb3BzLmdyb3VuZCA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEVudmlyb25tZW50R3JvdW5kLCBwcm9wcykgOiBwcm9wcy5tYXAgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFbnZpcm9ubWVudE1hcCwgcHJvcHMpIDogcHJvcHMuY2hpbGRyZW4gPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFbnZpcm9ubWVudFBvcnRhbCwgcHJvcHMpIDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRW52aXJvbm1lbnRDdWJlLCBwcm9wcyk7XG59XG5cbmV4cG9ydCB7IEVudmlyb25tZW50LCBFbnZpcm9ubWVudEN1YmUsIEVudmlyb25tZW50TWFwLCBFbnZpcm9ubWVudFBvcnRhbCB9O1xuIl0sIm5hbWVzIjpbIl9leHRlbmRzIiwiUmVhY3QiLCJ1c2VUaHJlZSIsInVzZUZyYW1lIiwiY3JlYXRlUG9ydGFsIiwiYXBwbHlQcm9wcyIsImV4dGVuZCIsIlNjZW5lIiwiV2ViR0xDdWJlUmVuZGVyVGFyZ2V0IiwiSGFsZkZsb2F0VHlwZSIsIkdyb3VuZFByb2plY3RlZEVudiIsInVzZUVudmlyb25tZW50IiwiaXNSZWYiLCJvYmoiLCJjdXJyZW50IiwiaXNTY2VuZSIsInJlc29sdmVTY2VuZSIsInNjZW5lIiwic2V0RW52UHJvcHMiLCJiYWNrZ3JvdW5kIiwiZGVmYXVsdFNjZW5lIiwidGV4dHVyZSIsInNjZW5lUHJvcHMiLCJfc2NlbmVQcm9wcyRibHVyIiwiX3RhcmdldCRiYWNrZ3JvdW5kUm90IiwiX3RhcmdldCRiYWNrZ3JvdW5kUm90MiIsIl90YXJnZXQkZW52aXJvbm1lbnRSbyIsIl90YXJnZXQkZW52aXJvbm1lbnRSbzIiLCJiYWNrZ3JvdW5kQmx1cnJpbmVzcyIsImJsdXIiLCJiYWNrZ3JvdW5kSW50ZW5zaXR5IiwiYmFja2dyb3VuZFJvdGF0aW9uIiwiZW52aXJvbm1lbnRJbnRlbnNpdHkiLCJlbnZpcm9ubWVudFJvdGF0aW9uIiwidGFyZ2V0Iiwib2xkYmciLCJvbGRlbnYiLCJlbnZpcm9ubWVudCIsIm9sZFNjZW5lUHJvcHMiLCJjbG9uZSIsIkVudmlyb25tZW50TWFwIiwibWFwIiwiY29uZmlnIiwic3RhdGUiLCJ1c2VMYXlvdXRFZmZlY3QiLCJFbnZpcm9ubWVudEN1YmUiLCJyZXN0IiwiRW52aXJvbm1lbnRQb3J0YWwiLCJjaGlsZHJlbiIsIm5lYXIiLCJmYXIiLCJyZXNvbHV0aW9uIiwiZnJhbWVzIiwiZmlsZXMiLCJwYXRoIiwicHJlc2V0IiwidW5kZWZpbmVkIiwiZXh0ZW5zaW9ucyIsImdsIiwiY2FtZXJhIiwidXNlUmVmIiwidmlydHVhbFNjZW5lIiwidXNlU3RhdGUiLCJmYm8iLCJ1c2VNZW1vIiwidHlwZSIsInVwZGF0ZSIsImNvdW50IiwiSW5maW5pdHkiLCJjcmVhdGVFbGVtZW50IiwiRnJhZ21lbnQiLCJyZWYiLCJhcmdzIiwiRW52aXJvbm1lbnRHcm91bmQiLCJwcm9wcyIsIl9wcm9wcyRncm91bmQiLCJfcHJvcHMkZ3JvdW5kMiIsIl9zY2FsZSIsIl9wcm9wcyRncm91bmQzIiwidGV4dHVyZURlZmF1bHQiLCJHcm91bmRQcm9qZWN0ZWRFbnZJbXBsIiwiaGVpZ2h0IiwiZ3JvdW5kIiwicmFkaXVzIiwic2NhbGUiLCJFbnZpcm9ubWVudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/Environment.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/OrbitControls.js":
/*!**************************************************************!*\
  !*** ./node_modules/@react-three/drei/core/OrbitControls.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   OrbitControls: () => (/* binding */ OrbitControls)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/controls/OrbitControls.js\");\n\n\n\n\nconst OrbitControls = /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({ makeDefault, camera, regress, domElement, enableDamping = true, keyEvents = false, onChange, onStart, onEnd, ...restProps }, ref)=>{\n    const invalidate = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.invalidate);\n    const defaultCamera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.camera);\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.gl);\n    const events = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.events);\n    const setEvents = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.setEvents);\n    const set = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.set);\n    const get = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.get);\n    const performance = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.A)((state)=>state.performance);\n    const explCamera = camera || defaultCamera;\n    const explDomElement = domElement || events.connected || gl.domElement;\n    const controls = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>new three_stdlib__WEBPACK_IMPORTED_MODULE_3__.OrbitControls(explCamera), [\n        explCamera\n    ]);\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.C)(()=>{\n        if (controls.enabled) controls.update();\n    }, -1);\n    react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{\n        if (keyEvents) {\n            controls.connect(keyEvents === true ? explDomElement : keyEvents);\n        }\n        controls.connect(explDomElement);\n        return ()=>void controls.dispose();\n    }, [\n        keyEvents,\n        explDomElement,\n        regress,\n        controls,\n        invalidate\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{\n        const callback = (e)=>{\n            invalidate();\n            if (regress) performance.regress();\n            if (onChange) onChange(e);\n        };\n        const onStartCb = (e)=>{\n            if (onStart) onStart(e);\n        };\n        const onEndCb = (e)=>{\n            if (onEnd) onEnd(e);\n        };\n        controls.addEventListener(\"change\", callback);\n        controls.addEventListener(\"start\", onStartCb);\n        controls.addEventListener(\"end\", onEndCb);\n        return ()=>{\n            controls.removeEventListener(\"start\", onStartCb);\n            controls.removeEventListener(\"end\", onEndCb);\n            controls.removeEventListener(\"change\", callback);\n        };\n    }, [\n        onChange,\n        onStart,\n        onEnd,\n        controls,\n        invalidate,\n        setEvents\n    ]);\n    react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{\n        if (makeDefault) {\n            const old = get().controls;\n            set({\n                controls\n            });\n            return ()=>set({\n                    controls: old\n                });\n        }\n    }, [\n        makeDefault,\n        controls\n    ]);\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"primitive\", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        ref: ref,\n        object: controls,\n        enableDamping: enableDamping\n    }, restProps));\n});\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9PcmJpdENvbnRyb2xzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwRDtBQUNGO0FBQ3pCO0FBQ2lDO0FBRWhFLE1BQU1JLGdCQUFnQixhQUFhLGlCQUFFRCw2Q0FBZ0IsQ0FBQyxDQUFDLEVBQ3JESSxXQUFXLEVBQ1hDLE1BQU0sRUFDTkMsT0FBTyxFQUNQQyxVQUFVLEVBQ1ZDLGdCQUFnQixJQUFJLEVBQ3BCQyxZQUFZLEtBQUssRUFDakJDLFFBQVEsRUFDUkMsT0FBTyxFQUNQQyxLQUFLLEVBQ0wsR0FBR0MsV0FDSixFQUFFQztJQUNELE1BQU1DLGFBQWFqQixxREFBUUEsQ0FBQ2tCLENBQUFBLFFBQVNBLE1BQU1ELFVBQVU7SUFDckQsTUFBTUUsZ0JBQWdCbkIscURBQVFBLENBQUNrQixDQUFBQSxRQUFTQSxNQUFNWCxNQUFNO0lBQ3BELE1BQU1hLEtBQUtwQixxREFBUUEsQ0FBQ2tCLENBQUFBLFFBQVNBLE1BQU1FLEVBQUU7SUFDckMsTUFBTUMsU0FBU3JCLHFEQUFRQSxDQUFDa0IsQ0FBQUEsUUFBU0EsTUFBTUcsTUFBTTtJQUM3QyxNQUFNQyxZQUFZdEIscURBQVFBLENBQUNrQixDQUFBQSxRQUFTQSxNQUFNSSxTQUFTO0lBQ25ELE1BQU1DLE1BQU12QixxREFBUUEsQ0FBQ2tCLENBQUFBLFFBQVNBLE1BQU1LLEdBQUc7SUFDdkMsTUFBTUMsTUFBTXhCLHFEQUFRQSxDQUFDa0IsQ0FBQUEsUUFBU0EsTUFBTU0sR0FBRztJQUN2QyxNQUFNQyxjQUFjekIscURBQVFBLENBQUNrQixDQUFBQSxRQUFTQSxNQUFNTyxXQUFXO0lBQ3ZELE1BQU1DLGFBQWFuQixVQUFVWTtJQUM3QixNQUFNUSxpQkFBaUJsQixjQUFjWSxPQUFPTyxTQUFTLElBQUlSLEdBQUdYLFVBQVU7SUFDdEUsTUFBTW9CLFdBQVczQiwwQ0FBYSxDQUFDLElBQU0sSUFBSUUsdURBQWVBLENBQUNzQixhQUFhO1FBQUNBO0tBQVc7SUFDbEZ6QixxREFBUUEsQ0FBQztRQUNQLElBQUk0QixTQUFTRSxPQUFPLEVBQUVGLFNBQVNHLE1BQU07SUFDdkMsR0FBRyxDQUFDO0lBQ0o5Qiw0Q0FBZSxDQUFDO1FBQ2QsSUFBSVMsV0FBVztZQUNia0IsU0FBU0ssT0FBTyxDQUFDdkIsY0FBYyxPQUFPZ0IsaUJBQWlCaEI7UUFDekQ7UUFDQWtCLFNBQVNLLE9BQU8sQ0FBQ1A7UUFDakIsT0FBTyxJQUFNLEtBQUtFLFNBQVNNLE9BQU87SUFDcEMsR0FBRztRQUFDeEI7UUFBV2dCO1FBQWdCbkI7UUFBU3FCO1FBQVVaO0tBQVc7SUFDN0RmLDRDQUFlLENBQUM7UUFDZCxNQUFNa0MsV0FBV0MsQ0FBQUE7WUFDZnBCO1lBQ0EsSUFBSVQsU0FBU2lCLFlBQVlqQixPQUFPO1lBQ2hDLElBQUlJLFVBQVVBLFNBQVN5QjtRQUN6QjtRQUNBLE1BQU1DLFlBQVlELENBQUFBO1lBQ2hCLElBQUl4QixTQUFTQSxRQUFRd0I7UUFDdkI7UUFDQSxNQUFNRSxVQUFVRixDQUFBQTtZQUNkLElBQUl2QixPQUFPQSxNQUFNdUI7UUFDbkI7UUFDQVIsU0FBU1csZ0JBQWdCLENBQUMsVUFBVUo7UUFDcENQLFNBQVNXLGdCQUFnQixDQUFDLFNBQVNGO1FBQ25DVCxTQUFTVyxnQkFBZ0IsQ0FBQyxPQUFPRDtRQUNqQyxPQUFPO1lBQ0xWLFNBQVNZLG1CQUFtQixDQUFDLFNBQVNIO1lBQ3RDVCxTQUFTWSxtQkFBbUIsQ0FBQyxPQUFPRjtZQUNwQ1YsU0FBU1ksbUJBQW1CLENBQUMsVUFBVUw7UUFDekM7SUFDRixHQUFHO1FBQUN4QjtRQUFVQztRQUFTQztRQUFPZTtRQUFVWjtRQUFZSztLQUFVO0lBQzlEcEIsNENBQWUsQ0FBQztRQUNkLElBQUlJLGFBQWE7WUFDZixNQUFNb0MsTUFBTWxCLE1BQU1LLFFBQVE7WUFDMUJOLElBQUk7Z0JBQ0ZNO1lBQ0Y7WUFDQSxPQUFPLElBQU1OLElBQUk7b0JBQ2ZNLFVBQVVhO2dCQUNaO1FBQ0Y7SUFDRixHQUFHO1FBQUNwQztRQUFhdUI7S0FBUztJQUMxQixPQUFPLFdBQVcsR0FBRTNCLGdEQUFtQixDQUFDLGFBQWFILDhFQUFRQSxDQUFDO1FBQzVEaUIsS0FBS0E7UUFDTDRCLFFBQVFmO1FBQ1JuQixlQUFlQTtJQUNqQixHQUFHSztBQUNMO0FBRXlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2FuanlvdGktbGVhcm5pbmcvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9PcmJpdENvbnRyb2xzLmpzP2M4ZTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9leHRlbmRzIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHMnO1xuaW1wb3J0IHsgdXNlVGhyZWUsIHVzZUZyYW1lIH0gZnJvbSAnQHJlYWN0LXRocmVlL2ZpYmVyJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IE9yYml0Q29udHJvbHMgYXMgT3JiaXRDb250cm9scyQxIH0gZnJvbSAndGhyZWUtc3RkbGliJztcblxuY29uc3QgT3JiaXRDb250cm9scyA9IC8qIEBfX1BVUkVfXyAqL1JlYWN0LmZvcndhcmRSZWYoKHtcbiAgbWFrZURlZmF1bHQsXG4gIGNhbWVyYSxcbiAgcmVncmVzcyxcbiAgZG9tRWxlbWVudCxcbiAgZW5hYmxlRGFtcGluZyA9IHRydWUsXG4gIGtleUV2ZW50cyA9IGZhbHNlLFxuICBvbkNoYW5nZSxcbiAgb25TdGFydCxcbiAgb25FbmQsXG4gIC4uLnJlc3RQcm9wc1xufSwgcmVmKSA9PiB7XG4gIGNvbnN0IGludmFsaWRhdGUgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5pbnZhbGlkYXRlKTtcbiAgY29uc3QgZGVmYXVsdENhbWVyYSA9IHVzZVRocmVlKHN0YXRlID0+IHN0YXRlLmNhbWVyYSk7XG4gIGNvbnN0IGdsID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuZ2wpO1xuICBjb25zdCBldmVudHMgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5ldmVudHMpO1xuICBjb25zdCBzZXRFdmVudHMgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5zZXRFdmVudHMpO1xuICBjb25zdCBzZXQgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5zZXQpO1xuICBjb25zdCBnZXQgPSB1c2VUaHJlZShzdGF0ZSA9PiBzdGF0ZS5nZXQpO1xuICBjb25zdCBwZXJmb3JtYW5jZSA9IHVzZVRocmVlKHN0YXRlID0+IHN0YXRlLnBlcmZvcm1hbmNlKTtcbiAgY29uc3QgZXhwbENhbWVyYSA9IGNhbWVyYSB8fCBkZWZhdWx0Q2FtZXJhO1xuICBjb25zdCBleHBsRG9tRWxlbWVudCA9IGRvbUVsZW1lbnQgfHwgZXZlbnRzLmNvbm5lY3RlZCB8fCBnbC5kb21FbGVtZW50O1xuICBjb25zdCBjb250cm9scyA9IFJlYWN0LnVzZU1lbW8oKCkgPT4gbmV3IE9yYml0Q29udHJvbHMkMShleHBsQ2FtZXJhKSwgW2V4cGxDYW1lcmFdKTtcbiAgdXNlRnJhbWUoKCkgPT4ge1xuICAgIGlmIChjb250cm9scy5lbmFibGVkKSBjb250cm9scy51cGRhdGUoKTtcbiAgfSwgLTEpO1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChrZXlFdmVudHMpIHtcbiAgICAgIGNvbnRyb2xzLmNvbm5lY3Qoa2V5RXZlbnRzID09PSB0cnVlID8gZXhwbERvbUVsZW1lbnQgOiBrZXlFdmVudHMpO1xuICAgIH1cbiAgICBjb250cm9scy5jb25uZWN0KGV4cGxEb21FbGVtZW50KTtcbiAgICByZXR1cm4gKCkgPT4gdm9pZCBjb250cm9scy5kaXNwb3NlKCk7XG4gIH0sIFtrZXlFdmVudHMsIGV4cGxEb21FbGVtZW50LCByZWdyZXNzLCBjb250cm9scywgaW52YWxpZGF0ZV0pO1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGNhbGxiYWNrID0gZSA9PiB7XG4gICAgICBpbnZhbGlkYXRlKCk7XG4gICAgICBpZiAocmVncmVzcykgcGVyZm9ybWFuY2UucmVncmVzcygpO1xuICAgICAgaWYgKG9uQ2hhbmdlKSBvbkNoYW5nZShlKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uU3RhcnRDYiA9IGUgPT4ge1xuICAgICAgaWYgKG9uU3RhcnQpIG9uU3RhcnQoZSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkVuZENiID0gZSA9PiB7XG4gICAgICBpZiAob25FbmQpIG9uRW5kKGUpO1xuICAgIH07XG4gICAgY29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY2FsbGJhY2spO1xuICAgIGNvbnRyb2xzLmFkZEV2ZW50TGlzdGVuZXIoJ3N0YXJ0Jywgb25TdGFydENiKTtcbiAgICBjb250cm9scy5hZGRFdmVudExpc3RlbmVyKCdlbmQnLCBvbkVuZENiKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY29udHJvbHMucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RhcnQnLCBvblN0YXJ0Q2IpO1xuICAgICAgY29udHJvbHMucmVtb3ZlRXZlbnRMaXN0ZW5lcignZW5kJywgb25FbmRDYik7XG4gICAgICBjb250cm9scy5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjYWxsYmFjayk7XG4gICAgfTtcbiAgfSwgW29uQ2hhbmdlLCBvblN0YXJ0LCBvbkVuZCwgY29udHJvbHMsIGludmFsaWRhdGUsIHNldEV2ZW50c10pO1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChtYWtlRGVmYXVsdCkge1xuICAgICAgY29uc3Qgb2xkID0gZ2V0KCkuY29udHJvbHM7XG4gICAgICBzZXQoe1xuICAgICAgICBjb250cm9sc1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gKCkgPT4gc2V0KHtcbiAgICAgICAgY29udHJvbHM6IG9sZFxuICAgICAgfSk7XG4gICAgfVxuICB9LCBbbWFrZURlZmF1bHQsIGNvbnRyb2xzXSk7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInByaW1pdGl2ZVwiLCBfZXh0ZW5kcyh7XG4gICAgcmVmOiByZWYsXG4gICAgb2JqZWN0OiBjb250cm9scyxcbiAgICBlbmFibGVEYW1waW5nOiBlbmFibGVEYW1waW5nXG4gIH0sIHJlc3RQcm9wcykpO1xufSk7XG5cbmV4cG9ydCB7IE9yYml0Q29udHJvbHMgfTtcbiJdLCJuYW1lcyI6WyJfZXh0ZW5kcyIsInVzZVRocmVlIiwidXNlRnJhbWUiLCJSZWFjdCIsIk9yYml0Q29udHJvbHMiLCJPcmJpdENvbnRyb2xzJDEiLCJmb3J3YXJkUmVmIiwibWFrZURlZmF1bHQiLCJjYW1lcmEiLCJyZWdyZXNzIiwiZG9tRWxlbWVudCIsImVuYWJsZURhbXBpbmciLCJrZXlFdmVudHMiLCJvbkNoYW5nZSIsIm9uU3RhcnQiLCJvbkVuZCIsInJlc3RQcm9wcyIsInJlZiIsImludmFsaWRhdGUiLCJzdGF0ZSIsImRlZmF1bHRDYW1lcmEiLCJnbCIsImV2ZW50cyIsInNldEV2ZW50cyIsInNldCIsImdldCIsInBlcmZvcm1hbmNlIiwiZXhwbENhbWVyYSIsImV4cGxEb21FbGVtZW50IiwiY29ubmVjdGVkIiwiY29udHJvbHMiLCJ1c2VNZW1vIiwiZW5hYmxlZCIsInVwZGF0ZSIsInVzZUVmZmVjdCIsImNvbm5lY3QiLCJkaXNwb3NlIiwiY2FsbGJhY2siLCJlIiwib25TdGFydENiIiwib25FbmRDYiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwib2xkIiwiY3JlYXRlRWxlbWVudCIsIm9iamVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/OrbitControls.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/Stage.js":
/*!******************************************************!*\
  !*** ./node_modules/@react-three/drei/core/Stage.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Stage: () => (/* binding */ Stage)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _Environment_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Environment.js */ \"(ssr)/./node_modules/@react-three/drei/core/Environment.js\");\n/* harmony import */ var _ContactShadows_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ContactShadows.js */ \"(ssr)/./node_modules/@react-three/drei/core/ContactShadows.js\");\n/* harmony import */ var _Center_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Center.js */ \"(ssr)/./node_modules/@react-three/drei/core/Center.js\");\n/* harmony import */ var _AccumulativeShadows_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AccumulativeShadows.js */ \"(ssr)/./node_modules/@react-three/drei/core/AccumulativeShadows.js\");\n/* harmony import */ var _Bounds_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Bounds.js */ \"(ssr)/./node_modules/@react-three/drei/core/Bounds.js\");\n\n\n\n\n\n\n\nconst presets = {\n    rembrandt: {\n        main: [\n            1,\n            2,\n            1\n        ],\n        fill: [\n            -2,\n            -0.5,\n            -2\n        ]\n    },\n    portrait: {\n        main: [\n            -1,\n            2,\n            0.5\n        ],\n        fill: [\n            -1,\n            0.5,\n            -1.5\n        ]\n    },\n    upfront: {\n        main: [\n            0,\n            2,\n            1\n        ],\n        fill: [\n            -1,\n            0.5,\n            -1.5\n        ]\n    },\n    soft: {\n        main: [\n            -2,\n            4,\n            4\n        ],\n        fill: [\n            -1,\n            0.5,\n            -1.5\n        ]\n    }\n};\nfunction Refit({ radius, adjustCamera }) {\n    const api = (0,_Bounds_js__WEBPACK_IMPORTED_MODULE_2__.useBounds)();\n    react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{\n        if (adjustCamera) api.refresh().clip().fit();\n    }, [\n        radius,\n        adjustCamera\n    ]);\n    return null;\n}\nfunction Stage({ children, center, adjustCamera = true, intensity = 0.5, shadows = \"contact\", environment = \"city\", preset = \"rembrandt\", ...props }) {\n    var _bias, _normalBias, _size, _offset, _amount, _radius, _ambient, _intensity;\n    const config = typeof preset === \"string\" ? presets[preset] : preset;\n    const [{ radius, height }, set] = react__WEBPACK_IMPORTED_MODULE_1__.useState({\n        radius: 0,\n        width: 0,\n        height: 0,\n        depth: 0\n    });\n    const shadowBias = (_bias = shadows == null ? void 0 : shadows.bias) !== null && _bias !== void 0 ? _bias : -0.0001;\n    const normalBias = (_normalBias = shadows == null ? void 0 : shadows.normalBias) !== null && _normalBias !== void 0 ? _normalBias : 0;\n    const shadowSize = (_size = shadows == null ? void 0 : shadows.size) !== null && _size !== void 0 ? _size : 1024;\n    const shadowOffset = (_offset = shadows == null ? void 0 : shadows.offset) !== null && _offset !== void 0 ? _offset : 0;\n    const contactShadow = shadows === \"contact\" || (shadows == null ? void 0 : shadows.type) === \"contact\";\n    const accumulativeShadow = shadows === \"accumulative\" || (shadows == null ? void 0 : shadows.type) === \"accumulative\";\n    const shadowSpread = {\n        ...typeof shadows === \"object\" ? shadows : {}\n    };\n    const environmentProps = !environment ? null : typeof environment === \"string\" ? {\n        preset: environment\n    } : environment;\n    const onCentered = react__WEBPACK_IMPORTED_MODULE_1__.useCallback((props)=>{\n        const { width, height, depth, boundingSphere } = props;\n        set({\n            radius: boundingSphere.radius,\n            width,\n            height,\n            depth\n        });\n        if (center != null && center.onCentered) center.onCentered(props);\n    }, []);\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, null, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"ambientLight\", {\n        intensity: intensity / 3\n    }), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"spotLight\", {\n        penumbra: 1,\n        position: [\n            config.main[0] * radius,\n            config.main[1] * radius,\n            config.main[2] * radius\n        ],\n        intensity: intensity * 2,\n        castShadow: !!shadows,\n        \"shadow-bias\": shadowBias,\n        \"shadow-normalBias\": normalBias,\n        \"shadow-mapSize\": shadowSize\n    }), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"pointLight\", {\n        position: [\n            config.fill[0] * radius,\n            config.fill[1] * radius,\n            config.fill[2] * radius\n        ],\n        intensity: intensity\n    }), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Bounds_js__WEBPACK_IMPORTED_MODULE_2__.Bounds, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        fit: !!adjustCamera,\n        clip: !!adjustCamera,\n        margin: Number(adjustCamera),\n        observe: true\n    }, props), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(Refit, {\n        radius: radius,\n        adjustCamera: adjustCamera\n    }), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Center_js__WEBPACK_IMPORTED_MODULE_3__.Center, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, center, {\n        position: [\n            0,\n            shadowOffset / 2,\n            0\n        ],\n        onCentered: onCentered\n    }), children)), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"group\", {\n        position: [\n            0,\n            -height / 2 - shadowOffset / 2,\n            0\n        ]\n    }, contactShadow && /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ContactShadows_js__WEBPACK_IMPORTED_MODULE_4__.ContactShadows, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        scale: radius * 4,\n        far: radius,\n        blur: 2\n    }, shadowSpread)), accumulativeShadow && /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(_AccumulativeShadows_js__WEBPACK_IMPORTED_MODULE_5__.AccumulativeShadows, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        temporal: true,\n        frames: 100,\n        alphaTest: 0.9,\n        toneMapped: true,\n        scale: radius * 4\n    }, shadowSpread), /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(_AccumulativeShadows_js__WEBPACK_IMPORTED_MODULE_5__.RandomizedLight, {\n        amount: (_amount = shadowSpread.amount) !== null && _amount !== void 0 ? _amount : 8,\n        radius: (_radius = shadowSpread.radius) !== null && _radius !== void 0 ? _radius : radius,\n        ambient: (_ambient = shadowSpread.ambient) !== null && _ambient !== void 0 ? _ambient : 0.5,\n        intensity: (_intensity = shadowSpread.intensity) !== null && _intensity !== void 0 ? _intensity : 1,\n        position: [\n            config.main[0] * radius,\n            config.main[1] * radius,\n            config.main[2] * radius\n        ],\n        size: radius * 4,\n        bias: -shadowBias,\n        mapSize: shadowSize\n    }))), environment && /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Environment_js__WEBPACK_IMPORTED_MODULE_6__.Environment, environmentProps));\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9TdGFnZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBMEQ7QUFDM0I7QUFDZ0I7QUFDTTtBQUNoQjtBQUMyQztBQUNoQztBQUVoRCxNQUFNUyxVQUFVO0lBQ2RDLFdBQVc7UUFDVEMsTUFBTTtZQUFDO1lBQUc7WUFBRztTQUFFO1FBQ2ZDLE1BQU07WUFBQyxDQUFDO1lBQUcsQ0FBQztZQUFLLENBQUM7U0FBRTtJQUN0QjtJQUNBQyxVQUFVO1FBQ1JGLE1BQU07WUFBQyxDQUFDO1lBQUc7WUFBRztTQUFJO1FBQ2xCQyxNQUFNO1lBQUMsQ0FBQztZQUFHO1lBQUssQ0FBQztTQUFJO0lBQ3ZCO0lBQ0FFLFNBQVM7UUFDUEgsTUFBTTtZQUFDO1lBQUc7WUFBRztTQUFFO1FBQ2ZDLE1BQU07WUFBQyxDQUFDO1lBQUc7WUFBSyxDQUFDO1NBQUk7SUFDdkI7SUFDQUcsTUFBTTtRQUNKSixNQUFNO1lBQUMsQ0FBQztZQUFHO1lBQUc7U0FBRTtRQUNoQkMsTUFBTTtZQUFDLENBQUM7WUFBRztZQUFLLENBQUM7U0FBSTtJQUN2QjtBQUNGO0FBQ0EsU0FBU0ksTUFBTSxFQUNiQyxNQUFNLEVBQ05DLFlBQVksRUFDYjtJQUNDLE1BQU1DLE1BQU1YLHFEQUFTQTtJQUNyQlAsNENBQWUsQ0FBQztRQUNkLElBQUlpQixjQUFjQyxJQUFJRSxPQUFPLEdBQUdDLElBQUksR0FBR0MsR0FBRztJQUM1QyxHQUFHO1FBQUNOO1FBQVFDO0tBQWE7SUFDekIsT0FBTztBQUNUO0FBQ0EsU0FBU00sTUFBTSxFQUNiQyxRQUFRLEVBQ1JDLE1BQU0sRUFDTlIsZUFBZSxJQUFJLEVBQ25CUyxZQUFZLEdBQUcsRUFDZkMsVUFBVSxTQUFTLEVBQ25CQyxjQUFjLE1BQU0sRUFDcEJDLFNBQVMsV0FBVyxFQUNwQixHQUFHQyxPQUNKO0lBQ0MsSUFBSUMsT0FBT0MsYUFBYUMsT0FBT0MsU0FBU0MsU0FBU0MsU0FBU0Ms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LFVBQVU7WUFBQ3hCLE9BQU83QixJQUFJLENBQUMsRUFBRSxHQUFHTTtZQUFRdUIsT0FBTzdCLElBQUksQ0FBQyxFQUFFLEdBQUdNO1lBQVF1QixPQUFPN0IsSUFBSSxDQUFDLEVBQUUsR0FBR007U0FBTztRQUNyRmlDLE1BQU1qQyxTQUFTO1FBQ2Y4QixNQUFNLENBQUNEO1FBQ1BnQyxTQUFTN0I7SUFDWCxNQUFNcEIsZUFBZSxXQUFXLEdBQUU1QixnREFBbUIsQ0FBQ0Msd0RBQVdBLEVBQUV1RDtBQUNyRTtBQUVpQiIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2NvcmUvU3RhZ2UuanM/Zjk4MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2V4dGVuZHMgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZXh0ZW5kcyc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBFbnZpcm9ubWVudCB9IGZyb20gJy4vRW52aXJvbm1lbnQuanMnO1xuaW1wb3J0IHsgQ29udGFjdFNoYWRvd3MgfSBmcm9tICcuL0NvbnRhY3RTaGFkb3dzLmpzJztcbmltcG9ydCB7IENlbnRlciB9IGZyb20gJy4vQ2VudGVyLmpzJztcbmltcG9ydCB7IEFjY3VtdWxhdGl2ZVNoYWRvd3MsIFJhbmRvbWl6ZWRMaWdodCB9IGZyb20gJy4vQWNjdW11bGF0aXZlU2hhZG93cy5qcyc7XG5pbXBvcnQgeyBCb3VuZHMsIHVzZUJvdW5kcyB9IGZyb20gJy4vQm91bmRzLmpzJztcblxuY29uc3QgcHJlc2V0cyA9IHtcbiAgcmVtYnJhbmR0OiB7XG4gICAgbWFpbjogWzEsIDIsIDFdLFxuICAgIGZpbGw6IFstMiwgLTAuNSwgLTJdXG4gIH0sXG4gIHBvcnRyYWl0OiB7XG4gICAgbWFpbjogWy0xLCAyLCAwLjVdLFxuICAgIGZpbGw6IFstMSwgMC41LCAtMS41XVxuICB9LFxuICB1cGZyb250OiB7XG4gICAgbWFpbjogWzAsIDIsIDFdLFxuICAgIGZpbGw6IFstMSwgMC41LCAtMS41XVxuICB9LFxuICBzb2Z0OiB7XG4gICAgbWFpbjogWy0yLCA0LCA0XSxcbiAgICBmaWxsOiBbLTEsIDAuNSwgLTEuNV1cbiAgfVxufTtcbmZ1bmN0aW9uIFJlZml0KHtcbiAgcmFkaXVzLFxuICBhZGp1c3RDYW1lcmFcbn0pIHtcbiAgY29uc3QgYXBpID0gdXNlQm91bmRzKCk7XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGFkanVzdENhbWVyYSkgYXBpLnJlZnJlc2goKS5jbGlwKCkuZml0KCk7XG4gIH0sIFtyYWRpdXMsIGFkanVzdENhbWVyYV0pO1xuICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIFN0YWdlKHtcbiAgY2hpbGRyZW4sXG4gIGNlbnRlcixcbiAgYWRqdXN0Q2FtZXJhID0gdHJ1ZSxcbiAgaW50ZW5zaXR5ID0gMC41LFxuICBzaGFkb3dzID0gJ2NvbnRhY3QnLFxuICBlbnZpcm9ubWVudCA9ICdjaXR5JyxcbiAgcHJlc2V0ID0gJ3JlbWJyYW5kdCcsXG4gIC4uLnByb3BzXG59KSB7XG4gIHZhciBfYmlhcywgX25vcm1hbEJpYXMsIF9zaXplLCBfb2Zmc2V0LCBfYW1vdW50LCBfcmFkaXVzLCBfYW1iaWVudCwgX2ludGVuc2l0eTtcbiAgY29uc3QgY29uZmlnID0gdHlwZW9mIHByZXNldCA9PT0gJ3N0cmluZycgPyBwcmVzZXRzW3ByZXNldF0gOiBwcmVzZXQ7XG4gIGNvbnN0IFt7XG4gICAgcmFkaXVzLFxuICAgIGhlaWdodFxuICB9LCBzZXRdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgIHJhZGl1czogMCxcbiAgICB3aWR0aDogMCxcbiAgICBoZWlnaHQ6IDAsXG4gICAgZGVwdGg6IDBcbiAgfSk7XG4gIGNvbnN0IHNoYWRvd0JpYXMgPSAoX2JpYXMgPSBzaGFkb3dzID09IG51bGwgPyB2b2lkIDAgOiBzaGFkb3dzLmJpYXMpICE9PSBudWxsICYmIF9iaWFzICE9PSB2b2lkIDAgPyBfYmlhcyA6IC0wLjAwMDE7XG4gIGNvbnN0IG5vcm1hbEJpYXMgPSAoX25vcm1hbEJpYXMgPSBzaGFkb3dzID09IG51bGwgPyB2b2lkIDAgOiBzaGFkb3dzLm5vcm1hbEJpYXMpICE9PSBudWxsICYmIF9ub3JtYWxCaWFzICE9PSB2b2lkIDAgPyBfbm9ybWFsQmlhcyA6IDA7XG4gIGNvbnN0IHNoYWRvd1NpemUgPSAoX3NpemUgPSBzaGFkb3dzID09IG51bGwgPyB2b2lkIDAgOiBzaGFkb3dzLnNpemUpICE9PSBudWxsICYmIF9zaXplICE9PSB2b2lkIDAgPyBfc2l6ZSA6IDEwMjQ7XG4gIGNvbnN0IHNoYWRvd09mZnNldCA9IChfb2Zmc2V0ID0gc2hhZG93cyA9PSBudWxsID8gdm9pZCAwIDogc2hhZG93cy5vZmZzZXQpICE9PSBudWxsICYmIF9vZmZzZXQgIT09IHZvaWQgMCA/IF9vZmZzZXQgOiAwO1xuICBjb25zdCBjb250YWN0U2hhZG93ID0gc2hhZG93cyA9PT0gJ2NvbnRhY3QnIHx8IChzaGFkb3dzID09IG51bGwgPyB2b2lkIDAgOiBzaGFkb3dzLnR5cGUpID09PSAnY29udGFjdCc7XG4gIGNvbnN0IGFjY3VtdWxhdGl2ZVNoYWRvdyA9IHNoYWRvd3MgPT09ICdhY2N1bXVsYXRpdmUnIHx8IChzaGFkb3dzID09IG51bGwgPyB2b2lkIDAgOiBzaGFkb3dzLnR5cGUpID09PSAnYWNjdW11bGF0aXZlJztcbiAgY29uc3Qgc2hhZG93U3ByZWFkID0ge1xuICAgIC4uLih0eXBlb2Ygc2hhZG93cyA9PT0gJ29iamVjdCcgPyBzaGFkb3dzIDoge30pXG4gIH07XG4gIGNvbnN0IGVudmlyb25tZW50UHJvcHMgPSAhZW52aXJvbm1lbnQgPyBudWxsIDogdHlwZW9mIGVudmlyb25tZW50ID09PSAnc3RyaW5nJyA/IHtcbiAgICBwcmVzZXQ6IGVudmlyb25tZW50XG4gIH0gOiBlbnZpcm9ubWVudDtcbiAgY29uc3Qgb25DZW50ZXJlZCA9IFJlYWN0LnVzZUNhbGxiYWNrKHByb3BzID0+IHtcbiAgICBjb25zdCB7XG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICAgIGRlcHRoLFxuICAgICAgYm91bmRpbmdTcGhlcmVcbiAgICB9ID0gcHJvcHM7XG4gICAgc2V0KHtcbiAgICAgIHJhZGl1czogYm91bmRpbmdTcGhlcmUucmFkaXVzLFxuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHQsXG4gICAgICBkZXB0aFxuICAgIH0pO1xuICAgIGlmIChjZW50ZXIgIT0gbnVsbCAmJiBjZW50ZXIub25DZW50ZXJlZCkgY2VudGVyLm9uQ2VudGVyZWQocHJvcHMpO1xuICB9LCBbXSk7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChSZWFjdC5GcmFnbWVudCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJhbWJpZW50TGlnaHRcIiwge1xuICAgIGludGVuc2l0eTogaW50ZW5zaXR5IC8gM1xuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcG90TGlnaHRcIiwge1xuICAgIHBlbnVtYnJhOiAxLFxuICAgIHBvc2l0aW9uOiBbY29uZmlnLm1haW5bMF0gKiByYWRpdXMsIGNvbmZpZy5tYWluWzFdICogcmFkaXVzLCBjb25maWcubWFpblsyXSAqIHJhZGl1c10sXG4gICAgaW50ZW5zaXR5OiBpbnRlbnNpdHkgKiAyLFxuICAgIGNhc3RTaGFkb3c6ICEhc2hhZG93cyxcbiAgICBcInNoYWRvdy1iaWFzXCI6IHNoYWRvd0JpYXMsXG4gICAgXCJzaGFkb3ctbm9ybWFsQmlhc1wiOiBub3JtYWxCaWFzLFxuICAgIFwic2hhZG93LW1hcFNpemVcIjogc2hhZG93U2l6ZVxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJwb2ludExpZ2h0XCIsIHtcbiAgICBwb3NpdGlvbjogW2NvbmZpZy5maWxsWzBdICogcmFkaXVzLCBjb25maWcuZmlsbFsxXSAqIHJhZGl1cywgY29uZmlnLmZpbGxbMl0gKiByYWRpdXNdLFxuICAgIGludGVuc2l0eTogaW50ZW5zaXR5XG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChCb3VuZHMsIF9leHRlbmRzKHtcbiAgICBmaXQ6ICEhYWRqdXN0Q2FtZXJhLFxuICAgIGNsaXA6ICEhYWRqdXN0Q2FtZXJhLFxuICAgIG1hcmdpbjogTnVtYmVyKGFkanVzdENhbWVyYSksXG4gICAgb2JzZXJ2ZTogdHJ1ZVxuICB9LCBwcm9wcyksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlZml0LCB7XG4gICAgcmFkaXVzOiByYWRpdXMsXG4gICAgYWRqdXN0Q2FtZXJhOiBhZGp1c3RDYW1lcmFcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENlbnRlciwgX2V4dGVuZHMoe30sIGNlbnRlciwge1xuICAgIHBvc2l0aW9uOiBbMCwgc2hhZG93T2Zmc2V0IC8gMiwgMF0sXG4gICAgb25DZW50ZXJlZDogb25DZW50ZXJlZFxuICB9KSwgY2hpbGRyZW4pKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJncm91cFwiLCB7XG4gICAgcG9zaXRpb246IFswLCAtaGVpZ2h0IC8gMiAtIHNoYWRvd09mZnNldCAvIDIsIDBdXG4gIH0sIGNvbnRhY3RTaGFkb3cgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ29udGFjdFNoYWRvd3MsIF9leHRlbmRzKHtcbiAgICBzY2FsZTogcmFkaXVzICogNCxcbiAgICBmYXI6IHJhZGl1cyxcbiAgICBibHVyOiAyXG4gIH0sIHNoYWRvd1NwcmVhZCkpLCBhY2N1bXVsYXRpdmVTaGFkb3cgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQWNjdW11bGF0aXZlU2hhZG93cywgX2V4dGVuZHMoe1xuICAgIHRlbXBvcmFsOiB0cnVlLFxuICAgIGZyYW1lczogMTAwLFxuICAgIGFscGhhVGVzdDogMC45LFxuICAgIHRvbmVNYXBwZWQ6IHRydWUsXG4gICAgc2NhbGU6IHJhZGl1cyAqIDRcbiAgfSwgc2hhZG93U3ByZWFkKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmFuZG9taXplZExpZ2h0LCB7XG4gICAgYW1vdW50OiAoX2Ftb3VudCA9IHNoYWRvd1NwcmVhZC5hbW91bnQpICE9PSBudWxsICYmIF9hbW91bnQgIT09IHZvaWQgMCA/IF9hbW91bnQgOiA4LFxuICAgIHJhZGl1czogKF9yYWRpdXMgPSBzaGFkb3dTcHJlYWQucmFkaXVzKSAhPT0gbnVsbCAmJiBfcmFkaXVzICE9PSB2b2lkIDAgPyBfcmFkaXVzIDogcmFkaXVzLFxuICAgIGFtYmllbnQ6IChfYW1iaWVudCA9IHNoYWRvd1NwcmVhZC5hbWJpZW50KSAhPT0gbnVsbCAmJiBfYW1iaWVudCAhPT0gdm9pZCAwID8gX2FtYmllbnQgOiAwLjUsXG4gICAgaW50ZW5zaXR5OiAoX2ludGVuc2l0eSA9IHNoYWRvd1NwcmVhZC5pbnRlbnNpdHkpICE9PSBudWxsICYmIF9pbnRlbnNpdHkgIT09IHZvaWQgMCA/IF9pbnRlbnNpdHkgOiAxLFxuICAgIHBvc2l0aW9uOiBbY29uZmlnLm1haW5bMF0gKiByYWRpdXMsIGNvbmZpZy5tYWluWzFdICogcmFkaXVzLCBjb25maWcubWFpblsyXSAqIHJhZGl1c10sXG4gICAgc2l6ZTogcmFkaXVzICogNCxcbiAgICBiaWFzOiAtc2hhZG93QmlhcyxcbiAgICBtYXBTaXplOiBzaGFkb3dTaXplXG4gIH0pKSksIGVudmlyb25tZW50ICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEVudmlyb25tZW50LCBlbnZpcm9ubWVudFByb3BzKSk7XG59XG5cbmV4cG9ydCB7IFN0YWdlIH07XG4iXSwibmFtZXMiOlsiX2V4dGVuZHMiLCJSZWFjdCIsIkVudmlyb25tZW50IiwiQ29udGFjdFNoYWRvd3MiLCJDZW50ZXIiLCJBY2N1bXVsYXRpdmVTaGFkb3dzIiwiUmFuZG9taXplZExpZ2h0IiwiQm91bmRzIiwidXNlQm91bmRzIiwicHJlc2V0cyIsInJlbWJyYW5kdCIsIm1haW4iLCJmaWxsIiwicG9ydHJhaXQiLCJ1cGZyb250Iiwic29mdCIsIlJlZml0IiwicmFkaXVzIiwiYWRqdXN0Q2FtZXJhIiwiYXBpIiwidXNlRWZmZWN0IiwicmVmcmVzaCIsImNsaXAiLCJmaXQiLCJTdGFnZSIsImNoaWxkcmVuIiwiY2VudGVyIiwiaW50ZW5zaXR5Iiwic2hhZG93cyIsImVudmlyb25tZW50IiwicHJlc2V0IiwicHJvcHMiLCJfYmlhcyIsIl9ub3JtYWxCaWFzIiwiX3NpemUiLCJfb2Zmc2V0IiwiX2Ftb3VudCIsIl9yYWRpdXMiLCJfYW1iaWVudCIsIl9pbnRlbnNpdHkiLCJjb25maWciLCJoZWlnaHQiLCJzZXQiLCJ1c2VTdGF0ZSIsIndpZHRoIiwiZGVwdGgiLCJzaGFkb3dCaWFzIiwiYmlhcyIsIm5vcm1hbEJpYXMiLCJzaGFkb3dTaXplIiwic2l6ZSIsInNoYWRvd09mZnNldCIsIm9mZnNldCIsImNvbnRhY3RTaGFkb3ciLCJ0eXBlIiwiYWNjdW11bGF0aXZlU2hhZG93Iiwic2hhZG93U3ByZWFkIiwiZW52aXJvbm1lbnRQcm9wcyIsIm9uQ2VudGVyZWQiLCJ1c2VDYWxsYmFjayIsImJvdW5kaW5nU3BoZXJlIiwiY3JlYXRlRWxlbWVudCIsIkZyYWdtZW50IiwicGVudW1icmEiLCJwb3NpdGlvbiIsImNhc3RTaGFkb3ciLCJtYXJnaW4iLCJOdW1iZXIiLCJvYnNlcnZlIiwic2NhbGUiLCJmYXIiLCJibHVyIiwidGVtcG9yYWwiLCJmcmFtZXMiLCJhbHBoYVRlc3QiLCJ0b25lTWFwcGVkIiwiYW1vdW50IiwiYW1iaWVudCIsIm1hcFNpemUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/Stage.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/shaderMaterial.js":
/*!***************************************************************!*\
  !*** ./node_modules/@react-three/drei/core/shaderMaterial.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   shaderMaterial: () => (/* binding */ shaderMaterial)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n\nfunction shaderMaterial(uniforms, vertexShader, fragmentShader, onInit) {\n    const material = class material extends three__WEBPACK_IMPORTED_MODULE_0__.ShaderMaterial {\n        constructor(parameters = {}){\n            const entries = Object.entries(uniforms);\n            // Create unforms and shaders\n            super({\n                uniforms: entries.reduce((acc, [name, value])=>{\n                    const uniform = three__WEBPACK_IMPORTED_MODULE_0__.UniformsUtils.clone({\n                        [name]: {\n                            value\n                        }\n                    });\n                    return {\n                        ...acc,\n                        ...uniform\n                    };\n                }, {}),\n                vertexShader,\n                fragmentShader\n            });\n            // Create getter/setters\n            this.key = \"\";\n            entries.forEach(([name])=>Object.defineProperty(this, name, {\n                    get: ()=>this.uniforms[name].value,\n                    set: (v)=>this.uniforms[name].value = v\n                }));\n            // Assign parameters, this might include uniforms\n            Object.assign(this, parameters);\n            // Call onInit\n            if (onInit) onInit(this);\n        }\n    };\n    material.key = three__WEBPACK_IMPORTED_MODULE_0__.MathUtils.generateUUID();\n    return material;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS9zaGFkZXJNYXRlcmlhbC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUErQjtBQUUvQixTQUFTQyxlQUFlQyxRQUFRLEVBQUVDLFlBQVksRUFBRUMsY0FBYyxFQUFFQyxNQUFNO0lBQ3BFLE1BQU1DLFdBQVcsTUFBTUEsaUJBQWlCTixpREFBb0I7UUFDMURRLFlBQVlDLGFBQWEsQ0FBQyxDQUFDLENBQUU7WUFDM0IsTUFBTUMsVUFBVUMsT0FBT0QsT0FBTyxDQUFDUjtZQUMvQiw2QkFBNkI7WUFDN0IsS0FBSyxDQUFDO2dCQUNKQSxVQUFVUSxRQUFRRSxNQUFNLENBQUMsQ0FBQ0MsS0FBSyxDQUFDQyxNQUFNQyxNQUFNO29CQUMxQyxNQUFNQyxVQUFVaEIsZ0RBQW1CLENBQUNrQixLQUFLLENBQUM7d0JBQ3hDLENBQUNKLEtBQUssRUFBRTs0QkFDTkM7d0JBQ0Y7b0JBQ0Y7b0JBQ0EsT0FBTzt3QkFDTCxHQUFHRixHQUFHO3dCQUNOLEdBQUdHLE9BQU87b0JBQ1o7Z0JBQ0YsR0FBRyxDQUFDO2dCQUNKYjtnQkFDQUM7WUFDRjtZQUNBLHdCQUF3QjtZQUN4QixJQUFJLENBQUNlLEdBQUcsR0FBRztZQUNYVCxRQUFRVSxPQUFPLENBQUMsQ0FBQyxDQUFDTixLQUFLLEdBQUtILE9BQU9VLGNBQWMsQ0FBQyxJQUFJLEVBQUVQLE1BQU07b0JBQzVEUSxLQUFLLElBQU0sSUFBSSxDQUFDcEIsUUFBUSxDQUFDWSxLQUFLLENBQUNDLEtBQUs7b0JBQ3BDUSxLQUFLQyxDQUFBQSxJQUFLLElBQUksQ0FBQ3RCLFFBQVEsQ0FBQ1ksS0FBSyxDQUFDQyxLQUFLLEdBQUdTO2dCQUN4QztZQUVBLGlEQUFpRDtZQUNqRGIsT0FBT2MsTUFBTSxDQUFDLElBQUksRUFBRWhCO1lBQ3BCLGNBQWM7WUFDZCxJQUFJSixRQUFRQSxPQUFPLElBQUk7UUFDekI7SUFDRjtJQUNBQyxTQUFTYSxHQUFHLEdBQUduQiw0Q0FBZSxDQUFDMkIsWUFBWTtJQUMzQyxPQUFPckI7QUFDVDtBQUUwQiIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2NvcmUvc2hhZGVyTWF0ZXJpYWwuanM/Nzc4MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XG5cbmZ1bmN0aW9uIHNoYWRlck1hdGVyaWFsKHVuaWZvcm1zLCB2ZXJ0ZXhTaGFkZXIsIGZyYWdtZW50U2hhZGVyLCBvbkluaXQpIHtcbiAgY29uc3QgbWF0ZXJpYWwgPSBjbGFzcyBtYXRlcmlhbCBleHRlbmRzIFRIUkVFLlNoYWRlck1hdGVyaWFsIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyh1bmlmb3Jtcyk7XG4gICAgICAvLyBDcmVhdGUgdW5mb3JtcyBhbmQgc2hhZGVyc1xuICAgICAgc3VwZXIoe1xuICAgICAgICB1bmlmb3JtczogZW50cmllcy5yZWR1Y2UoKGFjYywgW25hbWUsIHZhbHVlXSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVuaWZvcm0gPSBUSFJFRS5Vbmlmb3Jtc1V0aWxzLmNsb25lKHtcbiAgICAgICAgICAgIFtuYW1lXToge1xuICAgICAgICAgICAgICB2YWx1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5hY2MsXG4gICAgICAgICAgICAuLi51bmlmb3JtXG4gICAgICAgICAgfTtcbiAgICAgICAgfSwge30pLFxuICAgICAgICB2ZXJ0ZXhTaGFkZXIsXG4gICAgICAgIGZyYWdtZW50U2hhZGVyXG4gICAgICB9KTtcbiAgICAgIC8vIENyZWF0ZSBnZXR0ZXIvc2V0dGVyc1xuICAgICAgdGhpcy5rZXkgPSAnJztcbiAgICAgIGVudHJpZXMuZm9yRWFjaCgoW25hbWVdKSA9PiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgbmFtZSwge1xuICAgICAgICBnZXQ6ICgpID0+IHRoaXMudW5pZm9ybXNbbmFtZV0udmFsdWUsXG4gICAgICAgIHNldDogdiA9PiB0aGlzLnVuaWZvcm1zW25hbWVdLnZhbHVlID0gdlxuICAgICAgfSkpO1xuXG4gICAgICAvLyBBc3NpZ24gcGFyYW1ldGVycywgdGhpcyBtaWdodCBpbmNsdWRlIHVuaWZvcm1zXG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHBhcmFtZXRlcnMpO1xuICAgICAgLy8gQ2FsbCBvbkluaXRcbiAgICAgIGlmIChvbkluaXQpIG9uSW5pdCh0aGlzKTtcbiAgICB9XG4gIH07XG4gIG1hdGVyaWFsLmtleSA9IFRIUkVFLk1hdGhVdGlscy5nZW5lcmF0ZVVVSUQoKTtcbiAgcmV0dXJuIG1hdGVyaWFsO1xufVxuXG5leHBvcnQgeyBzaGFkZXJNYXRlcmlhbCB9O1xuIl0sIm5hbWVzIjpbIlRIUkVFIiwic2hhZGVyTWF0ZXJpYWwiLCJ1bmlmb3JtcyIsInZlcnRleFNoYWRlciIsImZyYWdtZW50U2hhZGVyIiwib25Jbml0IiwibWF0ZXJpYWwiLCJTaGFkZXJNYXRlcmlhbCIsImNvbnN0cnVjdG9yIiwicGFyYW1ldGVycyIsImVudHJpZXMiLCJPYmplY3QiLCJyZWR1Y2UiLCJhY2MiLCJuYW1lIiwidmFsdWUiLCJ1bmlmb3JtIiwiVW5pZm9ybXNVdGlscyIsImNsb25lIiwia2V5IiwiZm9yRWFjaCIsImRlZmluZVByb3BlcnR5IiwiZ2V0Iiwic2V0IiwidiIsImFzc2lnbiIsIk1hdGhVdGlscyIsImdlbmVyYXRlVVVJRCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/shaderMaterial.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/useEnvironment.js":
/*!***************************************************************!*\
  !*** ./node_modules/@react-three/drei/core/useEnvironment.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useEnvironment: () => (/* binding */ useEnvironment)\n/* harmony export */ });\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/loaders/RGBELoader.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/loaders/EXRLoader.js\");\n/* harmony import */ var _monogrid_gainmap_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @monogrid/gainmap-js */ \"(ssr)/./node_modules/@monogrid/gainmap-js/dist/decode.js\");\n/* harmony import */ var _helpers_environment_assets_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/environment-assets.js */ \"(ssr)/./node_modules/@react-three/drei/helpers/environment-assets.js\");\n/* harmony import */ var _helpers_deprecated_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/deprecated.js */ \"(ssr)/./node_modules/@react-three/drei/helpers/deprecated.js\");\n\n\n\n\n\n\nconst CUBEMAP_ROOT = \"https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/\";\nconst isArray = (arr)=>Array.isArray(arr);\nfunction useEnvironment({ files = [\n    \"/px.png\",\n    \"/nx.png\",\n    \"/py.png\",\n    \"/ny.png\",\n    \"/pz.png\",\n    \"/nz.png\"\n], path = \"\", preset = undefined, encoding = undefined, extensions } = {}) {\n    var _firstEntry$split$pop;\n    let loader = null;\n    let multiFile = false;\n    let extension;\n    if (preset) {\n        if (!(preset in _helpers_environment_assets_js__WEBPACK_IMPORTED_MODULE_0__.presetsObj)) throw new Error(\"Preset must be one of: \" + Object.keys(_helpers_environment_assets_js__WEBPACK_IMPORTED_MODULE_0__.presetsObj).join(\", \"));\n        files = _helpers_environment_assets_js__WEBPACK_IMPORTED_MODULE_0__.presetsObj[preset];\n        path = CUBEMAP_ROOT;\n    }\n    const isCubemap = isArray(files) && files.length === 6;\n    const isGainmap = isArray(files) && files.length === 3 && files.some((file)=>file.endsWith(\"json\"));\n    const firstEntry = isArray(files) ? files[0] : files;\n    // Everything else\n    multiFile = isArray(files);\n    extension = isCubemap ? \"cube\" : isGainmap ? \"webp\" : firstEntry.startsWith(\"data:application/exr\") ? \"exr\" : firstEntry.startsWith(\"data:application/hdr\") ? \"hdr\" : firstEntry.startsWith(\"data:image/jpeg\") ? \"jpg\" : (_firstEntry$split$pop = firstEntry.split(\".\").pop()) == null || (_firstEntry$split$pop = _firstEntry$split$pop.split(\"?\")) == null || (_firstEntry$split$pop = _firstEntry$split$pop.shift()) == null ? void 0 : _firstEntry$split$pop.toLowerCase();\n    loader = extension === \"cube\" ? three__WEBPACK_IMPORTED_MODULE_1__.CubeTextureLoader : extension === \"hdr\" ? three_stdlib__WEBPACK_IMPORTED_MODULE_2__.RGBELoader : extension === \"exr\" ? three_stdlib__WEBPACK_IMPORTED_MODULE_3__.EXRLoader : extension === \"jpg\" || extension === \"jpeg\" ? _monogrid_gainmap_js__WEBPACK_IMPORTED_MODULE_4__.HDRJPGLoader : extension === \"webp\" ? _monogrid_gainmap_js__WEBPACK_IMPORTED_MODULE_4__.GainMapLoader : null;\n    if (!loader) throw new Error(\"useEnvironment: Unrecognized file extension: \" + files);\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.A)((state)=>state.gl);\n    const loaderResult = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_5__.F)(// @ts-expect-error\n    loader, multiFile ? [\n        files\n    ] : files, (loader)=>{\n        // Gainmap requires a renderer\n        if (extension === \"webp\" || extension === \"jpg\" || extension === \"jpeg\") {\n            loader.setRenderer(gl);\n        }\n        loader.setPath == null || loader.setPath(path);\n        if (extensions) extensions(loader);\n    });\n    let texture = multiFile ? // @ts-ignore\n    loaderResult[0] : loaderResult;\n    if (extension === \"jpg\" || extension === \"jpeg\" || extension === \"webp\") {\n        var _renderTarget;\n        texture = (_renderTarget = texture.renderTarget) == null ? void 0 : _renderTarget.texture;\n    }\n    texture.mapping = isCubemap ? three__WEBPACK_IMPORTED_MODULE_1__.CubeReflectionMapping : three__WEBPACK_IMPORTED_MODULE_1__.EquirectangularReflectionMapping;\n    if (\"colorSpace\" in texture) texture.colorSpace = (encoding !== null && encoding !== void 0 ? encoding : isCubemap) ? \"srgb\" : \"srgb-linear\";\n    else texture.encoding = (encoding !== null && encoding !== void 0 ? encoding : isCubemap) ? _helpers_deprecated_js__WEBPACK_IMPORTED_MODULE_6__.sRGBEncoding : _helpers_deprecated_js__WEBPACK_IMPORTED_MODULE_6__.LinearEncoding;\n    return texture;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS91c2VFbnZpcm9ubWVudC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF5RDtBQUMwQztBQUM5QztBQUNjO0FBQ0w7QUFDVTtBQUV4RSxNQUFNWSxlQUFlO0FBQ3JCLE1BQU1DLFVBQVVDLENBQUFBLE1BQU9DLE1BQU1GLE9BQU8sQ0FBQ0M7QUFDckMsU0FBU0UsZUFBZSxFQUN0QkMsUUFBUTtJQUFDO0lBQVc7SUFBVztJQUFXO0lBQVc7SUFBVztDQUFVLEVBQzFFQyxPQUFPLEVBQUUsRUFDVEMsU0FBU0MsU0FBUyxFQUNsQkMsV0FBV0QsU0FBUyxFQUNwQkUsVUFBVSxFQUNYLEdBQUcsQ0FBQyxDQUFDO0lBQ0osSUFBSUM7SUFDSixJQUFJQyxTQUFTO0lBQ2IsSUFBSUMsWUFBWTtJQUNoQixJQUFJQztJQUNKLElBQUlQLFFBQVE7UUFDVixJQUFJLENBQUVBLENBQUFBLFVBQVVWLHNFQUFTLEdBQUksTUFBTSxJQUFJa0IsTUFBTSw0QkFBNEJDLE9BQU9DLElBQUksQ0FBQ3BCLHNFQUFVQSxFQUFFcUIsSUFBSSxDQUFDO1FBQ3RHYixRQUFRUixzRUFBVSxDQUFDVSxPQUFPO1FBQzFCRCxPQUFPTjtJQUNUO0lBQ0EsTUFBTW1CLFlBQVlsQixRQUFRSSxVQUFVQSxNQUFNZSxNQUFNLEtBQUs7SUFDckQsTUFBTUMsWUFBWXBCLFFBQVFJLFVBQVVBLE1BQU1lLE1BQU0sS0FBSyxLQUFLZixNQUFNaUIsSUFBSSxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLQyxRQUFRLENBQUM7SUFDM0YsTUFBTUMsYUFBYXhCLFFBQVFJLFNBQVNBLEtBQUssQ0FBQyxFQUFFLEdBQUdBO0lBRS9DLGtCQUFrQjtJQUNsQlEsWUFBWVosUUFBUUk7SUFDcEJTLFlBQVlLLFlBQVksU0FBU0UsWUFBWSxTQUFTSSxXQUFXQyxVQUFVLENBQUMsMEJBQTBCLFFBQVFELFdBQVdDLFVBQVUsQ0FBQywwQkFBMEIsUUFBUUQsV0FBV0MsVUFBVSxDQUFDLHFCQUFxQixRQUFRLENBQUNmLHdCQUF3QmMsV0FBV0UsS0FBSyxDQUFDLEtBQUtDLEdBQUcsRUFBQyxLQUFNLFFBQVEsQ0FBQ2pCLHdCQUF3QkEsc0JBQXNCZ0IsS0FBSyxDQUFDLElBQUcsS0FBTSxRQUFRLENBQUNoQix3QkFBd0JBLHNCQUFzQmtCLEtBQUssRUFBQyxLQUFNLE9BQU8sS0FBSyxJQUFJbEIsc0JBQXNCbUIsV0FBVztJQUM1Y2xCLFNBQVNFLGNBQWMsU0FBU3RCLG9EQUFpQkEsR0FBR3NCLGNBQWMsUUFBUXJCLG9EQUFVQSxHQUFHcUIsY0FBYyxRQUFRcEIsbURBQVNBLEdBQUdvQixjQUFjLFNBQVNBLGNBQWMsU0FBU25CLDhEQUFZQSxHQUFHbUIsY0FBYyxTQUFTbEIsK0RBQWFBLEdBQUc7SUFDN04sSUFBSSxDQUFDZ0IsUUFBUSxNQUFNLElBQUlHLE1BQU0sa0RBQWtEVjtJQUMvRSxNQUFNMEIsS0FBSzNDLHFEQUFRQSxDQUFDNEMsQ0FBQUEsUUFBU0EsTUFBTUQsRUFBRTtJQUNyQyxNQUFNRSxlQUFlNUMscURBQVNBLENBQzlCLG1CQUFtQjtJQUNuQnVCLFFBQVFDLFlBQVk7UUFBQ1I7S0FBTSxHQUFHQSxPQUFPTyxDQUFBQTtRQUNuQyw4QkFBOEI7UUFDOUIsSUFBSUUsY0FBYyxVQUFVQSxjQUFjLFNBQVNBLGNBQWMsUUFBUTtZQUN2RUYsT0FBT3NCLFdBQVcsQ0FBQ0g7UUFDckI7UUFDQW5CLE9BQU91QixPQUFPLElBQUksUUFBUXZCLE9BQU91QixPQUFPLENBQUM3QjtRQUN6QyxJQUFJSSxZQUFZQSxXQUFXRTtJQUM3QjtJQUNBLElBQUl3QixVQUFVdkIsWUFDZCxhQUFhO0lBQ2JvQixZQUFZLENBQUMsRUFBRSxHQUFHQTtJQUNsQixJQUFJbkIsY0FBYyxTQUFTQSxjQUFjLFVBQVVBLGNBQWMsUUFBUTtRQUN2RSxJQUFJdUI7UUFDSkQsVUFBVSxDQUFDQyxnQkFBZ0JELFFBQVFFLFlBQVksS0FBSyxPQUFPLEtBQUssSUFBSUQsY0FBY0QsT0FBTztJQUMzRjtJQUNBQSxRQUFRRyxPQUFPLEdBQUdwQixZQUFZN0Isd0RBQXFCQSxHQUFHQyxtRUFBZ0NBO0lBQ3RGLElBQUksZ0JBQWdCNkMsU0FBU0EsUUFBUUksVUFBVSxHQUFHLENBQUMvQixhQUFhLFFBQVFBLGFBQWEsS0FBSyxJQUFJQSxXQUFXVSxTQUFRLElBQUssU0FBUztTQUFtQmlCLFFBQVEzQixRQUFRLEdBQUcsQ0FBQ0EsYUFBYSxRQUFRQSxhQUFhLEtBQUssSUFBSUEsV0FBV1UsU0FBUSxJQUFLckIsZ0VBQVlBLEdBQUdDLGtFQUFjQTtJQUN0USxPQUFPcUM7QUFDVDtBQUUwQiIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2NvcmUvdXNlRW52aXJvbm1lbnQuanM/NzBjOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VUaHJlZSwgdXNlTG9hZGVyIH0gZnJvbSAnQHJlYWN0LXRocmVlL2ZpYmVyJztcbmltcG9ydCB7IEN1YmVSZWZsZWN0aW9uTWFwcGluZywgRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmcsIEN1YmVUZXh0dXJlTG9hZGVyIH0gZnJvbSAndGhyZWUnO1xuaW1wb3J0IHsgUkdCRUxvYWRlciwgRVhSTG9hZGVyIH0gZnJvbSAndGhyZWUtc3RkbGliJztcbmltcG9ydCB7IEhEUkpQR0xvYWRlciwgR2Fpbk1hcExvYWRlciB9IGZyb20gJ0Btb25vZ3JpZC9nYWlubWFwLWpzJztcbmltcG9ydCB7IHByZXNldHNPYmogfSBmcm9tICcuLi9oZWxwZXJzL2Vudmlyb25tZW50LWFzc2V0cy5qcyc7XG5pbXBvcnQgeyBzUkdCRW5jb2RpbmcsIExpbmVhckVuY29kaW5nIH0gZnJvbSAnLi4vaGVscGVycy9kZXByZWNhdGVkLmpzJztcblxuY29uc3QgQ1VCRU1BUF9ST09UID0gJ2h0dHBzOi8vcmF3LmdpdGhhY2suY29tL3BtbmRycy9kcmVpLWFzc2V0cy80NTYwNjBhMjZiYmViOGZkZjc5MzI2ZjIyNGI2ZDk5YjhiY2NlNzM2L2hkcmkvJztcbmNvbnN0IGlzQXJyYXkgPSBhcnIgPT4gQXJyYXkuaXNBcnJheShhcnIpO1xuZnVuY3Rpb24gdXNlRW52aXJvbm1lbnQoe1xuICBmaWxlcyA9IFsnL3B4LnBuZycsICcvbngucG5nJywgJy9weS5wbmcnLCAnL255LnBuZycsICcvcHoucG5nJywgJy9uei5wbmcnXSxcbiAgcGF0aCA9ICcnLFxuICBwcmVzZXQgPSB1bmRlZmluZWQsXG4gIGVuY29kaW5nID0gdW5kZWZpbmVkLFxuICBleHRlbnNpb25zXG59ID0ge30pIHtcbiAgdmFyIF9maXJzdEVudHJ5JHNwbGl0JHBvcDtcbiAgbGV0IGxvYWRlciA9IG51bGw7XG4gIGxldCBtdWx0aUZpbGUgPSBmYWxzZTtcbiAgbGV0IGV4dGVuc2lvbjtcbiAgaWYgKHByZXNldCkge1xuICAgIGlmICghKHByZXNldCBpbiBwcmVzZXRzT2JqKSkgdGhyb3cgbmV3IEVycm9yKCdQcmVzZXQgbXVzdCBiZSBvbmUgb2Y6ICcgKyBPYmplY3Qua2V5cyhwcmVzZXRzT2JqKS5qb2luKCcsICcpKTtcbiAgICBmaWxlcyA9IHByZXNldHNPYmpbcHJlc2V0XTtcbiAgICBwYXRoID0gQ1VCRU1BUF9ST09UO1xuICB9XG4gIGNvbnN0IGlzQ3ViZW1hcCA9IGlzQXJyYXkoZmlsZXMpICYmIGZpbGVzLmxlbmd0aCA9PT0gNjtcbiAgY29uc3QgaXNHYWlubWFwID0gaXNBcnJheShmaWxlcykgJiYgZmlsZXMubGVuZ3RoID09PSAzICYmIGZpbGVzLnNvbWUoZmlsZSA9PiBmaWxlLmVuZHNXaXRoKCdqc29uJykpO1xuICBjb25zdCBmaXJzdEVudHJ5ID0gaXNBcnJheShmaWxlcykgPyBmaWxlc1swXSA6IGZpbGVzO1xuXG4gIC8vIEV2ZXJ5dGhpbmcgZWxzZVxuICBtdWx0aUZpbGUgPSBpc0FycmF5KGZpbGVzKTtcbiAgZXh0ZW5zaW9uID0gaXNDdWJlbWFwID8gJ2N1YmUnIDogaXNHYWlubWFwID8gJ3dlYnAnIDogZmlyc3RFbnRyeS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uL2V4cicpID8gJ2V4cicgOiBmaXJzdEVudHJ5LnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vaGRyJykgPyAnaGRyJyA6IGZpcnN0RW50cnkuc3RhcnRzV2l0aCgnZGF0YTppbWFnZS9qcGVnJykgPyAnanBnJyA6IChfZmlyc3RFbnRyeSRzcGxpdCRwb3AgPSBmaXJzdEVudHJ5LnNwbGl0KCcuJykucG9wKCkpID09IG51bGwgfHwgKF9maXJzdEVudHJ5JHNwbGl0JHBvcCA9IF9maXJzdEVudHJ5JHNwbGl0JHBvcC5zcGxpdCgnPycpKSA9PSBudWxsIHx8IChfZmlyc3RFbnRyeSRzcGxpdCRwb3AgPSBfZmlyc3RFbnRyeSRzcGxpdCRwb3Auc2hpZnQoKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9maXJzdEVudHJ5JHNwbGl0JHBvcC50b0xvd2VyQ2FzZSgpO1xuICBsb2FkZXIgPSBleHRlbnNpb24gPT09ICdjdWJlJyA/IEN1YmVUZXh0dXJlTG9hZGVyIDogZXh0ZW5zaW9uID09PSAnaGRyJyA/IFJHQkVMb2FkZXIgOiBleHRlbnNpb24gPT09ICdleHInID8gRVhSTG9hZGVyIDogZXh0ZW5zaW9uID09PSAnanBnJyB8fCBleHRlbnNpb24gPT09ICdqcGVnJyA/IEhEUkpQR0xvYWRlciA6IGV4dGVuc2lvbiA9PT0gJ3dlYnAnID8gR2Fpbk1hcExvYWRlciA6IG51bGw7XG4gIGlmICghbG9hZGVyKSB0aHJvdyBuZXcgRXJyb3IoJ3VzZUVudmlyb25tZW50OiBVbnJlY29nbml6ZWQgZmlsZSBleHRlbnNpb246ICcgKyBmaWxlcyk7XG4gIGNvbnN0IGdsID0gdXNlVGhyZWUoc3RhdGUgPT4gc3RhdGUuZ2wpO1xuICBjb25zdCBsb2FkZXJSZXN1bHQgPSB1c2VMb2FkZXIoXG4gIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgbG9hZGVyLCBtdWx0aUZpbGUgPyBbZmlsZXNdIDogZmlsZXMsIGxvYWRlciA9PiB7XG4gICAgLy8gR2Fpbm1hcCByZXF1aXJlcyBhIHJlbmRlcmVyXG4gICAgaWYgKGV4dGVuc2lvbiA9PT0gJ3dlYnAnIHx8IGV4dGVuc2lvbiA9PT0gJ2pwZycgfHwgZXh0ZW5zaW9uID09PSAnanBlZycpIHtcbiAgICAgIGxvYWRlci5zZXRSZW5kZXJlcihnbCk7XG4gICAgfVxuICAgIGxvYWRlci5zZXRQYXRoID09IG51bGwgfHwgbG9hZGVyLnNldFBhdGgocGF0aCk7XG4gICAgaWYgKGV4dGVuc2lvbnMpIGV4dGVuc2lvbnMobG9hZGVyKTtcbiAgfSk7XG4gIGxldCB0ZXh0dXJlID0gbXVsdGlGaWxlID9cbiAgLy8gQHRzLWlnbm9yZVxuICBsb2FkZXJSZXN1bHRbMF0gOiBsb2FkZXJSZXN1bHQ7XG4gIGlmIChleHRlbnNpb24gPT09ICdqcGcnIHx8IGV4dGVuc2lvbiA9PT0gJ2pwZWcnIHx8IGV4dGVuc2lvbiA9PT0gJ3dlYnAnKSB7XG4gICAgdmFyIF9yZW5kZXJUYXJnZXQ7XG4gICAgdGV4dHVyZSA9IChfcmVuZGVyVGFyZ2V0ID0gdGV4dHVyZS5yZW5kZXJUYXJnZXQpID09IG51bGwgPyB2b2lkIDAgOiBfcmVuZGVyVGFyZ2V0LnRleHR1cmU7XG4gIH1cbiAgdGV4dHVyZS5tYXBwaW5nID0gaXNDdWJlbWFwID8gQ3ViZVJlZmxlY3Rpb25NYXBwaW5nIDogRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmc7XG4gIGlmICgnY29sb3JTcGFjZScgaW4gdGV4dHVyZSkgdGV4dHVyZS5jb2xvclNwYWNlID0gKGVuY29kaW5nICE9PSBudWxsICYmIGVuY29kaW5nICE9PSB2b2lkIDAgPyBlbmNvZGluZyA6IGlzQ3ViZW1hcCkgPyAnc3JnYicgOiAnc3JnYi1saW5lYXInO2Vsc2UgdGV4dHVyZS5lbmNvZGluZyA9IChlbmNvZGluZyAhPT0gbnVsbCAmJiBlbmNvZGluZyAhPT0gdm9pZCAwID8gZW5jb2RpbmcgOiBpc0N1YmVtYXApID8gc1JHQkVuY29kaW5nIDogTGluZWFyRW5jb2Rpbmc7XG4gIHJldHVybiB0ZXh0dXJlO1xufVxuXG5leHBvcnQgeyB1c2VFbnZpcm9ubWVudCB9O1xuIl0sIm5hbWVzIjpbInVzZVRocmVlIiwidXNlTG9hZGVyIiwiQ3ViZVJlZmxlY3Rpb25NYXBwaW5nIiwiRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmciLCJDdWJlVGV4dHVyZUxvYWRlciIsIlJHQkVMb2FkZXIiLCJFWFJMb2FkZXIiLCJIRFJKUEdMb2FkZXIiLCJHYWluTWFwTG9hZGVyIiwicHJlc2V0c09iaiIsInNSR0JFbmNvZGluZyIsIkxpbmVhckVuY29kaW5nIiwiQ1VCRU1BUF9ST09UIiwiaXNBcnJheSIsImFyciIsIkFycmF5IiwidXNlRW52aXJvbm1lbnQiLCJmaWxlcyIsInBhdGgiLCJwcmVzZXQiLCJ1bmRlZmluZWQiLCJlbmNvZGluZyIsImV4dGVuc2lvbnMiLCJfZmlyc3RFbnRyeSRzcGxpdCRwb3AiLCJsb2FkZXIiLCJtdWx0aUZpbGUiLCJleHRlbnNpb24iLCJFcnJvciIsIk9iamVjdCIsImtleXMiLCJqb2luIiwiaXNDdWJlbWFwIiwibGVuZ3RoIiwiaXNHYWlubWFwIiwic29tZSIsImZpbGUiLCJlbmRzV2l0aCIsImZpcnN0RW50cnkiLCJzdGFydHNXaXRoIiwic3BsaXQiLCJwb3AiLCJzaGlmdCIsInRvTG93ZXJDYXNlIiwiZ2wiLCJzdGF0ZSIsImxvYWRlclJlc3VsdCIsInNldFJlbmRlcmVyIiwic2V0UGF0aCIsInRleHR1cmUiLCJfcmVuZGVyVGFyZ2V0IiwicmVuZGVyVGFyZ2V0IiwibWFwcGluZyIsImNvbG9yU3BhY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/useEnvironment.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/core/useGLTF.js":
/*!********************************************************!*\
  !*** ./node_modules/@react-three/drei/core/useGLTF.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useGLTF: () => (/* binding */ useGLTF)\n/* harmony export */ });\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/loaders/DRACOLoader.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/libs/MeshoptDecoder.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/loaders/GLTFLoader.js\");\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n\n\nlet dracoLoader = null;\nlet decoderPath = \"https://www.gstatic.com/draco/versioned/decoders/1.5.5/\";\nfunction extensions(useDraco, useMeshopt, extendLoader) {\n    return (loader)=>{\n        if (extendLoader) {\n            extendLoader(loader);\n        }\n        if (useDraco) {\n            if (!dracoLoader) {\n                dracoLoader = new three_stdlib__WEBPACK_IMPORTED_MODULE_0__.DRACOLoader();\n            }\n            dracoLoader.setDecoderPath(typeof useDraco === \"string\" ? useDraco : decoderPath);\n            loader.setDRACOLoader(dracoLoader);\n        }\n        if (useMeshopt) {\n            loader.setMeshoptDecoder(typeof three_stdlib__WEBPACK_IMPORTED_MODULE_1__.MeshoptDecoder === \"function\" ? (0,three_stdlib__WEBPACK_IMPORTED_MODULE_1__.MeshoptDecoder)() : three_stdlib__WEBPACK_IMPORTED_MODULE_1__.MeshoptDecoder);\n        }\n    };\n}\nfunction useGLTF(path, useDraco = true, useMeshOpt = true, extendLoader) {\n    return (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.F)(three_stdlib__WEBPACK_IMPORTED_MODULE_3__.GLTFLoader, path, extensions(useDraco, useMeshOpt, extendLoader));\n}\nuseGLTF.preload = (path, useDraco = true, useMeshOpt = true, extendLoader)=>_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.F.preload(three_stdlib__WEBPACK_IMPORTED_MODULE_3__.GLTFLoader, path, extensions(useDraco, useMeshOpt, extendLoader));\nuseGLTF.clear = (input)=>_react_three_fiber__WEBPACK_IMPORTED_MODULE_2__.F.clear(three_stdlib__WEBPACK_IMPORTED_MODULE_3__.GLTFLoader, input);\nuseGLTF.setDecoderPath = (path)=>{\n    decoderPath = path;\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS91c2VHTFRGLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXVFO0FBQ3hCO0FBRS9DLElBQUlJLGNBQWM7QUFDbEIsSUFBSUMsY0FBYztBQUNsQixTQUFTQyxXQUFXQyxRQUFRLEVBQUVDLFVBQVUsRUFBRUMsWUFBWTtJQUNwRCxPQUFPQyxDQUFBQTtRQUNMLElBQUlELGNBQWM7WUFDaEJBLGFBQWFDO1FBQ2Y7UUFDQSxJQUFJSCxVQUFVO1lBQ1osSUFBSSxDQUFDSCxhQUFhO2dCQUNoQkEsY0FBYyxJQUFJSCxxREFBV0E7WUFDL0I7WUFDQUcsWUFBWU8sY0FBYyxDQUFDLE9BQU9KLGFBQWEsV0FBV0EsV0FBV0Y7WUFDckVLLE9BQU9FLGNBQWMsQ0FBQ1I7UUFDeEI7UUFDQSxJQUFJSSxZQUFZO1lBQ2RFLE9BQU9HLGlCQUFpQixDQUFDLE9BQU9YLHdEQUFjQSxLQUFLLGFBQWFBLDREQUFjQSxLQUFLQSx3REFBY0E7UUFDbkc7SUFDRjtBQUNGO0FBQ0EsU0FBU1ksUUFBUUMsSUFBSSxFQUFFUixXQUFXLElBQUksRUFBRVMsYUFBYSxJQUFJLEVBQUVQLFlBQVk7SUFDckUsT0FBT04scURBQVNBLENBQUNILG9EQUFVQSxFQUFFZSxNQUFNVCxXQUFXQyxVQUFVUyxZQUFZUDtBQUN0RTtBQUNBSyxRQUFRRyxPQUFPLEdBQUcsQ0FBQ0YsTUFBTVIsV0FBVyxJQUFJLEVBQUVTLGFBQWEsSUFBSSxFQUFFUCxlQUFpQk4saURBQVNBLENBQUNjLE9BQU8sQ0FBQ2pCLG9EQUFVQSxFQUFFZSxNQUFNVCxXQUFXQyxVQUFVUyxZQUFZUDtBQUNuSkssUUFBUUksS0FBSyxHQUFHQyxDQUFBQSxRQUFTaEIsaURBQVNBLENBQUNlLEtBQUssQ0FBQ2xCLG9EQUFVQSxFQUFFbUI7QUFDckRMLFFBQVFILGNBQWMsR0FBR0ksQ0FBQUE7SUFDdkJWLGNBQWNVO0FBQ2hCO0FBRW1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2FuanlvdGktbGVhcm5pbmcvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvY29yZS91c2VHTFRGLmpzPzExMTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR0xURkxvYWRlciwgRFJBQ09Mb2FkZXIsIE1lc2hvcHREZWNvZGVyIH0gZnJvbSAndGhyZWUtc3RkbGliJztcbmltcG9ydCB7IHVzZUxvYWRlciB9IGZyb20gJ0ByZWFjdC10aHJlZS9maWJlcic7XG5cbmxldCBkcmFjb0xvYWRlciA9IG51bGw7XG5sZXQgZGVjb2RlclBhdGggPSAnaHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vZHJhY28vdmVyc2lvbmVkL2RlY29kZXJzLzEuNS41Lyc7XG5mdW5jdGlvbiBleHRlbnNpb25zKHVzZURyYWNvLCB1c2VNZXNob3B0LCBleHRlbmRMb2FkZXIpIHtcbiAgcmV0dXJuIGxvYWRlciA9PiB7XG4gICAgaWYgKGV4dGVuZExvYWRlcikge1xuICAgICAgZXh0ZW5kTG9hZGVyKGxvYWRlcik7XG4gICAgfVxuICAgIGlmICh1c2VEcmFjbykge1xuICAgICAgaWYgKCFkcmFjb0xvYWRlcikge1xuICAgICAgICBkcmFjb0xvYWRlciA9IG5ldyBEUkFDT0xvYWRlcigpO1xuICAgICAgfVxuICAgICAgZHJhY29Mb2FkZXIuc2V0RGVjb2RlclBhdGgodHlwZW9mIHVzZURyYWNvID09PSAnc3RyaW5nJyA/IHVzZURyYWNvIDogZGVjb2RlclBhdGgpO1xuICAgICAgbG9hZGVyLnNldERSQUNPTG9hZGVyKGRyYWNvTG9hZGVyKTtcbiAgICB9XG4gICAgaWYgKHVzZU1lc2hvcHQpIHtcbiAgICAgIGxvYWRlci5zZXRNZXNob3B0RGVjb2Rlcih0eXBlb2YgTWVzaG9wdERlY29kZXIgPT09ICdmdW5jdGlvbicgPyBNZXNob3B0RGVjb2RlcigpIDogTWVzaG9wdERlY29kZXIpO1xuICAgIH1cbiAgfTtcbn1cbmZ1bmN0aW9uIHVzZUdMVEYocGF0aCwgdXNlRHJhY28gPSB0cnVlLCB1c2VNZXNoT3B0ID0gdHJ1ZSwgZXh0ZW5kTG9hZGVyKSB7XG4gIHJldHVybiB1c2VMb2FkZXIoR0xURkxvYWRlciwgcGF0aCwgZXh0ZW5zaW9ucyh1c2VEcmFjbywgdXNlTWVzaE9wdCwgZXh0ZW5kTG9hZGVyKSk7XG59XG51c2VHTFRGLnByZWxvYWQgPSAocGF0aCwgdXNlRHJhY28gPSB0cnVlLCB1c2VNZXNoT3B0ID0gdHJ1ZSwgZXh0ZW5kTG9hZGVyKSA9PiB1c2VMb2FkZXIucHJlbG9hZChHTFRGTG9hZGVyLCBwYXRoLCBleHRlbnNpb25zKHVzZURyYWNvLCB1c2VNZXNoT3B0LCBleHRlbmRMb2FkZXIpKTtcbnVzZUdMVEYuY2xlYXIgPSBpbnB1dCA9PiB1c2VMb2FkZXIuY2xlYXIoR0xURkxvYWRlciwgaW5wdXQpO1xudXNlR0xURi5zZXREZWNvZGVyUGF0aCA9IHBhdGggPT4ge1xuICBkZWNvZGVyUGF0aCA9IHBhdGg7XG59O1xuXG5leHBvcnQgeyB1c2VHTFRGIH07XG4iXSwibmFtZXMiOlsiR0xURkxvYWRlciIsIkRSQUNPTG9hZGVyIiwiTWVzaG9wdERlY29kZXIiLCJ1c2VMb2FkZXIiLCJkcmFjb0xvYWRlciIsImRlY29kZXJQYXRoIiwiZXh0ZW5zaW9ucyIsInVzZURyYWNvIiwidXNlTWVzaG9wdCIsImV4dGVuZExvYWRlciIsImxvYWRlciIsInNldERlY29kZXJQYXRoIiwic2V0RFJBQ09Mb2FkZXIiLCJzZXRNZXNob3B0RGVjb2RlciIsInVzZUdMVEYiLCJwYXRoIiwidXNlTWVzaE9wdCIsInByZWxvYWQiLCJjbGVhciIsImlucHV0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/core/useGLTF.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/helpers/constants.js":
/*!*************************************************************!*\
  !*** ./node_modules/@react-three/drei/helpers/constants.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n\nconst getVersion = ()=>parseInt(three__WEBPACK_IMPORTED_MODULE_0__.REVISION.replace(/\\D+/g, \"\"));\nconst version = /* @__PURE__ */ getVersion();\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvaGVscGVycy9jb25zdGFudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBaUM7QUFFakMsTUFBTUMsYUFBYSxJQUFNQyxTQUFTRiwyQ0FBUUEsQ0FBQ0csT0FBTyxDQUFDLFFBQVE7QUFDM0QsTUFBTUMsVUFBVSxhQUFhLEdBQUVIO0FBRVoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW5qeW90aS1sZWFybmluZy8uL25vZGVfbW9kdWxlcy9AcmVhY3QtdGhyZWUvZHJlaS9oZWxwZXJzL2NvbnN0YW50cy5qcz81MDk0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJFVklTSU9OIH0gZnJvbSAndGhyZWUnO1xuXG5jb25zdCBnZXRWZXJzaW9uID0gKCkgPT4gcGFyc2VJbnQoUkVWSVNJT04ucmVwbGFjZSgvXFxEKy9nLCAnJykpO1xuY29uc3QgdmVyc2lvbiA9IC8qIEBfX1BVUkVfXyAqL2dldFZlcnNpb24oKTtcblxuZXhwb3J0IHsgdmVyc2lvbiB9O1xuIl0sIm5hbWVzIjpbIlJFVklTSU9OIiwiZ2V0VmVyc2lvbiIsInBhcnNlSW50IiwicmVwbGFjZSIsInZlcnNpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/helpers/constants.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/helpers/deprecated.js":
/*!**************************************************************!*\
  !*** ./node_modules/@react-three/drei/helpers/deprecated.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LinearEncoding: () => (/* binding */ LinearEncoding),\n/* harmony export */   sRGBEncoding: () => (/* binding */ sRGBEncoding),\n/* harmony export */   setUpdateRange: () => (/* binding */ setUpdateRange)\n/* harmony export */ });\n/**\n * Sets `BufferAttribute.updateRange` since r159.\n */ const setUpdateRange = (attribute, updateRange)=>{\n    if (\"updateRanges\" in attribute) {\n        // r159\n        // @ts-ignore\n        attribute.updateRanges[0] = updateRange;\n    } else {\n        attribute.updateRange = updateRange;\n    }\n};\nconst LinearEncoding = 3000;\nconst sRGBEncoding = 3001;\n/**\n * TextureEncoding was deprecated in r152, and removed in r162.\n */ \n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvaGVscGVycy9kZXByZWNhdGVkLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOztDQUVDLEdBQ0QsTUFBTUEsaUJBQWlCLENBQUNDLFdBQVdDO0lBQ2pDLElBQUksa0JBQWtCRCxXQUFXO1FBQy9CLE9BQU87UUFDUCxhQUFhO1FBQ2JBLFVBQVVFLFlBQVksQ0FBQyxFQUFFLEdBQUdEO0lBQzlCLE9BQU87UUFDTEQsVUFBVUMsV0FBVyxHQUFHQTtJQUMxQjtBQUNGO0FBQ0EsTUFBTUUsaUJBQWlCO0FBQ3ZCLE1BQU1DLGVBQWU7QUFFckI7O0NBRUMsR0FFdUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW5qeW90aS1sZWFybmluZy8uL25vZGVfbW9kdWxlcy9AcmVhY3QtdGhyZWUvZHJlaS9oZWxwZXJzL2RlcHJlY2F0ZWQuanM/ZTAwOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNldHMgYEJ1ZmZlckF0dHJpYnV0ZS51cGRhdGVSYW5nZWAgc2luY2UgcjE1OS5cbiAqL1xuY29uc3Qgc2V0VXBkYXRlUmFuZ2UgPSAoYXR0cmlidXRlLCB1cGRhdGVSYW5nZSkgPT4ge1xuICBpZiAoJ3VwZGF0ZVJhbmdlcycgaW4gYXR0cmlidXRlKSB7XG4gICAgLy8gcjE1OVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBhdHRyaWJ1dGUudXBkYXRlUmFuZ2VzWzBdID0gdXBkYXRlUmFuZ2U7XG4gIH0gZWxzZSB7XG4gICAgYXR0cmlidXRlLnVwZGF0ZVJhbmdlID0gdXBkYXRlUmFuZ2U7XG4gIH1cbn07XG5jb25zdCBMaW5lYXJFbmNvZGluZyA9IDMwMDA7XG5jb25zdCBzUkdCRW5jb2RpbmcgPSAzMDAxO1xuXG4vKipcbiAqIFRleHR1cmVFbmNvZGluZyB3YXMgZGVwcmVjYXRlZCBpbiByMTUyLCBhbmQgcmVtb3ZlZCBpbiByMTYyLlxuICovXG5cbmV4cG9ydCB7IExpbmVhckVuY29kaW5nLCBzUkdCRW5jb2RpbmcsIHNldFVwZGF0ZVJhbmdlIH07XG4iXSwibmFtZXMiOlsic2V0VXBkYXRlUmFuZ2UiLCJhdHRyaWJ1dGUiLCJ1cGRhdGVSYW5nZSIsInVwZGF0ZVJhbmdlcyIsIkxpbmVhckVuY29kaW5nIiwic1JHQkVuY29kaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/helpers/deprecated.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/helpers/environment-assets.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@react-three/drei/helpers/environment-assets.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   presetsObj: () => (/* binding */ presetsObj)\n/* harmony export */ });\nconst presetsObj = {\n    apartment: \"lebombo_1k.hdr\",\n    city: \"potsdamer_platz_1k.hdr\",\n    dawn: \"kiara_1_dawn_1k.hdr\",\n    forest: \"forest_slope_1k.hdr\",\n    lobby: \"st_fagans_interior_1k.hdr\",\n    night: \"dikhololo_night_1k.hdr\",\n    park: \"rooitou_park_1k.hdr\",\n    studio: \"studio_small_03_1k.hdr\",\n    sunset: \"venice_sunset_1k.hdr\",\n    warehouse: \"empty_warehouse_01_1k.hdr\"\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvaGVscGVycy9lbnZpcm9ubWVudC1hc3NldHMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE1BQU1BLGFBQWE7SUFDakJDLFdBQVc7SUFDWEMsTUFBTTtJQUNOQyxNQUFNO0lBQ05DLFFBQVE7SUFDUkMsT0FBTztJQUNQQyxPQUFPO0lBQ1BDLE1BQU07SUFDTkMsUUFBUTtJQUNSQyxRQUFRO0lBQ1JDLFdBQVc7QUFDYjtBQUVzQiIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9kcmVpL2hlbHBlcnMvZW52aXJvbm1lbnQtYXNzZXRzLmpzPzE2NTEiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcHJlc2V0c09iaiA9IHtcbiAgYXBhcnRtZW50OiAnbGVib21ib18xay5oZHInLFxuICBjaXR5OiAncG90c2RhbWVyX3BsYXR6XzFrLmhkcicsXG4gIGRhd246ICdraWFyYV8xX2Rhd25fMWsuaGRyJyxcbiAgZm9yZXN0OiAnZm9yZXN0X3Nsb3BlXzFrLmhkcicsXG4gIGxvYmJ5OiAnc3RfZmFnYW5zX2ludGVyaW9yXzFrLmhkcicsXG4gIG5pZ2h0OiAnZGlraG9sb2xvX25pZ2h0XzFrLmhkcicsXG4gIHBhcms6ICdyb29pdG91X3BhcmtfMWsuaGRyJyxcbiAgc3R1ZGlvOiAnc3R1ZGlvX3NtYWxsXzAzXzFrLmhkcicsXG4gIHN1bnNldDogJ3ZlbmljZV9zdW5zZXRfMWsuaGRyJyxcbiAgd2FyZWhvdXNlOiAnZW1wdHlfd2FyZWhvdXNlXzAxXzFrLmhkcidcbn07XG5cbmV4cG9ydCB7IHByZXNldHNPYmogfTtcbiJdLCJuYW1lcyI6WyJwcmVzZXRzT2JqIiwiYXBhcnRtZW50IiwiY2l0eSIsImRhd24iLCJmb3Jlc3QiLCJsb2JieSIsIm5pZ2h0IiwicGFyayIsInN0dWRpbyIsInN1bnNldCIsIndhcmVob3VzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/helpers/environment-assets.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/drei/materials/DiscardMaterial.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@react-three/drei/materials/DiscardMaterial.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DiscardMaterial: () => (/* binding */ DiscardMaterial)\n/* harmony export */ });\n/* harmony import */ var _core_shaderMaterial_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/shaderMaterial.js */ \"(ssr)/./node_modules/@react-three/drei/core/shaderMaterial.js\");\n\nconst DiscardMaterial = /* @__PURE__ */ (0,_core_shaderMaterial_js__WEBPACK_IMPORTED_MODULE_0__.shaderMaterial)({}, \"void main() { }\", \"void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }\");\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvbWF0ZXJpYWxzL0Rpc2NhcmRNYXRlcmlhbC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUEyRDtBQUUzRCxNQUFNQyxrQkFBa0IsYUFBYSxHQUFFRCx1RUFBY0EsQ0FBQyxDQUFDLEdBQUcsbUJBQW1CO0FBRWxEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2FuanlvdGktbGVhcm5pbmcvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2RyZWkvbWF0ZXJpYWxzL0Rpc2NhcmRNYXRlcmlhbC5qcz8xMzVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNoYWRlck1hdGVyaWFsIH0gZnJvbSAnLi4vY29yZS9zaGFkZXJNYXRlcmlhbC5qcyc7XG5cbmNvbnN0IERpc2NhcmRNYXRlcmlhbCA9IC8qIEBfX1BVUkVfXyAqL3NoYWRlck1hdGVyaWFsKHt9LCAndm9pZCBtYWluKCkgeyB9JywgJ3ZvaWQgbWFpbigpIHsgZ2xfRnJhZ0NvbG9yID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAwLjApOyBkaXNjYXJkOyAgfScpO1xuXG5leHBvcnQgeyBEaXNjYXJkTWF0ZXJpYWwgfTtcbiJdLCJuYW1lcyI6WyJzaGFkZXJNYXRlcmlhbCIsIkRpc2NhcmRNYXRlcmlhbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/drei/materials/DiscardMaterial.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js":
/*!********************************************************************!*\
  !*** ./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: () => (/* binding */ useThree),\n/* harmony export */   B: () => (/* binding */ Block),\n/* harmony export */   C: () => (/* binding */ useFrame),\n/* harmony export */   D: () => (/* binding */ useGraph),\n/* harmony export */   E: () => (/* binding */ ErrorBoundary),\n/* harmony export */   F: () => (/* binding */ useLoader),\n/* harmony export */   a: () => (/* binding */ useIsomorphicLayoutEffect),\n/* harmony export */   b: () => (/* binding */ createRoot),\n/* harmony export */   c: () => (/* binding */ createEvents),\n/* harmony export */   d: () => (/* binding */ unmountComponentAtNode),\n/* harmony export */   e: () => (/* binding */ extend),\n/* harmony export */   f: () => (/* binding */ context),\n/* harmony export */   g: () => (/* binding */ createPortal),\n/* harmony export */   h: () => (/* binding */ reconciler),\n/* harmony export */   i: () => (/* binding */ isRef),\n/* harmony export */   j: () => (/* binding */ applyProps),\n/* harmony export */   k: () => (/* binding */ dispose),\n/* harmony export */   l: () => (/* binding */ invalidate),\n/* harmony export */   m: () => (/* binding */ advance),\n/* harmony export */   n: () => (/* binding */ addEffect),\n/* harmony export */   o: () => (/* binding */ addAfterEffect),\n/* harmony export */   p: () => (/* binding */ addTail),\n/* harmony export */   q: () => (/* binding */ flushGlobalEffects),\n/* harmony export */   r: () => (/* binding */ render),\n/* harmony export */   s: () => (/* binding */ getRootState),\n/* harmony export */   t: () => (/* binding */ threeTypes),\n/* harmony export */   u: () => (/* binding */ useMutableCallback),\n/* harmony export */   v: () => (/* binding */ act),\n/* harmony export */   w: () => (/* binding */ buildGraph),\n/* harmony export */   x: () => (/* binding */ roots),\n/* harmony export */   y: () => (/* binding */ useInstanceHandle),\n/* harmony export */   z: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-reconciler/constants */ \"(ssr)/./node_modules/react-reconciler/constants.js\");\n/* harmony import */ var zustand__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zustand */ \"(ssr)/./node_modules/@react-three/fiber/node_modules/zustand/esm/index.js\");\n/* harmony import */ var react_reconciler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-reconciler */ \"(ssr)/./node_modules/react-reconciler/index.js\");\n/* harmony import */ var react_reconciler__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_reconciler__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var scheduler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! scheduler */ \"(ssr)/./node_modules/scheduler/index.js\");\n/* harmony import */ var suspend_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! suspend-react */ \"(ssr)/./node_modules/suspend-react/index.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n\n\n\n\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\n\nconst catalogue = {};\nconst extend = objects => void Object.assign(catalogue, objects);\nfunction createRenderer(_roots, _getEventPriority) {\n  function createInstance(type, {\n    args = [],\n    attach,\n    ...props\n  }, root) {\n    let name = `${type[0].toUpperCase()}${type.slice(1)}`;\n    let instance;\n    if (type === 'primitive') {\n      if (props.object === undefined) throw new Error(\"R3F: Primitives without 'object' are invalid!\");\n      const object = props.object;\n      instance = prepare(object, {\n        type,\n        root,\n        attach,\n        primitive: true\n      });\n    } else {\n      const target = catalogue[name];\n      if (!target) {\n        throw new Error(`R3F: ${name} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);\n      }\n\n      // Throw if an object or literal was passed for args\n      if (!Array.isArray(args)) throw new Error('R3F: The args prop must be an array!');\n\n      // Instanciate new object, link it to the root\n      // Append memoized props with args so it's not forgotten\n      instance = prepare(new target(...args), {\n        type,\n        root,\n        attach,\n        // Save args in case we need to reconstruct later for HMR\n        memoizedProps: {\n          args\n        }\n      });\n    }\n\n    // Auto-attach geometries and materials\n    if (instance.__r3f.attach === undefined) {\n      if (instance instanceof three__WEBPACK_IMPORTED_MODULE_5__.BufferGeometry) instance.__r3f.attach = 'geometry';else if (instance instanceof three__WEBPACK_IMPORTED_MODULE_5__.Material) instance.__r3f.attach = 'material';\n    }\n\n    // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n    // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n    // why it passes \"true\" here\n    // There is no reason to apply props to injects\n    if (name !== 'inject') applyProps$1(instance, props);\n    return instance;\n  }\n  function appendChild(parentInstance, child) {\n    let added = false;\n    if (child) {\n      var _child$__r3f, _parentInstance$__r3f;\n      // The attach attribute implies that the object attaches itself on the parent\n      if ((_child$__r3f = child.__r3f) != null && _child$__r3f.attach) {\n        attach(parentInstance, child, child.__r3f.attach);\n      } else if (child.isObject3D && parentInstance.isObject3D) {\n        // add in the usual parent-child way\n        parentInstance.add(child);\n        added = true;\n      }\n      // This is for anything that used attach, and for non-Object3Ds that don't get attached to props;\n      // that is, anything that's a child in React but not a child in the scenegraph.\n      if (!added) (_parentInstance$__r3f = parentInstance.__r3f) == null ? void 0 : _parentInstance$__r3f.objects.push(child);\n      if (!child.__r3f) prepare(child, {});\n      child.__r3f.parent = parentInstance;\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n  function insertBefore(parentInstance, child, beforeChild) {\n    let added = false;\n    if (child) {\n      var _child$__r3f2, _parentInstance$__r3f2;\n      if ((_child$__r3f2 = child.__r3f) != null && _child$__r3f2.attach) {\n        attach(parentInstance, child, child.__r3f.attach);\n      } else if (child.isObject3D && parentInstance.isObject3D) {\n        child.parent = parentInstance;\n        child.dispatchEvent({\n          type: 'added'\n        });\n        parentInstance.dispatchEvent({\n          type: 'childadded',\n          child\n        });\n        const restSiblings = parentInstance.children.filter(sibling => sibling !== child);\n        const index = restSiblings.indexOf(beforeChild);\n        parentInstance.children = [...restSiblings.slice(0, index), child, ...restSiblings.slice(index)];\n        added = true;\n      }\n      if (!added) (_parentInstance$__r3f2 = parentInstance.__r3f) == null ? void 0 : _parentInstance$__r3f2.objects.push(child);\n      if (!child.__r3f) prepare(child, {});\n      child.__r3f.parent = parentInstance;\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n  function removeRecursive(array, parent, dispose = false) {\n    if (array) [...array].forEach(child => removeChild(parent, child, dispose));\n  }\n  function removeChild(parentInstance, child, dispose) {\n    if (child) {\n      var _parentInstance$__r3f3, _child$__r3f3, _child$__r3f5;\n      // Clear the parent reference\n      if (child.__r3f) child.__r3f.parent = null;\n      // Remove child from the parents objects\n      if ((_parentInstance$__r3f3 = parentInstance.__r3f) != null && _parentInstance$__r3f3.objects) parentInstance.__r3f.objects = parentInstance.__r3f.objects.filter(x => x !== child);\n      // Remove attachment\n      if ((_child$__r3f3 = child.__r3f) != null && _child$__r3f3.attach) {\n        detach(parentInstance, child, child.__r3f.attach);\n      } else if (child.isObject3D && parentInstance.isObject3D) {\n        var _child$__r3f4;\n        parentInstance.remove(child);\n        // @ts-expect-error\n        // Remove interactivity on the initial root\n        if ((_child$__r3f4 = child.__r3f) != null && _child$__r3f4.root) {\n          removeInteractivity(findInitialRoot(child), child);\n        }\n      }\n\n      // Allow objects to bail out of recursive dispose altogether by passing dispose={null}\n      // Never dispose of primitives because their state may be kept outside of React!\n      // In order for an object to be able to dispose it has to have\n      //   - a dispose method,\n      //   - it cannot be a <primitive object={...} />\n      //   - it cannot be a THREE.Scene, because three has broken it's own api\n      //\n      // Since disposal is recursive, we can check the optional dispose arg, which will be undefined\n      // when the reconciler calls it, but then carry our own check recursively\n      const isPrimitive = (_child$__r3f5 = child.__r3f) == null ? void 0 : _child$__r3f5.primitive;\n      const shouldDispose = !isPrimitive && (dispose === undefined ? child.dispose !== null : dispose);\n\n      // Remove nested child objects. Primitives should not have objects and children that are\n      // attached to them declaratively ...\n      if (!isPrimitive) {\n        var _child$__r3f6;\n        removeRecursive((_child$__r3f6 = child.__r3f) == null ? void 0 : _child$__r3f6.objects, child, shouldDispose);\n        removeRecursive(child.children, child, shouldDispose);\n      }\n\n      // Remove references\n      delete child.__r3f;\n\n      // Dispose item whenever the reconciler feels like it\n      if (shouldDispose && child.dispose && child.type !== 'Scene') {\n        const callback = () => {\n          try {\n            child.dispose();\n          } catch (e) {\n            /* ... */\n          }\n        };\n\n        // Schedule async at runtime, flush sync in testing\n        if (typeof IS_REACT_ACT_ENVIRONMENT === 'undefined') {\n          (0,scheduler__WEBPACK_IMPORTED_MODULE_3__.unstable_scheduleCallback)(scheduler__WEBPACK_IMPORTED_MODULE_3__.unstable_IdlePriority, callback);\n        } else {\n          callback();\n        }\n      }\n      invalidateInstance(parentInstance);\n    }\n  }\n  function switchInstance(instance, type, newProps, fiber) {\n    var _instance$__r3f;\n    const parent = (_instance$__r3f = instance.__r3f) == null ? void 0 : _instance$__r3f.parent;\n    if (!parent) return;\n    const newInstance = createInstance(type, newProps, instance.__r3f.root);\n\n    // https://github.com/pmndrs/react-three-fiber/issues/1348\n    // When args change the instance has to be re-constructed, which then\n    // forces r3f to re-parent the children and non-scene objects\n    if (instance.children) {\n      for (const child of instance.children) {\n        if (child.__r3f) appendChild(newInstance, child);\n      }\n      instance.children = instance.children.filter(child => !child.__r3f);\n    }\n    instance.__r3f.objects.forEach(child => appendChild(newInstance, child));\n    instance.__r3f.objects = [];\n    if (!instance.__r3f.autoRemovedBeforeAppend) {\n      removeChild(parent, instance);\n    }\n    if (newInstance.parent) {\n      newInstance.__r3f.autoRemovedBeforeAppend = true;\n    }\n    appendChild(parent, newInstance);\n\n    // Re-bind event handlers on the initial root\n    if (newInstance.raycast && newInstance.__r3f.eventCount) {\n      const rootState = findInitialRoot(newInstance).getState();\n      rootState.internal.interaction.push(newInstance);\n    }\n    [fiber, fiber.alternate].forEach(fiber => {\n      if (fiber !== null) {\n        fiber.stateNode = newInstance;\n        if (fiber.ref) {\n          if (typeof fiber.ref === 'function') fiber.ref(newInstance);else fiber.ref.current = newInstance;\n        }\n      }\n    });\n  }\n\n  // Don't handle text instances, warn on undefined behavior\n  const handleTextInstance = () => console.warn('Text is not allowed in the R3F tree! This could be stray whitespace or characters.');\n  const reconciler = react_reconciler__WEBPACK_IMPORTED_MODULE_2___default()({\n    createInstance,\n    removeChild,\n    appendChild,\n    appendInitialChild: appendChild,\n    insertBefore,\n    supportsMutation: true,\n    isPrimaryRenderer: false,\n    supportsPersistence: false,\n    supportsHydration: false,\n    noTimeout: -1,\n    appendChildToContainer: (container, child) => {\n      if (!child) return;\n\n      // Don't append to unmounted container\n      const scene = container.getState().scene;\n      if (!scene.__r3f) return;\n\n      // Link current root to the default scene\n      scene.__r3f.root = container;\n      appendChild(scene, child);\n    },\n    removeChildFromContainer: (container, child) => {\n      if (!child) return;\n      removeChild(container.getState().scene, child);\n    },\n    insertInContainerBefore: (container, child, beforeChild) => {\n      if (!child || !beforeChild) return;\n\n      // Don't append to unmounted container\n      const scene = container.getState().scene;\n      if (!scene.__r3f) return;\n      insertBefore(scene, child, beforeChild);\n    },\n    getRootHostContext: () => null,\n    getChildHostContext: parentHostContext => parentHostContext,\n    finalizeInitialChildren(instance) {\n      var _instance$__r3f2;\n      const localState = (_instance$__r3f2 = instance == null ? void 0 : instance.__r3f) != null ? _instance$__r3f2 : {};\n      // https://github.com/facebook/react/issues/20271\n      // Returning true will trigger commitMount\n      return Boolean(localState.handlers);\n    },\n    prepareUpdate(instance, _type, oldProps, newProps) {\n      var _instance$__r3f3;\n      const localState = (_instance$__r3f3 = instance == null ? void 0 : instance.__r3f) != null ? _instance$__r3f3 : {};\n\n      // Create diff-sets\n      if (localState.primitive && newProps.object && newProps.object !== instance) {\n        return [true];\n      } else {\n        // This is a data object, let's extract critical information about it\n        const {\n          args: argsNew = [],\n          children: cN,\n          ...restNew\n        } = newProps;\n        const {\n          args: argsOld = [],\n          children: cO,\n          ...restOld\n        } = oldProps;\n\n        // Throw if an object or literal was passed for args\n        if (!Array.isArray(argsNew)) throw new Error('R3F: the args prop must be an array!');\n\n        // If it has new props or arguments, then it needs to be re-instantiated\n        if (argsNew.some((value, index) => value !== argsOld[index])) return [true];\n        // Create a diff-set, flag if there are any changes\n        const diff = diffProps(instance, restNew, restOld, true);\n        if (diff.changes.length) return [false, diff];\n\n        // Otherwise do not touch the instance\n        return null;\n      }\n    },\n    commitUpdate(instance, [reconstruct, diff], type, _oldProps, newProps, fiber) {\n      // Reconstruct when args or <primitive object={...} have changes\n      if (reconstruct) switchInstance(instance, type, newProps, fiber);\n      // Otherwise just overwrite props\n      else applyProps$1(instance, diff);\n    },\n    commitMount(instance, _type, _props, _int) {\n      var _instance$__r3f4;\n      // https://github.com/facebook/react/issues/20271\n      // This will make sure events are only added once to the central container on the initial root\n      const localState = (_instance$__r3f4 = instance.__r3f) != null ? _instance$__r3f4 : {};\n      if (instance.raycast && localState.handlers && localState.eventCount) {\n        findInitialRoot(instance).getState().internal.interaction.push(instance);\n      }\n    },\n    getPublicInstance: instance => instance,\n    prepareForCommit: () => null,\n    preparePortalMount: container => prepare(container.getState().scene),\n    resetAfterCommit: () => {},\n    shouldSetTextContent: () => false,\n    clearContainer: () => false,\n    hideInstance(instance) {\n      var _instance$__r3f5;\n      // Detach while the instance is hidden\n      const {\n        attach: type,\n        parent\n      } = (_instance$__r3f5 = instance.__r3f) != null ? _instance$__r3f5 : {};\n      if (type && parent) detach(parent, instance, type);\n      if (instance.isObject3D) instance.visible = false;\n      invalidateInstance(instance);\n    },\n    unhideInstance(instance, props) {\n      var _instance$__r3f6;\n      // Re-attach when the instance is unhidden\n      const {\n        attach: type,\n        parent\n      } = (_instance$__r3f6 = instance.__r3f) != null ? _instance$__r3f6 : {};\n      if (type && parent) attach(parent, instance, type);\n      if (instance.isObject3D && props.visible == null || props.visible) instance.visible = true;\n      invalidateInstance(instance);\n    },\n    createTextInstance: handleTextInstance,\n    hideTextInstance: handleTextInstance,\n    unhideTextInstance: handleTextInstance,\n    // https://github.com/pmndrs/react-three-fiber/pull/2360#discussion_r916356874\n    // @ts-expect-error\n    getCurrentEventPriority: () => _getEventPriority ? _getEventPriority() : react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__.DefaultEventPriority,\n    beforeActiveInstanceBlur: () => {},\n    afterActiveInstanceBlur: () => {},\n    detachDeletedInstance: () => {},\n    now: typeof performance !== 'undefined' && is.fun(performance.now) ? performance.now : is.fun(Date.now) ? Date.now : () => 0,\n    // https://github.com/pmndrs/react-three-fiber/pull/2360#discussion_r920883503\n    scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined\n  });\n  return {\n    reconciler,\n    applyProps: applyProps$1\n  };\n}\n\nvar _window$document, _window$navigator;\n/**\r\n * Returns `true` with correct TS type inference if an object has a configurable color space (since r152).\r\n */\nconst hasColorSpace = object => 'colorSpace' in object || 'outputColorSpace' in object;\n/**\r\n * The current THREE.ColorManagement instance, if present.\r\n */\nconst getColorManagement = () => {\n  var _ColorManagement;\n  return (_ColorManagement = catalogue.ColorManagement) != null ? _ColorManagement : null;\n};\nconst isOrthographicCamera = def => def && def.isOrthographicCamera;\nconst isRef = obj => obj && obj.hasOwnProperty('current');\n\n/**\r\n * An SSR-friendly useLayoutEffect.\r\n *\r\n * React currently throws a warning when using useLayoutEffect on the server.\r\n * To get around it, we can conditionally useEffect on the server (no-op) and\r\n * useLayoutEffect elsewhere.\r\n *\r\n * @see https://github.com/facebook/react/issues/14927\r\n */\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' && ((_window$document = window.document) != null && _window$document.createElement || ((_window$navigator = window.navigator) == null ? void 0 : _window$navigator.product) === 'ReactNative') ? react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect : react__WEBPACK_IMPORTED_MODULE_0__.useEffect;\nfunction useMutableCallback(fn) {\n  const ref = react__WEBPACK_IMPORTED_MODULE_0__.useRef(fn);\n  useIsomorphicLayoutEffect(() => void (ref.current = fn), [fn]);\n  return ref;\n}\nfunction Block({\n  set\n}) {\n  useIsomorphicLayoutEffect(() => {\n    set(new Promise(() => null));\n    return () => set(false);\n  }, [set]);\n  return null;\n}\nclass ErrorBoundary extends react__WEBPACK_IMPORTED_MODULE_0__.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      error: false\n    };\n  }\n  componentDidCatch(err) {\n    this.props.set(err);\n  }\n  render() {\n    return this.state.error ? null : this.props.children;\n  }\n}\nErrorBoundary.getDerivedStateFromError = () => ({\n  error: true\n});\nconst DEFAULT = '__default';\nconst DEFAULTS = new Map();\nconst isDiffSet = def => def && !!def.memoized && !!def.changes;\nfunction calculateDpr(dpr) {\n  var _window$devicePixelRa;\n  // Err on the side of progress by assuming 2x dpr if we can't detect it\n  // This will happen in workers where window is defined but dpr isn't.\n  const target = typeof window !== 'undefined' ? (_window$devicePixelRa = window.devicePixelRatio) != null ? _window$devicePixelRa : 2 : 1;\n  return Array.isArray(dpr) ? Math.min(Math.max(dpr[0], target), dpr[1]) : dpr;\n}\n\n/**\r\n * Returns instance root state\r\n */\nconst getRootState = obj => {\n  var _r3f;\n  return (_r3f = obj.__r3f) == null ? void 0 : _r3f.root.getState();\n};\n\n/**\r\n * Returns the instances initial (outmost) root\r\n */\nfunction findInitialRoot(child) {\n  let root = child.__r3f.root;\n  while (root.getState().previousRoot) root = root.getState().previousRoot;\n  return root;\n}\n// A collection of compare functions\nconst is = {\n  obj: a => a === Object(a) && !is.arr(a) && typeof a !== 'function',\n  fun: a => typeof a === 'function',\n  str: a => typeof a === 'string',\n  num: a => typeof a === 'number',\n  boo: a => typeof a === 'boolean',\n  und: a => a === void 0,\n  arr: a => Array.isArray(a),\n  equ(a, b, {\n    arrays = 'shallow',\n    objects = 'reference',\n    strict = true\n  } = {}) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false;\n    // Atomic, just compare a against b\n    if (is.str(a) || is.num(a)) return a === b;\n    const isObj = is.obj(a);\n    if (isObj && objects === 'reference') return a === b;\n    const isArr = is.arr(a);\n    if (isArr && arrays === 'reference') return a === b;\n    // Array or Object, shallow compare first to see if it's a match\n    if ((isArr || isObj) && a === b) return true;\n    // Last resort, go through keys\n    let i;\n    // Check if a has all the keys of b\n    for (i in a) if (!(i in b)) return false;\n    // Check if values between keys match\n    if (isObj && arrays === 'shallow' && objects === 'shallow') {\n      for (i in strict ? b : a) if (!is.equ(a[i], b[i], {\n        strict,\n        objects: 'reference'\n      })) return false;\n    } else {\n      for (i in strict ? b : a) if (a[i] !== b[i]) return false;\n    }\n    // If i is undefined\n    if (is.und(i)) {\n      // If both arrays are empty we consider them equal\n      if (isArr && a.length === 0 && b.length === 0) return true;\n      // If both objects are empty we consider them equal\n      if (isObj && Object.keys(a).length === 0 && Object.keys(b).length === 0) return true;\n      // Otherwise match them by value\n      if (a !== b) return false;\n    }\n    return true;\n  }\n};\n\n/**\r\n * Collects nodes and materials from a THREE.Object3D.\r\n */\nfunction buildGraph(object) {\n  const data = {\n    nodes: {},\n    materials: {}\n  };\n  if (object) {\n    object.traverse(obj => {\n      if (obj.name) data.nodes[obj.name] = obj;\n      if (obj.material && !data.materials[obj.material.name]) data.materials[obj.material.name] = obj.material;\n    });\n  }\n  return data;\n}\n\n// Disposes an object and all its properties\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n  for (const p in obj) {\n    p.dispose == null ? void 0 : p.dispose();\n    delete obj[p];\n  }\n}\n\n// Each object in the scene carries a small LocalState descriptor\nfunction prepare(object, state) {\n  const instance = object;\n  instance.__r3f = {\n    type: '',\n    root: null,\n    previousAttach: null,\n    memoizedProps: {},\n    eventCount: 0,\n    handlers: {},\n    objects: [],\n    parent: null,\n    ...state\n  };\n  return object;\n}\nfunction resolve(instance, key) {\n  let target = instance;\n  if (key.includes('-')) {\n    const entries = key.split('-');\n    const last = entries.pop();\n    target = entries.reduce((acc, key) => acc[key], instance);\n    return {\n      target,\n      key: last\n    };\n  } else return {\n    target,\n    key\n  };\n}\n\n// Checks if a dash-cased string ends with an integer\nconst INDEX_REGEX = /-\\d+$/;\nfunction attach(parent, child, type) {\n  if (is.str(type)) {\n    // If attaching into an array (foo-0), create one\n    if (INDEX_REGEX.test(type)) {\n      const root = type.replace(INDEX_REGEX, '');\n      const {\n        target,\n        key\n      } = resolve(parent, root);\n      if (!Array.isArray(target[key])) target[key] = [];\n    }\n    const {\n      target,\n      key\n    } = resolve(parent, type);\n    child.__r3f.previousAttach = target[key];\n    target[key] = child;\n  } else child.__r3f.previousAttach = type(parent, child);\n}\nfunction detach(parent, child, type) {\n  var _child$__r3f, _child$__r3f2;\n  if (is.str(type)) {\n    const {\n      target,\n      key\n    } = resolve(parent, type);\n    const previous = child.__r3f.previousAttach;\n    // When the previous value was undefined, it means the value was never set to begin with\n    if (previous === undefined) delete target[key];\n    // Otherwise set the previous value\n    else target[key] = previous;\n  } else (_child$__r3f = child.__r3f) == null ? void 0 : _child$__r3f.previousAttach == null ? void 0 : _child$__r3f.previousAttach(parent, child);\n  (_child$__r3f2 = child.__r3f) == null ? true : delete _child$__r3f2.previousAttach;\n}\n// This function prepares a set of changes to be applied to the instance\nfunction diffProps(instance, {\n  children: cN,\n  key: kN,\n  ref: rN,\n  ...props\n}, {\n  children: cP,\n  key: kP,\n  ref: rP,\n  ...previous\n} = {}, remove = false) {\n  const localState = instance.__r3f;\n  const entries = Object.entries(props);\n  const changes = [];\n\n  // Catch removed props, prepend them so they can be reset or removed\n  if (remove) {\n    const previousKeys = Object.keys(previous);\n    for (let i = 0; i < previousKeys.length; i++) {\n      if (!props.hasOwnProperty(previousKeys[i])) entries.unshift([previousKeys[i], DEFAULT + 'remove']);\n    }\n  }\n  entries.forEach(([key, value]) => {\n    var _instance$__r3f;\n    // Bail out on primitive object\n    if ((_instance$__r3f = instance.__r3f) != null && _instance$__r3f.primitive && key === 'object') return;\n    // When props match bail out\n    if (is.equ(value, previous[key])) return;\n    // Collect handlers and bail out\n    if (/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(key)) return changes.push([key, value, true, []]);\n    // Split dashed props\n    let entries = [];\n    if (key.includes('-')) entries = key.split('-');\n    changes.push([key, value, false, entries]);\n\n    // Reset pierced props\n    for (const prop in props) {\n      const value = props[prop];\n      if (prop.startsWith(`${key}-`)) changes.push([prop, value, false, prop.split('-')]);\n    }\n  });\n  const memoized = {\n    ...props\n  };\n  if (localState != null && localState.memoizedProps && localState != null && localState.memoizedProps.args) memoized.args = localState.memoizedProps.args;\n  if (localState != null && localState.memoizedProps && localState != null && localState.memoizedProps.attach) memoized.attach = localState.memoizedProps.attach;\n  return {\n    memoized,\n    changes\n  };\n}\nconst __DEV__ = typeof process !== 'undefined' && \"development\" !== 'production';\n\n// This function applies a set of changes to the instance\nfunction applyProps$1(instance, data) {\n  var _instance$__r3f2;\n  // Filter equals, events and reserved props\n  const localState = instance.__r3f;\n  const root = localState == null ? void 0 : localState.root;\n  const rootState = root == null ? void 0 : root.getState == null ? void 0 : root.getState();\n  const {\n    memoized,\n    changes\n  } = isDiffSet(data) ? data : diffProps(instance, data);\n  const prevHandlers = localState == null ? void 0 : localState.eventCount;\n\n  // Prepare memoized props\n  if (instance.__r3f) instance.__r3f.memoizedProps = memoized;\n  for (let i = 0; i < changes.length; i++) {\n    let [key, value, isEvent, keys] = changes[i];\n\n    // Alias (output)encoding => (output)colorSpace (since r152)\n    // https://github.com/pmndrs/react-three-fiber/pull/2829\n    if (hasColorSpace(instance)) {\n      const sRGBEncoding = 3001;\n      const SRGBColorSpace = 'srgb';\n      const LinearSRGBColorSpace = 'srgb-linear';\n      if (key === 'encoding') {\n        key = 'colorSpace';\n        value = value === sRGBEncoding ? SRGBColorSpace : LinearSRGBColorSpace;\n      } else if (key === 'outputEncoding') {\n        key = 'outputColorSpace';\n        value = value === sRGBEncoding ? SRGBColorSpace : LinearSRGBColorSpace;\n      }\n    }\n    let currentInstance = instance;\n    let targetProp = currentInstance[key];\n\n    // Revolve dashed props\n    if (keys.length) {\n      targetProp = keys.reduce((acc, key) => acc[key], instance);\n      // If the target is atomic, it forces us to switch the root\n      if (!(targetProp && targetProp.set)) {\n        const [name, ...reverseEntries] = keys.reverse();\n        currentInstance = reverseEntries.reverse().reduce((acc, key) => acc[key], instance);\n        key = name;\n      }\n    }\n\n    // https://github.com/mrdoob/three.js/issues/21209\n    // HMR/fast-refresh relies on the ability to cancel out props, but threejs\n    // has no means to do this. Hence we curate a small collection of value-classes\n    // with their respective constructor/set arguments\n    // For removed props, try to set default values, if possible\n    if (value === DEFAULT + 'remove') {\n      if (currentInstance.constructor) {\n        // create a blank slate of the instance and copy the particular parameter.\n        let ctor = DEFAULTS.get(currentInstance.constructor);\n        if (!ctor) {\n          // @ts-expect-error\n          ctor = new currentInstance.constructor();\n          DEFAULTS.set(currentInstance.constructor, ctor);\n        }\n        value = ctor[key];\n      } else {\n        // instance does not have constructor, just set it to 0\n        value = 0;\n      }\n    }\n\n    // Deal with pointer events ...\n    if (isEvent && localState) {\n      if (value) localState.handlers[key] = value;else delete localState.handlers[key];\n      localState.eventCount = Object.keys(localState.handlers).length;\n    }\n    // Special treatment for objects with support for set/copy, and layers\n    else if (targetProp && targetProp.set && (targetProp.copy || targetProp instanceof three__WEBPACK_IMPORTED_MODULE_5__.Layers)) {\n      // If value is an array\n      if (Array.isArray(value)) {\n        if (targetProp.fromArray) targetProp.fromArray(value);else targetProp.set(...value);\n      }\n      // Test again target.copy(class) next ...\n      else if (targetProp.copy && value && value.constructor && (\n      // Some environments may break strict identity checks by duplicating versions of three.js.\n      // Loosen to unminified names, ignoring descendents.\n      // https://github.com/pmndrs/react-three-fiber/issues/2856\n      // TODO: fix upstream and remove in v9\n      __DEV__ ? targetProp.constructor.name === value.constructor.name : targetProp.constructor === value.constructor)) {\n        targetProp.copy(value);\n      }\n      // If nothing else fits, just set the single value, ignore undefined\n      // https://github.com/pmndrs/react-three-fiber/issues/274\n      else if (value !== undefined) {\n        const isColor = targetProp instanceof three__WEBPACK_IMPORTED_MODULE_5__.Color;\n        // Allow setting array scalars\n        if (!isColor && targetProp.setScalar) targetProp.setScalar(value);\n        // Layers have no copy function, we must therefore copy the mask property\n        else if (targetProp instanceof three__WEBPACK_IMPORTED_MODULE_5__.Layers && value instanceof three__WEBPACK_IMPORTED_MODULE_5__.Layers) targetProp.mask = value.mask;\n        // Otherwise just set ...\n        else targetProp.set(value);\n        // For versions of three which don't support THREE.ColorManagement,\n        // Auto-convert sRGB colors\n        // https://github.com/pmndrs/react-three-fiber/issues/344\n        if (!getColorManagement() && rootState && !rootState.linear && isColor) targetProp.convertSRGBToLinear();\n      }\n      // Else, just overwrite the value\n    } else {\n      currentInstance[key] = value;\n\n      // Auto-convert sRGB textures, for now ...\n      // https://github.com/pmndrs/react-three-fiber/issues/344\n      if (currentInstance[key] instanceof three__WEBPACK_IMPORTED_MODULE_5__.Texture &&\n      // sRGB textures must be RGBA8 since r137 https://github.com/mrdoob/three.js/pull/23129\n      currentInstance[key].format === three__WEBPACK_IMPORTED_MODULE_5__.RGBAFormat && currentInstance[key].type === three__WEBPACK_IMPORTED_MODULE_5__.UnsignedByteType && rootState) {\n        const texture = currentInstance[key];\n        if (hasColorSpace(texture) && hasColorSpace(rootState.gl)) texture.colorSpace = rootState.gl.outputColorSpace;else texture.encoding = rootState.gl.outputEncoding;\n      }\n    }\n    invalidateInstance(instance);\n  }\n  if (localState && localState.parent && instance.raycast && prevHandlers !== localState.eventCount) {\n    // Get the initial root state's internals\n    const internal = findInitialRoot(instance).getState().internal;\n    // Pre-emptively remove the instance from the interaction manager\n    const index = internal.interaction.indexOf(instance);\n    if (index > -1) internal.interaction.splice(index, 1);\n    // Add the instance to the interaction manager only when it has handlers\n    if (localState.eventCount) internal.interaction.push(instance);\n  }\n\n  // Call the update lifecycle when it is being updated, but only when it is part of the scene.\n  // Skip updates to the `onUpdate` prop itself\n  const isCircular = changes.length === 1 && changes[0][0] === 'onUpdate';\n  if (!isCircular && changes.length && (_instance$__r3f2 = instance.__r3f) != null && _instance$__r3f2.parent) updateInstance(instance);\n  return instance;\n}\nfunction invalidateInstance(instance) {\n  var _instance$__r3f3, _instance$__r3f3$root;\n  const state = (_instance$__r3f3 = instance.__r3f) == null ? void 0 : (_instance$__r3f3$root = _instance$__r3f3.root) == null ? void 0 : _instance$__r3f3$root.getState == null ? void 0 : _instance$__r3f3$root.getState();\n  if (state && state.internal.frames === 0) state.invalidate();\n}\nfunction updateInstance(instance) {\n  instance.onUpdate == null ? void 0 : instance.onUpdate(instance);\n}\nfunction updateCamera(camera, size) {\n  // https://github.com/pmndrs/react-three-fiber/issues/92\n  // Do not mess with the camera if it belongs to the user\n  if (!camera.manual) {\n    if (isOrthographicCamera(camera)) {\n      camera.left = size.width / -2;\n      camera.right = size.width / 2;\n      camera.top = size.height / 2;\n      camera.bottom = size.height / -2;\n    } else {\n      camera.aspect = size.width / size.height;\n    }\n    camera.updateProjectionMatrix();\n    // https://github.com/pmndrs/react-three-fiber/issues/178\n    // Update matrix world since the renderer is a frame late\n    camera.updateMatrixWorld();\n  }\n}\n\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index + event.instanceId;\n}\n\n// https://github.com/facebook/react/tree/main/packages/react-reconciler#getcurrenteventpriority\n// Gives React a clue as to how import the current interaction is\nfunction getEventPriority() {\n  var _globalScope$event;\n  // Get a handle to the current global scope in window and worker contexts if able\n  // https://github.com/pmndrs/react-three-fiber/pull/2493\n  const globalScope = typeof self !== 'undefined' && self || typeof window !== 'undefined' && window;\n  if (!globalScope) return react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__.DefaultEventPriority;\n  const name = (_globalScope$event = globalScope.event) == null ? void 0 : _globalScope$event.type;\n  switch (name) {\n    case 'click':\n    case 'contextmenu':\n    case 'dblclick':\n    case 'pointercancel':\n    case 'pointerdown':\n    case 'pointerup':\n      return react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__.DiscreteEventPriority;\n    case 'pointermove':\n    case 'pointerout':\n    case 'pointerover':\n    case 'pointerenter':\n    case 'pointerleave':\n    case 'wheel':\n      return react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__.ContinuousEventPriority;\n    default:\n      return react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__.DefaultEventPriority;\n  }\n}\n\n/**\r\n * Release pointer captures.\r\n * This is called by releasePointerCapture in the API, and when an object is removed.\r\n */\nfunction releaseInternalPointerCapture(capturedMap, obj, captures, pointerId) {\n  const captureData = captures.get(obj);\n  if (captureData) {\n    captures.delete(obj);\n    // If this was the last capturing object for this pointer\n    if (captures.size === 0) {\n      capturedMap.delete(pointerId);\n      captureData.target.releasePointerCapture(pointerId);\n    }\n  }\n}\nfunction removeInteractivity(store, object) {\n  const {\n    internal\n  } = store.getState();\n  // Removes every trace of an object from the data store\n  internal.interaction = internal.interaction.filter(o => o !== object);\n  internal.initialHits = internal.initialHits.filter(o => o !== object);\n  internal.hovered.forEach((value, key) => {\n    if (value.eventObject === object || value.object === object) {\n      // Clear out intersects, they are outdated by now\n      internal.hovered.delete(key);\n    }\n  });\n  internal.capturedMap.forEach((captures, pointerId) => {\n    releaseInternalPointerCapture(internal.capturedMap, object, captures, pointerId);\n  });\n}\nfunction createEvents(store) {\n  /** Calculates delta */\n  function calculateDistance(event) {\n    const {\n      internal\n    } = store.getState();\n    const dx = event.offsetX - internal.initialClick[0];\n    const dy = event.offsetY - internal.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }\n\n  /** Returns true if an instance has a valid pointer-event registered, this excludes scroll, clicks etc */\n  function filterPointerEvents(objects) {\n    return objects.filter(obj => ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(name => {\n      var _r3f;\n      return (_r3f = obj.__r3f) == null ? void 0 : _r3f.handlers['onPointer' + name];\n    }));\n  }\n  function intersect(event, filter) {\n    const state = store.getState();\n    const duplicates = new Set();\n    const intersections = [];\n    // Allow callers to eliminate event objects\n    const eventsObjects = filter ? filter(state.internal.interaction) : state.internal.interaction;\n    // Reset all raycaster cameras to undefined\n    for (let i = 0; i < eventsObjects.length; i++) {\n      const state = getRootState(eventsObjects[i]);\n      if (state) {\n        state.raycaster.camera = undefined;\n      }\n    }\n    if (!state.previousRoot) {\n      // Make sure root-level pointer and ray are set up\n      state.events.compute == null ? void 0 : state.events.compute(event, state);\n    }\n    function handleRaycast(obj) {\n      const state = getRootState(obj);\n      // Skip event handling when noEvents is set, or when the raycasters camera is null\n      if (!state || !state.events.enabled || state.raycaster.camera === null) return [];\n\n      // When the camera is undefined we have to call the event layers update function\n      if (state.raycaster.camera === undefined) {\n        var _state$previousRoot;\n        state.events.compute == null ? void 0 : state.events.compute(event, state, (_state$previousRoot = state.previousRoot) == null ? void 0 : _state$previousRoot.getState());\n        // If the camera is still undefined we have to skip this layer entirely\n        if (state.raycaster.camera === undefined) state.raycaster.camera = null;\n      }\n\n      // Intersect object by object\n      return state.raycaster.camera ? state.raycaster.intersectObject(obj, true) : [];\n    }\n\n    // Collect events\n    let hits = eventsObjects\n    // Intersect objects\n    .flatMap(handleRaycast)\n    // Sort by event priority and distance\n    .sort((a, b) => {\n      const aState = getRootState(a.object);\n      const bState = getRootState(b.object);\n      if (!aState || !bState) return a.distance - b.distance;\n      return bState.events.priority - aState.events.priority || a.distance - b.distance;\n    })\n    // Filter out duplicates\n    .filter(item => {\n      const id = makeId(item);\n      if (duplicates.has(id)) return false;\n      duplicates.add(id);\n      return true;\n    });\n\n    // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order, this likely only makes sense on the root filter\n    if (state.events.filter) hits = state.events.filter(hits, state);\n\n    // Bubble up the events, find the event source (eventObject)\n    for (const hit of hits) {\n      let eventObject = hit.object;\n      // Bubble event up\n      while (eventObject) {\n        var _r3f2;\n        if ((_r3f2 = eventObject.__r3f) != null && _r3f2.eventCount) intersections.push({\n          ...hit,\n          eventObject\n        });\n        eventObject = eventObject.parent;\n      }\n    }\n\n    // If the interaction is captured, make all capturing targets part of the intersect.\n    if ('pointerId' in event && state.internal.capturedMap.has(event.pointerId)) {\n      for (let captureData of state.internal.capturedMap.get(event.pointerId).values()) {\n        if (!duplicates.has(makeId(captureData.intersection))) intersections.push(captureData.intersection);\n      }\n    }\n    return intersections;\n  }\n\n  /**  Handles intersections by forwarding them to handlers */\n  function handleIntersects(intersections, event, delta, callback) {\n    const rootState = store.getState();\n\n    // If anything has been found, forward it to the event listeners\n    if (intersections.length) {\n      const localState = {\n        stopped: false\n      };\n      for (const hit of intersections) {\n        const state = getRootState(hit.object) || rootState;\n        const {\n          raycaster,\n          pointer,\n          camera,\n          internal\n        } = state;\n        const unprojectedPoint = new three__WEBPACK_IMPORTED_MODULE_5__.Vector3(pointer.x, pointer.y, 0).unproject(camera);\n        const hasPointerCapture = id => {\n          var _internal$capturedMap, _internal$capturedMap2;\n          return (_internal$capturedMap = (_internal$capturedMap2 = internal.capturedMap.get(id)) == null ? void 0 : _internal$capturedMap2.has(hit.eventObject)) != null ? _internal$capturedMap : false;\n        };\n        const setPointerCapture = id => {\n          const captureData = {\n            intersection: hit,\n            target: event.target\n          };\n          if (internal.capturedMap.has(id)) {\n            // if the pointerId was previously captured, we add the hit to the\n            // event capturedMap.\n            internal.capturedMap.get(id).set(hit.eventObject, captureData);\n          } else {\n            // if the pointerId was not previously captured, we create a map\n            // containing the hitObject, and the hit. hitObject is used for\n            // faster access.\n            internal.capturedMap.set(id, new Map([[hit.eventObject, captureData]]));\n          }\n          event.target.setPointerCapture(id);\n        };\n        const releasePointerCapture = id => {\n          const captures = internal.capturedMap.get(id);\n          if (captures) {\n            releaseInternalPointerCapture(internal.capturedMap, hit.eventObject, captures, id);\n          }\n        };\n\n        // Add native event props\n        let extractEventProps = {};\n        // This iterates over the event's properties including the inherited ones. Native PointerEvents have most of their props as getters which are inherited, but polyfilled PointerEvents have them all as their own properties (i.e. not inherited). We can't use Object.keys() or Object.entries() as they only return \"own\" properties; nor Object.getPrototypeOf(event) as that *doesn't* return \"own\" properties, only inherited ones.\n        for (let prop in event) {\n          let property = event[prop];\n          // Only copy over atomics, leave functions alone as these should be\n          // called as event.nativeEvent.fn()\n          if (typeof property !== 'function') extractEventProps[prop] = property;\n        }\n        let raycastEvent = {\n          ...hit,\n          ...extractEventProps,\n          pointer,\n          intersections,\n          stopped: localState.stopped,\n          delta,\n          unprojectedPoint,\n          ray: raycaster.ray,\n          camera: camera,\n          // Hijack stopPropagation, which just sets a flag\n          stopPropagation() {\n            // https://github.com/pmndrs/react-three-fiber/issues/596\n            // Events are not allowed to stop propagation if the pointer has been captured\n            const capturesForPointer = 'pointerId' in event && internal.capturedMap.get(event.pointerId);\n\n            // We only authorize stopPropagation...\n            if (\n            // ...if this pointer hasn't been captured\n            !capturesForPointer ||\n            // ... or if the hit object is capturing the pointer\n            capturesForPointer.has(hit.eventObject)) {\n              raycastEvent.stopped = localState.stopped = true;\n              // Propagation is stopped, remove all other hover records\n              // An event handler is only allowed to flush other handlers if it is hovered itself\n              if (internal.hovered.size && Array.from(internal.hovered.values()).find(i => i.eventObject === hit.eventObject)) {\n                // Objects cannot flush out higher up objects that have already caught the event\n                const higher = intersections.slice(0, intersections.indexOf(hit));\n                cancelPointer([...higher, hit]);\n              }\n            }\n          },\n          // there should be a distinction between target and currentTarget\n          target: {\n            hasPointerCapture,\n            setPointerCapture,\n            releasePointerCapture\n          },\n          currentTarget: {\n            hasPointerCapture,\n            setPointerCapture,\n            releasePointerCapture\n          },\n          nativeEvent: event\n        };\n\n        // Call subscribers\n        callback(raycastEvent);\n        // Event bubbling may be interrupted by stopPropagation\n        if (localState.stopped === true) break;\n      }\n    }\n    return intersections;\n  }\n  function cancelPointer(intersections) {\n    const {\n      internal\n    } = store.getState();\n    for (const hoveredObj of internal.hovered.values()) {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (!intersections.length || !intersections.find(hit => hit.object === hoveredObj.object && hit.index === hoveredObj.index && hit.instanceId === hoveredObj.instanceId)) {\n        const eventObject = hoveredObj.eventObject;\n        const instance = eventObject.__r3f;\n        const handlers = instance == null ? void 0 : instance.handlers;\n        internal.hovered.delete(makeId(hoveredObj));\n        if (instance != null && instance.eventCount) {\n          // Clear out intersects, they are outdated by now\n          const data = {\n            ...hoveredObj,\n            intersections\n          };\n          handlers.onPointerOut == null ? void 0 : handlers.onPointerOut(data);\n          handlers.onPointerLeave == null ? void 0 : handlers.onPointerLeave(data);\n        }\n      }\n    }\n  }\n  function pointerMissed(event, objects) {\n    for (let i = 0; i < objects.length; i++) {\n      const instance = objects[i].__r3f;\n      instance == null ? void 0 : instance.handlers.onPointerMissed == null ? void 0 : instance.handlers.onPointerMissed(event);\n    }\n  }\n  function handlePointer(name) {\n    // Deal with cancelation\n    switch (name) {\n      case 'onPointerLeave':\n      case 'onPointerCancel':\n        return () => cancelPointer([]);\n      case 'onLostPointerCapture':\n        return event => {\n          const {\n            internal\n          } = store.getState();\n          if ('pointerId' in event && internal.capturedMap.has(event.pointerId)) {\n            // If the object event interface had onLostPointerCapture, we'd call it here on every\n            // object that's getting removed. We call it on the next frame because onLostPointerCapture\n            // fires before onPointerUp. Otherwise pointerUp would never be called if the event didn't\n            // happen in the object it originated from, leaving components in a in-between state.\n            requestAnimationFrame(() => {\n              // Only release if pointer-up didn't do it already\n              if (internal.capturedMap.has(event.pointerId)) {\n                internal.capturedMap.delete(event.pointerId);\n                cancelPointer([]);\n              }\n            });\n          }\n        };\n    }\n\n    // Any other pointer goes here ...\n    return function handleEvent(event) {\n      const {\n        onPointerMissed,\n        internal\n      } = store.getState();\n\n      // prepareRay(event)\n      internal.lastEvent.current = event;\n\n      // Get fresh intersects\n      const isPointerMove = name === 'onPointerMove';\n      const isClickEvent = name === 'onClick' || name === 'onContextMenu' || name === 'onDoubleClick';\n      const filter = isPointerMove ? filterPointerEvents : undefined;\n      const hits = intersect(event, filter);\n      const delta = isClickEvent ? calculateDistance(event) : 0;\n\n      // Save initial coordinates on pointer-down\n      if (name === 'onPointerDown') {\n        internal.initialClick = [event.offsetX, event.offsetY];\n        internal.initialHits = hits.map(hit => hit.eventObject);\n      }\n\n      // If a click yields no results, pass it back to the user as a miss\n      // Missed events have to come first in order to establish user-land side-effect clean up\n      if (isClickEvent && !hits.length) {\n        if (delta <= 2) {\n          pointerMissed(event, internal.interaction);\n          if (onPointerMissed) onPointerMissed(event);\n        }\n      }\n      // Take care of unhover\n      if (isPointerMove) cancelPointer(hits);\n      function onIntersect(data) {\n        const eventObject = data.eventObject;\n        const instance = eventObject.__r3f;\n        const handlers = instance == null ? void 0 : instance.handlers;\n\n        // Check presence of handlers\n        if (!(instance != null && instance.eventCount)) return;\n\n        /*\r\n        MAYBE TODO, DELETE IF NOT: \r\n          Check if the object is captured, captured events should not have intersects running in parallel\r\n          But wouldn't it be better to just replace capturedMap with a single entry?\r\n          Also, are we OK with straight up making picking up multiple objects impossible?\r\n          \r\n        const pointerId = (data as ThreeEvent<PointerEvent>).pointerId        \r\n        if (pointerId !== undefined) {\r\n          const capturedMeshSet = internal.capturedMap.get(pointerId)\r\n          if (capturedMeshSet) {\r\n            const captured = capturedMeshSet.get(eventObject)\r\n            if (captured && captured.localState.stopped) return\r\n          }\r\n        }*/\n\n        if (isPointerMove) {\n          // Move event ...\n          if (handlers.onPointerOver || handlers.onPointerEnter || handlers.onPointerOut || handlers.onPointerLeave) {\n            // When enter or out is present take care of hover-state\n            const id = makeId(data);\n            const hoveredItem = internal.hovered.get(id);\n            if (!hoveredItem) {\n              // If the object wasn't previously hovered, book it and call its handler\n              internal.hovered.set(id, data);\n              handlers.onPointerOver == null ? void 0 : handlers.onPointerOver(data);\n              handlers.onPointerEnter == null ? void 0 : handlers.onPointerEnter(data);\n            } else if (hoveredItem.stopped) {\n              // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n              data.stopPropagation();\n            }\n          }\n          // Call mouse move\n          handlers.onPointerMove == null ? void 0 : handlers.onPointerMove(data);\n        } else {\n          // All other events ...\n          const handler = handlers[name];\n          if (handler) {\n            // Forward all events back to their respective handlers with the exception of click events,\n            // which must use the initial target\n            if (!isClickEvent || internal.initialHits.includes(eventObject)) {\n              // Missed events have to come first\n              pointerMissed(event, internal.interaction.filter(object => !internal.initialHits.includes(object)));\n              // Now call the handler\n              handler(data);\n            }\n          } else {\n            // Trigger onPointerMissed on all elements that have pointer over/out handlers, but not click and weren't hit\n            if (isClickEvent && internal.initialHits.includes(eventObject)) {\n              pointerMissed(event, internal.interaction.filter(object => !internal.initialHits.includes(object)));\n            }\n          }\n        }\n      }\n      handleIntersects(hits, event, delta, onIntersect);\n    };\n  }\n  return {\n    handlePointer\n  };\n}\n\n// Keys that shouldn't be copied between R3F stores\nconst privateKeys = ['set', 'get', 'setSize', 'setFrameloop', 'setDpr', 'events', 'invalidate', 'advance', 'size', 'viewport'];\nconst isRenderer = def => !!(def != null && def.render);\nconst context = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createContext(null);\nconst createStore = (invalidate, advance) => {\n  const rootState = (0,zustand__WEBPACK_IMPORTED_MODULE_6__[\"default\"])((set, get) => {\n    const position = new three__WEBPACK_IMPORTED_MODULE_5__.Vector3();\n    const defaultTarget = new three__WEBPACK_IMPORTED_MODULE_5__.Vector3();\n    const tempTarget = new three__WEBPACK_IMPORTED_MODULE_5__.Vector3();\n    function getCurrentViewport(camera = get().camera, target = defaultTarget, size = get().size) {\n      const {\n        width,\n        height,\n        top,\n        left\n      } = size;\n      const aspect = width / height;\n      if (target instanceof three__WEBPACK_IMPORTED_MODULE_5__.Vector3) tempTarget.copy(target);else tempTarget.set(...target);\n      const distance = camera.getWorldPosition(position).distanceTo(tempTarget);\n      if (isOrthographicCamera(camera)) {\n        return {\n          width: width / camera.zoom,\n          height: height / camera.zoom,\n          top,\n          left,\n          factor: 1,\n          distance,\n          aspect\n        };\n      } else {\n        const fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n        const h = 2 * Math.tan(fov / 2) * distance; // visible height\n        const w = h * (width / height);\n        return {\n          width: w,\n          height: h,\n          top,\n          left,\n          factor: width / w,\n          distance,\n          aspect\n        };\n      }\n    }\n    let performanceTimeout = undefined;\n    const setPerformanceCurrent = current => set(state => ({\n      performance: {\n        ...state.performance,\n        current\n      }\n    }));\n    const pointer = new three__WEBPACK_IMPORTED_MODULE_5__.Vector2();\n    const rootState = {\n      set,\n      get,\n      // Mock objects that have to be configured\n      gl: null,\n      camera: null,\n      raycaster: null,\n      events: {\n        priority: 1,\n        enabled: true,\n        connected: false\n      },\n      xr: null,\n      scene: null,\n      invalidate: (frames = 1) => invalidate(get(), frames),\n      advance: (timestamp, runGlobalEffects) => advance(timestamp, runGlobalEffects, get()),\n      legacy: false,\n      linear: false,\n      flat: false,\n      controls: null,\n      clock: new three__WEBPACK_IMPORTED_MODULE_5__.Clock(),\n      pointer,\n      mouse: pointer,\n      frameloop: 'always',\n      onPointerMissed: undefined,\n      performance: {\n        current: 1,\n        min: 0.5,\n        max: 1,\n        debounce: 200,\n        regress: () => {\n          const state = get();\n          // Clear timeout\n          if (performanceTimeout) clearTimeout(performanceTimeout);\n          // Set lower bound performance\n          if (state.performance.current !== state.performance.min) setPerformanceCurrent(state.performance.min);\n          // Go back to upper bound performance after a while unless something regresses meanwhile\n          performanceTimeout = setTimeout(() => setPerformanceCurrent(get().performance.max), state.performance.debounce);\n        }\n      },\n      size: {\n        width: 0,\n        height: 0,\n        top: 0,\n        left: 0,\n        updateStyle: false\n      },\n      viewport: {\n        initialDpr: 0,\n        dpr: 0,\n        width: 0,\n        height: 0,\n        top: 0,\n        left: 0,\n        aspect: 0,\n        distance: 0,\n        factor: 0,\n        getCurrentViewport\n      },\n      setEvents: events => set(state => ({\n        ...state,\n        events: {\n          ...state.events,\n          ...events\n        }\n      })),\n      setSize: (width, height, updateStyle, top, left) => {\n        const camera = get().camera;\n        const size = {\n          width,\n          height,\n          top: top || 0,\n          left: left || 0,\n          updateStyle\n        };\n        set(state => ({\n          size,\n          viewport: {\n            ...state.viewport,\n            ...getCurrentViewport(camera, defaultTarget, size)\n          }\n        }));\n      },\n      setDpr: dpr => set(state => {\n        const resolved = calculateDpr(dpr);\n        return {\n          viewport: {\n            ...state.viewport,\n            dpr: resolved,\n            initialDpr: state.viewport.initialDpr || resolved\n          }\n        };\n      }),\n      setFrameloop: (frameloop = 'always') => {\n        const clock = get().clock;\n\n        // if frameloop === \"never\" clock.elapsedTime is updated using advance(timestamp)\n        clock.stop();\n        clock.elapsedTime = 0;\n        if (frameloop !== 'never') {\n          clock.start();\n          clock.elapsedTime = 0;\n        }\n        set(() => ({\n          frameloop\n        }));\n      },\n      previousRoot: undefined,\n      internal: {\n        active: false,\n        priority: 0,\n        frames: 0,\n        lastEvent: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createRef(),\n        interaction: [],\n        hovered: new Map(),\n        subscribers: [],\n        initialClick: [0, 0],\n        initialHits: [],\n        capturedMap: new Map(),\n        subscribe: (ref, priority, store) => {\n          const internal = get().internal;\n          // If this subscription was given a priority, it takes rendering into its own hands\n          // For that reason we switch off automatic rendering and increase the manual flag\n          // As long as this flag is positive there can be no internal rendering at all\n          // because there could be multiple render subscriptions\n          internal.priority = internal.priority + (priority > 0 ? 1 : 0);\n          internal.subscribers.push({\n            ref,\n            priority,\n            store\n          });\n          // Register subscriber and sort layers from lowest to highest, meaning,\n          // highest priority renders last (on top of the other frames)\n          internal.subscribers = internal.subscribers.sort((a, b) => a.priority - b.priority);\n          return () => {\n            const internal = get().internal;\n            if (internal != null && internal.subscribers) {\n              // Decrease manual flag if this subscription had a priority\n              internal.priority = internal.priority - (priority > 0 ? 1 : 0);\n              // Remove subscriber from list\n              internal.subscribers = internal.subscribers.filter(s => s.ref !== ref);\n            }\n          };\n        }\n      }\n    };\n    return rootState;\n  });\n  const state = rootState.getState();\n  let oldSize = state.size;\n  let oldDpr = state.viewport.dpr;\n  let oldCamera = state.camera;\n  rootState.subscribe(() => {\n    const {\n      camera,\n      size,\n      viewport,\n      gl,\n      set\n    } = rootState.getState();\n\n    // Resize camera and renderer on changes to size and pixelratio\n    if (size.width !== oldSize.width || size.height !== oldSize.height || viewport.dpr !== oldDpr) {\n      var _size$updateStyle;\n      oldSize = size;\n      oldDpr = viewport.dpr;\n      // Update camera & renderer\n      updateCamera(camera, size);\n      gl.setPixelRatio(viewport.dpr);\n      const updateStyle = (_size$updateStyle = size.updateStyle) != null ? _size$updateStyle : typeof HTMLCanvasElement !== 'undefined' && gl.domElement instanceof HTMLCanvasElement;\n      gl.setSize(size.width, size.height, updateStyle);\n    }\n\n    // Update viewport once the camera changes\n    if (camera !== oldCamera) {\n      oldCamera = camera;\n      // Update viewport\n      set(state => ({\n        viewport: {\n          ...state.viewport,\n          ...state.viewport.getCurrentViewport(camera)\n        }\n      }));\n    }\n  });\n\n  // Invalidate on any change\n  rootState.subscribe(state => invalidate(state));\n\n  // Return root state\n  return rootState;\n};\n\nfunction createSubs(callback, subs) {\n  const sub = {\n    callback\n  };\n  subs.add(sub);\n  return () => void subs.delete(sub);\n}\nlet i;\nlet globalEffects = new Set();\nlet globalAfterEffects = new Set();\nlet globalTailEffects = new Set();\n\n/**\r\n * Adds a global render callback which is called each frame.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/additional-exports#addEffect\r\n */\nconst addEffect = callback => createSubs(callback, globalEffects);\n\n/**\r\n * Adds a global after-render callback which is called each frame.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/additional-exports#addAfterEffect\r\n */\nconst addAfterEffect = callback => createSubs(callback, globalAfterEffects);\n\n/**\r\n * Adds a global callback which is called when rendering stops.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/additional-exports#addTail\r\n */\nconst addTail = callback => createSubs(callback, globalTailEffects);\nfunction run(effects, timestamp) {\n  if (!effects.size) return;\n  for (const {\n    callback\n  } of effects.values()) {\n    callback(timestamp);\n  }\n}\nfunction flushGlobalEffects(type, timestamp) {\n  switch (type) {\n    case 'before':\n      return run(globalEffects, timestamp);\n    case 'after':\n      return run(globalAfterEffects, timestamp);\n    case 'tail':\n      return run(globalTailEffects, timestamp);\n  }\n}\nlet subscribers;\nlet subscription;\nfunction render$1(timestamp, state, frame) {\n  // Run local effects\n  let delta = state.clock.getDelta();\n  // In frameloop='never' mode, clock times are updated using the provided timestamp\n  if (state.frameloop === 'never' && typeof timestamp === 'number') {\n    delta = timestamp - state.clock.elapsedTime;\n    state.clock.oldTime = state.clock.elapsedTime;\n    state.clock.elapsedTime = timestamp;\n  }\n  // Call subscribers (useFrame)\n  subscribers = state.internal.subscribers;\n  for (i = 0; i < subscribers.length; i++) {\n    subscription = subscribers[i];\n    subscription.ref.current(subscription.store.getState(), delta, frame);\n  }\n  // Render content\n  if (!state.internal.priority && state.gl.render) state.gl.render(state.scene, state.camera);\n  // Decrease frame count\n  state.internal.frames = Math.max(0, state.internal.frames - 1);\n  return state.frameloop === 'always' ? 1 : state.internal.frames;\n}\nfunction createLoop(roots) {\n  let running = false;\n  let useFrameInProgress = false;\n  let repeat;\n  let frame;\n  let state;\n  function loop(timestamp) {\n    frame = requestAnimationFrame(loop);\n    running = true;\n    repeat = 0;\n\n    // Run effects\n    flushGlobalEffects('before', timestamp);\n\n    // Render all roots\n    useFrameInProgress = true;\n    for (const root of roots.values()) {\n      var _state$gl$xr;\n      state = root.store.getState();\n      // If the frameloop is invalidated, do not run another frame\n      if (state.internal.active && (state.frameloop === 'always' || state.internal.frames > 0) && !((_state$gl$xr = state.gl.xr) != null && _state$gl$xr.isPresenting)) {\n        repeat += render$1(timestamp, state);\n      }\n    }\n    useFrameInProgress = false;\n\n    // Run after-effects\n    flushGlobalEffects('after', timestamp);\n\n    // Stop the loop if nothing invalidates it\n    if (repeat === 0) {\n      // Tail call effects, they are called when rendering stops\n      flushGlobalEffects('tail', timestamp);\n\n      // Flag end of operation\n      running = false;\n      return cancelAnimationFrame(frame);\n    }\n  }\n  function invalidate(state, frames = 1) {\n    var _state$gl$xr2;\n    if (!state) return roots.forEach(root => invalidate(root.store.getState(), frames));\n    if ((_state$gl$xr2 = state.gl.xr) != null && _state$gl$xr2.isPresenting || !state.internal.active || state.frameloop === 'never') return;\n    if (frames > 1) {\n      // legacy support for people using frames parameters\n      // Increase frames, do not go higher than 60\n      state.internal.frames = Math.min(60, state.internal.frames + frames);\n    } else {\n      if (useFrameInProgress) {\n        //called from within a useFrame, it means the user wants an additional frame\n        state.internal.frames = 2;\n      } else {\n        //the user need a new frame, no need to increment further than 1\n        state.internal.frames = 1;\n      }\n    }\n\n    // If the render-loop isn't active, start it\n    if (!running) {\n      running = true;\n      requestAnimationFrame(loop);\n    }\n  }\n  function advance(timestamp, runGlobalEffects = true, state, frame) {\n    if (runGlobalEffects) flushGlobalEffects('before', timestamp);\n    if (!state) for (const root of roots.values()) render$1(timestamp, root.store.getState());else render$1(timestamp, state, frame);\n    if (runGlobalEffects) flushGlobalEffects('after', timestamp);\n  }\n  return {\n    loop,\n    invalidate,\n    advance\n  };\n}\n\n/**\r\n * Exposes an object's {@link LocalState}.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/additional-exports#useInstanceHandle\r\n *\r\n * **Note**: this is an escape hatch to react-internal fields. Expect this to change significantly between versions.\r\n */\nfunction useInstanceHandle(ref) {\n  const instance = react__WEBPACK_IMPORTED_MODULE_0__.useRef(null);\n  useIsomorphicLayoutEffect(() => void (instance.current = ref.current.__r3f), [ref]);\n  return instance;\n}\nfunction useStore() {\n  const store = react__WEBPACK_IMPORTED_MODULE_0__.useContext(context);\n  if (!store) throw new Error('R3F: Hooks can only be used within the Canvas component!');\n  return store;\n}\n\n/**\r\n * Accesses R3F's internal state, containing renderer, canvas, scene, etc.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/hooks#usethree\r\n */\nfunction useThree(selector = state => state, equalityFn) {\n  return useStore()(selector, equalityFn);\n}\n\n/**\r\n * Executes a callback before render in a shared frame loop.\r\n * Can order effects with render priority or manually render with a positive priority.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/hooks#useframe\r\n */\nfunction useFrame(callback, renderPriority = 0) {\n  const store = useStore();\n  const subscribe = store.getState().internal.subscribe;\n  // Memoize ref\n  const ref = useMutableCallback(callback);\n  // Subscribe on mount, unsubscribe on unmount\n  useIsomorphicLayoutEffect(() => subscribe(ref, renderPriority, store), [renderPriority, subscribe, store]);\n  return null;\n}\n\n/**\r\n * Returns a node graph of an object with named nodes & materials.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/hooks#usegraph\r\n */\nfunction useGraph(object) {\n  return react__WEBPACK_IMPORTED_MODULE_0__.useMemo(() => buildGraph(object), [object]);\n}\nconst memoizedLoaders = new WeakMap();\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto, ...input) {\n    // Construct new loader and run extensions\n    let loader = memoizedLoaders.get(Proto);\n    if (!loader) {\n      loader = new Proto();\n      memoizedLoaders.set(Proto, loader);\n    }\n    if (extensions) extensions(loader);\n    // Go through the urls and load them\n    return Promise.all(input.map(input => new Promise((res, reject) => loader.load(input, data => {\n      if (data.scene) Object.assign(data, buildGraph(data.scene));\n      res(data);\n    }, onProgress, error => reject(new Error(`Could not load ${input}: ${error == null ? void 0 : error.message}`))))));\n  };\n}\n/**\r\n * Synchronously loads and caches assets with a three loader.\r\n *\r\n * Note: this hook's caller must be wrapped with `React.Suspense`\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/hooks#useloader\r\n */\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  const keys = Array.isArray(input) ? input : [input];\n  const results = (0,suspend_react__WEBPACK_IMPORTED_MODULE_7__.suspend)(loadingFn(extensions, onProgress), [Proto, ...keys], {\n    equal: is.equ\n  });\n  // Return the object/s\n  return Array.isArray(input) ? results : results[0];\n}\n\n/**\r\n * Preloads an asset into cache as a side-effect.\r\n */\nuseLoader.preload = function (Proto, input, extensions) {\n  const keys = Array.isArray(input) ? input : [input];\n  return (0,suspend_react__WEBPACK_IMPORTED_MODULE_7__.preload)(loadingFn(extensions), [Proto, ...keys]);\n};\n\n/**\r\n * Removes a loaded asset from cache.\r\n */\nuseLoader.clear = function (Proto, input) {\n  const keys = Array.isArray(input) ? input : [input];\n  return (0,suspend_react__WEBPACK_IMPORTED_MODULE_7__.clear)([Proto, ...keys]);\n};\n\nconst roots = new Map();\nconst {\n  invalidate,\n  advance\n} = createLoop(roots);\nconst {\n  reconciler,\n  applyProps\n} = createRenderer(roots, getEventPriority);\nconst shallowLoose = {\n  objects: 'shallow',\n  strict: false\n};\nconst createRendererInstance = (gl, canvas) => {\n  const customRenderer = typeof gl === 'function' ? gl(canvas) : gl;\n  if (isRenderer(customRenderer)) return customRenderer;else return new three__WEBPACK_IMPORTED_MODULE_5__.WebGLRenderer({\n    powerPreference: 'high-performance',\n    canvas: canvas,\n    antialias: true,\n    alpha: true,\n    ...gl\n  });\n};\nfunction computeInitialSize(canvas, defaultSize) {\n  const defaultStyle = typeof HTMLCanvasElement !== 'undefined' && canvas instanceof HTMLCanvasElement;\n  if (defaultSize) {\n    const {\n      width,\n      height,\n      top,\n      left,\n      updateStyle = defaultStyle\n    } = defaultSize;\n    return {\n      width,\n      height,\n      top,\n      left,\n      updateStyle\n    };\n  } else if (typeof HTMLCanvasElement !== 'undefined' && canvas instanceof HTMLCanvasElement && canvas.parentElement) {\n    const {\n      width,\n      height,\n      top,\n      left\n    } = canvas.parentElement.getBoundingClientRect();\n    return {\n      width,\n      height,\n      top,\n      left,\n      updateStyle: defaultStyle\n    };\n  } else if (typeof OffscreenCanvas !== 'undefined' && canvas instanceof OffscreenCanvas) {\n    return {\n      width: canvas.width,\n      height: canvas.height,\n      top: 0,\n      left: 0,\n      updateStyle: defaultStyle\n    };\n  }\n  return {\n    width: 0,\n    height: 0,\n    top: 0,\n    left: 0\n  };\n}\nfunction createRoot(canvas) {\n  // Check against mistaken use of createRoot\n  const prevRoot = roots.get(canvas);\n  const prevFiber = prevRoot == null ? void 0 : prevRoot.fiber;\n  const prevStore = prevRoot == null ? void 0 : prevRoot.store;\n  if (prevRoot) console.warn('R3F.createRoot should only be called once!');\n\n  // Report when an error was detected in a previous render\n  // https://github.com/pmndrs/react-three-fiber/pull/2261\n  const logRecoverableError = typeof reportError === 'function' ?\n  // In modern browsers, reportError will dispatch an error event,\n  // emulating an uncaught JavaScript error.\n  reportError :\n  // In older browsers and test environments, fallback to console.error.\n  console.error;\n\n  // Create store\n  const store = prevStore || createStore(invalidate, advance);\n  // Create renderer\n  const fiber = prevFiber || reconciler.createContainer(store, react_reconciler_constants__WEBPACK_IMPORTED_MODULE_1__.ConcurrentRoot, null, false, null, '', logRecoverableError, null);\n  // Map it\n  if (!prevRoot) roots.set(canvas, {\n    fiber,\n    store\n  });\n\n  // Locals\n  let onCreated;\n  let configured = false;\n  let lastCamera;\n  return {\n    configure(props = {}) {\n      let {\n        gl: glConfig,\n        size: propsSize,\n        scene: sceneOptions,\n        events,\n        onCreated: onCreatedCallback,\n        shadows = false,\n        linear = false,\n        flat = false,\n        legacy = false,\n        orthographic = false,\n        frameloop = 'always',\n        dpr = [1, 2],\n        performance,\n        raycaster: raycastOptions,\n        camera: cameraOptions,\n        onPointerMissed\n      } = props;\n      let state = store.getState();\n\n      // Set up renderer (one time only!)\n      let gl = state.gl;\n      if (!state.gl) state.set({\n        gl: gl = createRendererInstance(glConfig, canvas)\n      });\n\n      // Set up raycaster (one time only!)\n      let raycaster = state.raycaster;\n      if (!raycaster) state.set({\n        raycaster: raycaster = new three__WEBPACK_IMPORTED_MODULE_5__.Raycaster()\n      });\n\n      // Set raycaster options\n      const {\n        params,\n        ...options\n      } = raycastOptions || {};\n      if (!is.equ(options, raycaster, shallowLoose)) applyProps(raycaster, {\n        ...options\n      });\n      if (!is.equ(params, raycaster.params, shallowLoose)) applyProps(raycaster, {\n        params: {\n          ...raycaster.params,\n          ...params\n        }\n      });\n\n      // Create default camera, don't overwrite any user-set state\n      if (!state.camera || state.camera === lastCamera && !is.equ(lastCamera, cameraOptions, shallowLoose)) {\n        lastCamera = cameraOptions;\n        const isCamera = cameraOptions instanceof three__WEBPACK_IMPORTED_MODULE_5__.Camera;\n        const camera = isCamera ? cameraOptions : orthographic ? new three__WEBPACK_IMPORTED_MODULE_5__.OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new three__WEBPACK_IMPORTED_MODULE_5__.PerspectiveCamera(75, 0, 0.1, 1000);\n        if (!isCamera) {\n          camera.position.z = 5;\n          if (cameraOptions) {\n            applyProps(camera, cameraOptions);\n            // Preserve user-defined frustum if possible\n            // https://github.com/pmndrs/react-three-fiber/issues/3160\n            if ('aspect' in cameraOptions || 'left' in cameraOptions || 'right' in cameraOptions || 'bottom' in cameraOptions || 'top' in cameraOptions) {\n              camera.manual = true;\n              camera.updateProjectionMatrix();\n            }\n          }\n          // Always look at center by default\n          if (!state.camera && !(cameraOptions != null && cameraOptions.rotation)) camera.lookAt(0, 0, 0);\n        }\n        state.set({\n          camera\n        });\n\n        // Configure raycaster\n        // https://github.com/pmndrs/react-xr/issues/300\n        raycaster.camera = camera;\n      }\n\n      // Set up scene (one time only!)\n      if (!state.scene) {\n        let scene;\n        if (sceneOptions instanceof three__WEBPACK_IMPORTED_MODULE_5__.Scene) {\n          scene = sceneOptions;\n        } else {\n          scene = new three__WEBPACK_IMPORTED_MODULE_5__.Scene();\n          if (sceneOptions) applyProps(scene, sceneOptions);\n        }\n        state.set({\n          scene: prepare(scene)\n        });\n      }\n\n      // Set up XR (one time only!)\n      if (!state.xr) {\n        var _gl$xr;\n        // Handle frame behavior in WebXR\n        const handleXRFrame = (timestamp, frame) => {\n          const state = store.getState();\n          if (state.frameloop === 'never') return;\n          advance(timestamp, true, state, frame);\n        };\n\n        // Toggle render switching on session\n        const handleSessionChange = () => {\n          const state = store.getState();\n          state.gl.xr.enabled = state.gl.xr.isPresenting;\n          state.gl.xr.setAnimationLoop(state.gl.xr.isPresenting ? handleXRFrame : null);\n          if (!state.gl.xr.isPresenting) invalidate(state);\n        };\n\n        // WebXR session manager\n        const xr = {\n          connect() {\n            const gl = store.getState().gl;\n            gl.xr.addEventListener('sessionstart', handleSessionChange);\n            gl.xr.addEventListener('sessionend', handleSessionChange);\n          },\n          disconnect() {\n            const gl = store.getState().gl;\n            gl.xr.removeEventListener('sessionstart', handleSessionChange);\n            gl.xr.removeEventListener('sessionend', handleSessionChange);\n          }\n        };\n\n        // Subscribe to WebXR session events\n        if (typeof ((_gl$xr = gl.xr) == null ? void 0 : _gl$xr.addEventListener) === 'function') xr.connect();\n        state.set({\n          xr\n        });\n      }\n\n      // Set shadowmap\n      if (gl.shadowMap) {\n        const oldEnabled = gl.shadowMap.enabled;\n        const oldType = gl.shadowMap.type;\n        gl.shadowMap.enabled = !!shadows;\n        if (is.boo(shadows)) {\n          gl.shadowMap.type = three__WEBPACK_IMPORTED_MODULE_5__.PCFSoftShadowMap;\n        } else if (is.str(shadows)) {\n          var _types$shadows;\n          const types = {\n            basic: three__WEBPACK_IMPORTED_MODULE_5__.BasicShadowMap,\n            percentage: three__WEBPACK_IMPORTED_MODULE_5__.PCFShadowMap,\n            soft: three__WEBPACK_IMPORTED_MODULE_5__.PCFSoftShadowMap,\n            variance: three__WEBPACK_IMPORTED_MODULE_5__.VSMShadowMap\n          };\n          gl.shadowMap.type = (_types$shadows = types[shadows]) != null ? _types$shadows : three__WEBPACK_IMPORTED_MODULE_5__.PCFSoftShadowMap;\n        } else if (is.obj(shadows)) {\n          Object.assign(gl.shadowMap, shadows);\n        }\n        if (oldEnabled !== gl.shadowMap.enabled || oldType !== gl.shadowMap.type) gl.shadowMap.needsUpdate = true;\n      }\n\n      // Safely set color management if available.\n      // Avoid accessing THREE.ColorManagement to play nice with older versions\n      const ColorManagement = getColorManagement();\n      if (ColorManagement) {\n        if ('enabled' in ColorManagement) ColorManagement.enabled = !legacy;else if ('legacyMode' in ColorManagement) ColorManagement.legacyMode = legacy;\n      }\n      if (!configured) {\n        // Set color space and tonemapping preferences, once\n        const LinearEncoding = 3000;\n        const sRGBEncoding = 3001;\n        applyProps(gl, {\n          outputEncoding: linear ? LinearEncoding : sRGBEncoding,\n          toneMapping: flat ? three__WEBPACK_IMPORTED_MODULE_5__.NoToneMapping : three__WEBPACK_IMPORTED_MODULE_5__.ACESFilmicToneMapping\n        });\n      }\n\n      // Update color management state\n      if (state.legacy !== legacy) state.set(() => ({\n        legacy\n      }));\n      if (state.linear !== linear) state.set(() => ({\n        linear\n      }));\n      if (state.flat !== flat) state.set(() => ({\n        flat\n      }));\n\n      // Set gl props\n      if (glConfig && !is.fun(glConfig) && !isRenderer(glConfig) && !is.equ(glConfig, gl, shallowLoose)) applyProps(gl, glConfig);\n      // Store events internally\n      if (events && !state.events.handlers) state.set({\n        events: events(store)\n      });\n      // Check size, allow it to take on container bounds initially\n      const size = computeInitialSize(canvas, propsSize);\n      if (!is.equ(size, state.size, shallowLoose)) {\n        state.setSize(size.width, size.height, size.updateStyle, size.top, size.left);\n      }\n      // Check pixelratio\n      if (dpr && state.viewport.dpr !== calculateDpr(dpr)) state.setDpr(dpr);\n      // Check frameloop\n      if (state.frameloop !== frameloop) state.setFrameloop(frameloop);\n      // Check pointer missed\n      if (!state.onPointerMissed) state.set({\n        onPointerMissed\n      });\n      // Check performance\n      if (performance && !is.equ(performance, state.performance, shallowLoose)) state.set(state => ({\n        performance: {\n          ...state.performance,\n          ...performance\n        }\n      }));\n\n      // Set locals\n      onCreated = onCreatedCallback;\n      configured = true;\n      return this;\n    },\n    render(children) {\n      // The root has to be configured before it can be rendered\n      if (!configured) this.configure();\n      reconciler.updateContainer( /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(Provider, {\n        store: store,\n        children: children,\n        onCreated: onCreated,\n        rootElement: canvas\n      }), fiber, null, () => undefined);\n      return store;\n    },\n    unmount() {\n      unmountComponentAtNode(canvas);\n    }\n  };\n}\nfunction render(children, canvas, config) {\n  console.warn('R3F.render is no longer supported in React 18. Use createRoot instead!');\n  const root = createRoot(canvas);\n  root.configure(config);\n  return root.render(children);\n}\nfunction Provider({\n  store,\n  children,\n  onCreated,\n  rootElement\n}) {\n  useIsomorphicLayoutEffect(() => {\n    const state = store.getState();\n    // Flag the canvas active, rendering will now begin\n    state.set(state => ({\n      internal: {\n        ...state.internal,\n        active: true\n      }\n    }));\n    // Notifiy that init is completed, the scene graph exists, but nothing has yet rendered\n    if (onCreated) onCreated(state);\n    // Connect events to the targets parent, this is done to ensure events are registered on\n    // a shared target, and not on the canvas itself\n    if (!store.getState().events.connected) state.events.connect == null ? void 0 : state.events.connect(rootElement);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(context.Provider, {\n    value: store,\n    children: children\n  });\n}\nfunction unmountComponentAtNode(canvas, callback) {\n  const root = roots.get(canvas);\n  const fiber = root == null ? void 0 : root.fiber;\n  if (fiber) {\n    const state = root == null ? void 0 : root.store.getState();\n    if (state) state.internal.active = false;\n    reconciler.updateContainer(null, fiber, null, () => {\n      if (state) {\n        setTimeout(() => {\n          try {\n            var _state$gl, _state$gl$renderLists, _state$gl2, _state$gl3;\n            state.events.disconnect == null ? void 0 : state.events.disconnect();\n            (_state$gl = state.gl) == null ? void 0 : (_state$gl$renderLists = _state$gl.renderLists) == null ? void 0 : _state$gl$renderLists.dispose == null ? void 0 : _state$gl$renderLists.dispose();\n            (_state$gl2 = state.gl) == null ? void 0 : _state$gl2.forceContextLoss == null ? void 0 : _state$gl2.forceContextLoss();\n            if ((_state$gl3 = state.gl) != null && _state$gl3.xr) state.xr.disconnect();\n            dispose(state);\n            roots.delete(canvas);\n            if (callback) callback(canvas);\n          } catch (e) {\n            /* ... */\n          }\n        }, 500);\n      }\n    });\n  }\n}\nfunction createPortal(children, container, state) {\n  return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(Portal, {\n    children: children,\n    container: container,\n    state: state\n  }, container.uuid);\n}\nfunction Portal({\n  state = {},\n  children,\n  container\n}) {\n  /** This has to be a component because it would not be able to call useThree/useStore otherwise since\r\n   *  if this is our environment, then we are not in r3f's renderer but in react-dom, it would trigger\r\n   *  the \"R3F hooks can only be used within the Canvas component!\" warning:\r\n   *  <Canvas>\r\n   *    {createPortal(...)} */\n  const {\n    events,\n    size,\n    ...rest\n  } = state;\n  const previousRoot = useStore();\n  const [raycaster] = react__WEBPACK_IMPORTED_MODULE_0__.useState(() => new three__WEBPACK_IMPORTED_MODULE_5__.Raycaster());\n  const [pointer] = react__WEBPACK_IMPORTED_MODULE_0__.useState(() => new three__WEBPACK_IMPORTED_MODULE_5__.Vector2());\n  const inject = react__WEBPACK_IMPORTED_MODULE_0__.useCallback((rootState, injectState) => {\n    const intersect = {\n      ...rootState\n    }; // all prev state props\n\n    // Only the fields of \"rootState\" that do not differ from injectState\n    // Some props should be off-limits\n    // Otherwise filter out the props that are different and let the inject layer take precedence\n    Object.keys(rootState).forEach(key => {\n      if (\n      // Some props should be off-limits\n      privateKeys.includes(key) ||\n      // Otherwise filter out the props that are different and let the inject layer take precedence\n      // Unless the inject layer props is undefined, then we keep the root layer\n      rootState[key] !== injectState[key] && injectState[key]) {\n        delete intersect[key];\n      }\n    });\n    let viewport = undefined;\n    if (injectState && size) {\n      const camera = injectState.camera;\n      // Calculate the override viewport, if present\n      viewport = rootState.viewport.getCurrentViewport(camera, new three__WEBPACK_IMPORTED_MODULE_5__.Vector3(), size);\n      // Update the portal camera, if it differs from the previous layer\n      if (camera !== rootState.camera) updateCamera(camera, size);\n    }\n    return {\n      // The intersect consists of the previous root state\n      ...intersect,\n      // Portals have their own scene, which forms the root, a raycaster and a pointer\n      scene: container,\n      raycaster,\n      pointer,\n      mouse: pointer,\n      // Their previous root is the layer before it\n      previousRoot,\n      // Events, size and viewport can be overridden by the inject layer\n      events: {\n        ...rootState.events,\n        ...(injectState == null ? void 0 : injectState.events),\n        ...events\n      },\n      size: {\n        ...rootState.size,\n        ...size\n      },\n      viewport: {\n        ...rootState.viewport,\n        ...viewport\n      },\n      ...rest\n    };\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [state]);\n  const [usePortalStore] = react__WEBPACK_IMPORTED_MODULE_0__.useState(() => {\n    // Create a mirrored store, based on the previous root with a few overrides ...\n    const previousState = previousRoot.getState();\n    const store = (0,zustand__WEBPACK_IMPORTED_MODULE_6__[\"default\"])((set, get) => ({\n      ...previousState,\n      scene: container,\n      raycaster,\n      pointer,\n      mouse: pointer,\n      previousRoot,\n      events: {\n        ...previousState.events,\n        ...events\n      },\n      size: {\n        ...previousState.size,\n        ...size\n      },\n      ...rest,\n      // Set and get refer to this root-state\n      set,\n      get,\n      // Layers are allowed to override events\n      setEvents: events => set(state => ({\n        ...state,\n        events: {\n          ...state.events,\n          ...events\n        }\n      }))\n    }));\n    return store;\n  });\n  react__WEBPACK_IMPORTED_MODULE_0__.useEffect(() => {\n    // Subscribe to previous root-state and copy changes over to the mirrored portal-state\n    const unsub = previousRoot.subscribe(prev => usePortalStore.setState(state => inject(prev, state)));\n    return () => {\n      unsub();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inject]);\n  react__WEBPACK_IMPORTED_MODULE_0__.useEffect(() => {\n    usePortalStore.setState(injectState => inject(previousRoot.getState(), injectState));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inject]);\n  react__WEBPACK_IMPORTED_MODULE_0__.useEffect(() => {\n    return () => {\n      usePortalStore.destroy();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment, {\n    children: reconciler.createPortal( /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(context.Provider, {\n      value: usePortalStore,\n      children: children\n    }), usePortalStore, null)\n  });\n}\nreconciler.injectIntoDevTools({\n  bundleType:  false ? 0 : 1,\n  rendererPackageName: '@react-three/fiber',\n  version: react__WEBPACK_IMPORTED_MODULE_0__.version\n});\nconst act = react__WEBPACK_IMPORTED_MODULE_0__.unstable_act;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2ZpYmVyL2Rpc3QvaW5kZXgtYmE4YWZhYTQuZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFDQTtBQUNtRztBQUNyRztBQUNhO0FBQ21DO0FBQ3JCO0FBQ047O0FBRWxEO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILGtCQUFrQixzQkFBc0IsRUFBRSxjQUFjO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBLGdDQUFnQyxNQUFNO0FBQ3RDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBLDhCQUE4QixpREFBb0IscUNBQXFDLDZCQUE2QiwyQ0FBYztBQUNsSTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVixxQ0FBcUMsMENBQWE7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLCtVQUErVTtBQUMvVTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0JBQXdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEZBQThGO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3QkFBd0IsaUJBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIseUNBQVk7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsNkNBQWdCO0FBQ2hDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDBDQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssMERBQTBELE1BQU0sSUFBSSx1Q0FBdUM7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixzREFBTztBQUN6QjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsc0RBQU87QUFDaEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsb0RBQUs7QUFDZDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELGdCQUFnQixnREFBbUI7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxzRUFBYztBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsNENBQWU7QUFDbEQsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCx5Q0FBWTtBQUM5RCxxRUFBcUUscURBQXdCLDhCQUE4QixvREFBdUI7QUFDbEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyx3Q0FBVztBQUMvQztBQUNBLFVBQVU7QUFDVixzQkFBc0Isd0NBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG1EQUFzQjtBQUNwRCxVQUFVO0FBQ1Y7QUFDQTtBQUNBLG1CQUFtQixpREFBb0I7QUFDdkMsd0JBQXdCLCtDQUFrQjtBQUMxQyxrQkFBa0IsbURBQXNCO0FBQ3hDLHNCQUFzQiwrQ0FBa0I7QUFDeEM7QUFDQSwyRkFBMkYsbURBQXNCO0FBQ2pILFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRFQUE0RTtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixnREFBbUIsR0FBRyx3REFBMkI7QUFDL0UsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHNEQUFHO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHNCQUFzQixzREFBRztBQUN6QjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHNEQUFHO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLG1CQUFtQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLHNCQUFzQiwyQ0FBYyxXQUFXLDRDQUFlO0FBQzlELG9CQUFvQiwyQ0FBYyxXQUFXLDBDQUFhO0FBQzFELGlCQUFpQiw4Q0FBaUI7QUFDbEM7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLDBDQUFhO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDJCQUEyQiwyQ0FBYztBQUN6QztBQUNBO0FBQ0Esa0JBQWtCLG1EQUFNO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsRUFBRSw0Q0FBZTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSw0Q0FBZTtBQUNqQjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsNENBQWU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsc0JBQXNCLHNEQUFHLENBQUMsdURBQVE7QUFDbEMsb0RBQW9ELHNEQUFHO0FBQ3ZEO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQSxjQUFjLE1BQXFDLEdBQUcsQ0FBQztBQUN2RDtBQUNBLFdBQVcsMENBQWE7QUFDeEIsQ0FBQztBQUNELFlBQVksK0NBQWtCOztBQUV1aEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW5qeW90aS1sZWFybmluZy8uL25vZGVfbW9kdWxlcy9AcmVhY3QtdGhyZWUvZmliZXIvZGlzdC9pbmRleC1iYThhZmFhNC5lc20uanM/N2I0NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBEZWZhdWx0RXZlbnRQcmlvcml0eSwgQ29udGludW91c0V2ZW50UHJpb3JpdHksIERpc2NyZXRlRXZlbnRQcmlvcml0eSwgQ29uY3VycmVudFJvb3QgfSBmcm9tICdyZWFjdC1yZWNvbmNpbGVyL2NvbnN0YW50cyc7XG5pbXBvcnQgY3JlYXRlIGZyb20gJ3p1c3RhbmQnO1xuaW1wb3J0IFJlY29uY2lsZXIgZnJvbSAncmVhY3QtcmVjb25jaWxlcic7XG5pbXBvcnQgeyB1bnN0YWJsZV9zY2hlZHVsZUNhbGxiYWNrLCB1bnN0YWJsZV9JZGxlUHJpb3JpdHkgfSBmcm9tICdzY2hlZHVsZXInO1xuaW1wb3J0IHsgc3VzcGVuZCwgcHJlbG9hZCwgY2xlYXIgfSBmcm9tICdzdXNwZW5kLXJlYWN0JztcbmltcG9ydCB7IGpzeCwgRnJhZ21lbnQgfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5cbnZhciB0aHJlZVR5cGVzID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGxcbn0pO1xuXG5jb25zdCBjYXRhbG9ndWUgPSB7fTtcbmNvbnN0IGV4dGVuZCA9IG9iamVjdHMgPT4gdm9pZCBPYmplY3QuYXNzaWduKGNhdGFsb2d1ZSwgb2JqZWN0cyk7XG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJlcihfcm9vdHMsIF9nZXRFdmVudFByaW9yaXR5KSB7XG4gIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKHR5cGUsIHtcbiAgICBhcmdzID0gW10sXG4gICAgYXR0YWNoLFxuICAgIC4uLnByb3BzXG4gIH0sIHJvb3QpIHtcbiAgICBsZXQgbmFtZSA9IGAke3R5cGVbMF0udG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSl9YDtcbiAgICBsZXQgaW5zdGFuY2U7XG4gICAgaWYgKHR5cGUgPT09ICdwcmltaXRpdmUnKSB7XG4gICAgICBpZiAocHJvcHMub2JqZWN0ID09PSB1bmRlZmluZWQpIHRocm93IG5ldyBFcnJvcihcIlIzRjogUHJpbWl0aXZlcyB3aXRob3V0ICdvYmplY3QnIGFyZSBpbnZhbGlkIVwiKTtcbiAgICAgIGNvbnN0IG9iamVjdCA9IHByb3BzLm9iamVjdDtcbiAgICAgIGluc3RhbmNlID0gcHJlcGFyZShvYmplY3QsIHtcbiAgICAgICAgdHlwZSxcbiAgICAgICAgcm9vdCxcbiAgICAgICAgYXR0YWNoLFxuICAgICAgICBwcmltaXRpdmU6IHRydWVcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSBjYXRhbG9ndWVbbmFtZV07XG4gICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFIzRjogJHtuYW1lfSBpcyBub3QgcGFydCBvZiB0aGUgVEhSRUUgbmFtZXNwYWNlISBEaWQgeW91IGZvcmdldCB0byBleHRlbmQ/IFNlZTogaHR0cHM6Ly9kb2NzLnBtbmQucnMvcmVhY3QtdGhyZWUtZmliZXIvYXBpL29iamVjdHMjdXNpbmctM3JkLXBhcnR5LW9iamVjdHMtZGVjbGFyYXRpdmVseWApO1xuICAgICAgfVxuXG4gICAgICAvLyBUaHJvdyBpZiBhbiBvYmplY3Qgb3IgbGl0ZXJhbCB3YXMgcGFzc2VkIGZvciBhcmdzXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJncykpIHRocm93IG5ldyBFcnJvcignUjNGOiBUaGUgYXJncyBwcm9wIG11c3QgYmUgYW4gYXJyYXkhJyk7XG5cbiAgICAgIC8vIEluc3RhbmNpYXRlIG5ldyBvYmplY3QsIGxpbmsgaXQgdG8gdGhlIHJvb3RcbiAgICAgIC8vIEFwcGVuZCBtZW1vaXplZCBwcm9wcyB3aXRoIGFyZ3Mgc28gaXQncyBub3QgZm9yZ290dGVuXG4gICAgICBpbnN0YW5jZSA9IHByZXBhcmUobmV3IHRhcmdldCguLi5hcmdzKSwge1xuICAgICAgICB0eXBlLFxuICAgICAgICByb290LFxuICAgICAgICBhdHRhY2gsXG4gICAgICAgIC8vIFNhdmUgYXJncyBpbiBjYXNlIHdlIG5lZWQgdG8gcmVjb25zdHJ1Y3QgbGF0ZXIgZm9yIEhNUlxuICAgICAgICBtZW1vaXplZFByb3BzOiB7XG4gICAgICAgICAgYXJnc1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBBdXRvLWF0dGFjaCBnZW9tZXRyaWVzIGFuZCBtYXRlcmlhbHNcbiAgICBpZiAoaW5zdGFuY2UuX19yM2YuYXR0YWNoID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChpbnN0YW5jZSBpbnN0YW5jZW9mIFRIUkVFLkJ1ZmZlckdlb21ldHJ5KSBpbnN0YW5jZS5fX3IzZi5hdHRhY2ggPSAnZ2VvbWV0cnknO2Vsc2UgaWYgKGluc3RhbmNlIGluc3RhbmNlb2YgVEhSRUUuTWF0ZXJpYWwpIGluc3RhbmNlLl9fcjNmLmF0dGFjaCA9ICdtYXRlcmlhbCc7XG4gICAgfVxuXG4gICAgLy8gSXQgc2hvdWxkIE5PVCBjYWxsIG9uVXBkYXRlIG9uIG9iamVjdCBpbnN0YW5jaWF0aW9uLCBiZWNhdXNlIGl0IGhhc24ndCBiZWVuIGFkZGVkIHRvIHRoZVxuICAgIC8vIHZpZXcgeWV0LiBJZiB0aGUgY2FsbGJhY2sgcmVsaWVzIG9uIHJlZmVyZW5jZXMgZm9yIGluc3RhbmNlLCB0aGV5IHdvbid0IGJlIHJlYWR5IHlldCwgdGhpcyBpc1xuICAgIC8vIHdoeSBpdCBwYXNzZXMgXCJ0cnVlXCIgaGVyZVxuICAgIC8vIFRoZXJlIGlzIG5vIHJlYXNvbiB0byBhcHBseSBwcm9wcyB0byBpbmplY3RzXG4gICAgaWYgKG5hbWUgIT09ICdpbmplY3QnKSBhcHBseVByb3BzJDEoaW5zdGFuY2UsIHByb3BzKTtcbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH1cbiAgZnVuY3Rpb24gYXBwZW5kQ2hpbGQocGFyZW50SW5zdGFuY2UsIGNoaWxkKSB7XG4gICAgbGV0IGFkZGVkID0gZmFsc2U7XG4gICAgaWYgKGNoaWxkKSB7XG4gICAgICB2YXIgX2NoaWxkJF9fcjNmLCBfcGFyZW50SW5zdGFuY2UkX19yM2Y7XG4gICAgICAvLyBUaGUgYXR0YWNoIGF0dHJpYnV0ZSBpbXBsaWVzIHRoYXQgdGhlIG9iamVjdCBhdHRhY2hlcyBpdHNlbGYgb24gdGhlIHBhcmVudFxuICAgICAgaWYgKChfY2hpbGQkX19yM2YgPSBjaGlsZC5fX3IzZikgIT0gbnVsbCAmJiBfY2hpbGQkX19yM2YuYXR0YWNoKSB7XG4gICAgICAgIGF0dGFjaChwYXJlbnRJbnN0YW5jZSwgY2hpbGQsIGNoaWxkLl9fcjNmLmF0dGFjaCk7XG4gICAgICB9IGVsc2UgaWYgKGNoaWxkLmlzT2JqZWN0M0QgJiYgcGFyZW50SW5zdGFuY2UuaXNPYmplY3QzRCkge1xuICAgICAgICAvLyBhZGQgaW4gdGhlIHVzdWFsIHBhcmVudC1jaGlsZCB3YXlcbiAgICAgICAgcGFyZW50SW5zdGFuY2UuYWRkKGNoaWxkKTtcbiAgICAgICAgYWRkZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgLy8gVGhpcyBpcyBmb3IgYW55dGhpbmcgdGhhdCB1c2VkIGF0dGFjaCwgYW5kIGZvciBub24tT2JqZWN0M0RzIHRoYXQgZG9uJ3QgZ2V0IGF0dGFjaGVkIHRvIHByb3BzO1xuICAgICAgLy8gdGhhdCBpcywgYW55dGhpbmcgdGhhdCdzIGEgY2hpbGQgaW4gUmVhY3QgYnV0IG5vdCBhIGNoaWxkIGluIHRoZSBzY2VuZWdyYXBoLlxuICAgICAgaWYgKCFhZGRlZCkgKF9wYXJlbnRJbnN0YW5jZSRfX3IzZiA9IHBhcmVudEluc3RhbmNlLl9fcjNmKSA9PSBudWxsID8gdm9pZCAwIDogX3BhcmVudEluc3RhbmNlJF9fcjNmLm9iamVjdHMucHVzaChjaGlsZCk7XG4gICAgICBpZiAoIWNoaWxkLl9fcjNmKSBwcmVwYXJlKGNoaWxkLCB7fSk7XG4gICAgICBjaGlsZC5fX3IzZi5wYXJlbnQgPSBwYXJlbnRJbnN0YW5jZTtcbiAgICAgIHVwZGF0ZUluc3RhbmNlKGNoaWxkKTtcbiAgICAgIGludmFsaWRhdGVJbnN0YW5jZShjaGlsZCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGluc2VydEJlZm9yZShwYXJlbnRJbnN0YW5jZSwgY2hpbGQsIGJlZm9yZUNoaWxkKSB7XG4gICAgbGV0IGFkZGVkID0gZmFsc2U7XG4gICAgaWYgKGNoaWxkKSB7XG4gICAgICB2YXIgX2NoaWxkJF9fcjNmMiwgX3BhcmVudEluc3RhbmNlJF9fcjNmMjtcbiAgICAgIGlmICgoX2NoaWxkJF9fcjNmMiA9IGNoaWxkLl9fcjNmKSAhPSBudWxsICYmIF9jaGlsZCRfX3IzZjIuYXR0YWNoKSB7XG4gICAgICAgIGF0dGFjaChwYXJlbnRJbnN0YW5jZSwgY2hpbGQsIGNoaWxkLl9fcjNmLmF0dGFjaCk7XG4gICAgICB9IGVsc2UgaWYgKGNoaWxkLmlzT2JqZWN0M0QgJiYgcGFyZW50SW5zdGFuY2UuaXNPYmplY3QzRCkge1xuICAgICAgICBjaGlsZC5wYXJlbnQgPSBwYXJlbnRJbnN0YW5jZTtcbiAgICAgICAgY2hpbGQuZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgICAgdHlwZTogJ2FkZGVkJ1xuICAgICAgICB9KTtcbiAgICAgICAgcGFyZW50SW5zdGFuY2UuZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgICAgdHlwZTogJ2NoaWxkYWRkZWQnLFxuICAgICAgICAgIGNoaWxkXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCByZXN0U2libGluZ3MgPSBwYXJlbnRJbnN0YW5jZS5jaGlsZHJlbi5maWx0ZXIoc2libGluZyA9PiBzaWJsaW5nICE9PSBjaGlsZCk7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gcmVzdFNpYmxpbmdzLmluZGV4T2YoYmVmb3JlQ2hpbGQpO1xuICAgICAgICBwYXJlbnRJbnN0YW5jZS5jaGlsZHJlbiA9IFsuLi5yZXN0U2libGluZ3Muc2xpY2UoMCwgaW5kZXgpLCBjaGlsZCwgLi4ucmVzdFNpYmxpbmdzLnNsaWNlKGluZGV4KV07XG4gICAgICAgIGFkZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICghYWRkZWQpIChfcGFyZW50SW5zdGFuY2UkX19yM2YyID0gcGFyZW50SW5zdGFuY2UuX19yM2YpID09IG51bGwgPyB2b2lkIDAgOiBfcGFyZW50SW5zdGFuY2UkX19yM2YyLm9iamVjdHMucHVzaChjaGlsZCk7XG4gICAgICBpZiAoIWNoaWxkLl9fcjNmKSBwcmVwYXJlKGNoaWxkLCB7fSk7XG4gICAgICBjaGlsZC5fX3IzZi5wYXJlbnQgPSBwYXJlbnRJbnN0YW5jZTtcbiAgICAgIHVwZGF0ZUluc3RhbmNlKGNoaWxkKTtcbiAgICAgIGludmFsaWRhdGVJbnN0YW5jZShjaGlsZCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHJlbW92ZVJlY3Vyc2l2ZShhcnJheSwgcGFyZW50LCBkaXNwb3NlID0gZmFsc2UpIHtcbiAgICBpZiAoYXJyYXkpIFsuLi5hcnJheV0uZm9yRWFjaChjaGlsZCA9PiByZW1vdmVDaGlsZChwYXJlbnQsIGNoaWxkLCBkaXNwb3NlKSk7XG4gIH1cbiAgZnVuY3Rpb24gcmVtb3ZlQ2hpbGQocGFyZW50SW5zdGFuY2UsIGNoaWxkLCBkaXNwb3NlKSB7XG4gICAgaWYgKGNoaWxkKSB7XG4gICAgICB2YXIgX3BhcmVudEluc3RhbmNlJF9fcjNmMywgX2NoaWxkJF9fcjNmMywgX2NoaWxkJF9fcjNmNTtcbiAgICAgIC8vIENsZWFyIHRoZSBwYXJlbnQgcmVmZXJlbmNlXG4gICAgICBpZiAoY2hpbGQuX19yM2YpIGNoaWxkLl9fcjNmLnBhcmVudCA9IG51bGw7XG4gICAgICAvLyBSZW1vdmUgY2hpbGQgZnJvbSB0aGUgcGFyZW50cyBvYmplY3RzXG4gICAgICBpZiAoKF9wYXJlbnRJbnN0YW5jZSRfX3IzZjMgPSBwYXJlbnRJbnN0YW5jZS5fX3IzZikgIT0gbnVsbCAmJiBfcGFyZW50SW5zdGFuY2UkX19yM2YzLm9iamVjdHMpIHBhcmVudEluc3RhbmNlLl9fcjNmLm9iamVjdHMgPSBwYXJlbnRJbnN0YW5jZS5fX3IzZi5vYmplY3RzLmZpbHRlcih4ID0+IHggIT09IGNoaWxkKTtcbiAgICAgIC8vIFJlbW92ZSBhdHRhY2htZW50XG4gICAgICBpZiAoKF9jaGlsZCRfX3IzZjMgPSBjaGlsZC5fX3IzZikgIT0gbnVsbCAmJiBfY2hpbGQkX19yM2YzLmF0dGFjaCkge1xuICAgICAgICBkZXRhY2gocGFyZW50SW5zdGFuY2UsIGNoaWxkLCBjaGlsZC5fX3IzZi5hdHRhY2gpO1xuICAgICAgfSBlbHNlIGlmIChjaGlsZC5pc09iamVjdDNEICYmIHBhcmVudEluc3RhbmNlLmlzT2JqZWN0M0QpIHtcbiAgICAgICAgdmFyIF9jaGlsZCRfX3IzZjQ7XG4gICAgICAgIHBhcmVudEluc3RhbmNlLnJlbW92ZShjaGlsZCk7XG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgICAgLy8gUmVtb3ZlIGludGVyYWN0aXZpdHkgb24gdGhlIGluaXRpYWwgcm9vdFxuICAgICAgICBpZiAoKF9jaGlsZCRfX3IzZjQgPSBjaGlsZC5fX3IzZikgIT0gbnVsbCAmJiBfY2hpbGQkX19yM2Y0LnJvb3QpIHtcbiAgICAgICAgICByZW1vdmVJbnRlcmFjdGl2aXR5KGZpbmRJbml0aWFsUm9vdChjaGlsZCksIGNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBBbGxvdyBvYmplY3RzIHRvIGJhaWwgb3V0IG9mIHJlY3Vyc2l2ZSBkaXNwb3NlIGFsdG9nZXRoZXIgYnkgcGFzc2luZyBkaXNwb3NlPXtudWxsfVxuICAgICAgLy8gTmV2ZXIgZGlzcG9zZSBvZiBwcmltaXRpdmVzIGJlY2F1c2UgdGhlaXIgc3RhdGUgbWF5IGJlIGtlcHQgb3V0c2lkZSBvZiBSZWFjdCFcbiAgICAgIC8vIEluIG9yZGVyIGZvciBhbiBvYmplY3QgdG8gYmUgYWJsZSB0byBkaXNwb3NlIGl0IGhhcyB0byBoYXZlXG4gICAgICAvLyAgIC0gYSBkaXNwb3NlIG1ldGhvZCxcbiAgICAgIC8vICAgLSBpdCBjYW5ub3QgYmUgYSA8cHJpbWl0aXZlIG9iamVjdD17Li4ufSAvPlxuICAgICAgLy8gICAtIGl0IGNhbm5vdCBiZSBhIFRIUkVFLlNjZW5lLCBiZWNhdXNlIHRocmVlIGhhcyBicm9rZW4gaXQncyBvd24gYXBpXG4gICAgICAvL1xuICAgICAgLy8gU2luY2UgZGlzcG9zYWwgaXMgcmVjdXJzaXZlLCB3ZSBjYW4gY2hlY2sgdGhlIG9wdGlvbmFsIGRpc3Bvc2UgYXJnLCB3aGljaCB3aWxsIGJlIHVuZGVmaW5lZFxuICAgICAgLy8gd2hlbiB0aGUgcmVjb25jaWxlciBjYWxscyBpdCwgYnV0IHRoZW4gY2Fycnkgb3VyIG93biBjaGVjayByZWN1cnNpdmVseVxuICAgICAgY29uc3QgaXNQcmltaXRpdmUgPSAoX2NoaWxkJF9fcjNmNSA9IGNoaWxkLl9fcjNmKSA9PSBudWxsID8gdm9pZCAwIDogX2NoaWxkJF9fcjNmNS5wcmltaXRpdmU7XG4gICAgICBjb25zdCBzaG91bGREaXNwb3NlID0gIWlzUHJpbWl0aXZlICYmIChkaXNwb3NlID09PSB1bmRlZmluZWQgPyBjaGlsZC5kaXNwb3NlICE9PSBudWxsIDogZGlzcG9zZSk7XG5cbiAgICAgIC8vIFJlbW92ZSBuZXN0ZWQgY2hpbGQgb2JqZWN0cy4gUHJpbWl0aXZlcyBzaG91bGQgbm90IGhhdmUgb2JqZWN0cyBhbmQgY2hpbGRyZW4gdGhhdCBhcmVcbiAgICAgIC8vIGF0dGFjaGVkIHRvIHRoZW0gZGVjbGFyYXRpdmVseSAuLi5cbiAgICAgIGlmICghaXNQcmltaXRpdmUpIHtcbiAgICAgICAgdmFyIF9jaGlsZCRfX3IzZjY7XG4gICAgICAgIHJlbW92ZVJlY3Vyc2l2ZSgoX2NoaWxkJF9fcjNmNiA9IGNoaWxkLl9fcjNmKSA9PSBudWxsID8gdm9pZCAwIDogX2NoaWxkJF9fcjNmNi5vYmplY3RzLCBjaGlsZCwgc2hvdWxkRGlzcG9zZSk7XG4gICAgICAgIHJlbW92ZVJlY3Vyc2l2ZShjaGlsZC5jaGlsZHJlbiwgY2hpbGQsIHNob3VsZERpc3Bvc2UpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZW1vdmUgcmVmZXJlbmNlc1xuICAgICAgZGVsZXRlIGNoaWxkLl9fcjNmO1xuXG4gICAgICAvLyBEaXNwb3NlIGl0ZW0gd2hlbmV2ZXIgdGhlIHJlY29uY2lsZXIgZmVlbHMgbGlrZSBpdFxuICAgICAgaWYgKHNob3VsZERpc3Bvc2UgJiYgY2hpbGQuZGlzcG9zZSAmJiBjaGlsZC50eXBlICE9PSAnU2NlbmUnKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjaGlsZC5kaXNwb3NlKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLyogLi4uICovXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFNjaGVkdWxlIGFzeW5jIGF0IHJ1bnRpbWUsIGZsdXNoIHN5bmMgaW4gdGVzdGluZ1xuICAgICAgICBpZiAodHlwZW9mIElTX1JFQUNUX0FDVF9FTlZJUk9OTUVOVCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB1bnN0YWJsZV9zY2hlZHVsZUNhbGxiYWNrKHVuc3RhYmxlX0lkbGVQcmlvcml0eSwgY2FsbGJhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGludmFsaWRhdGVJbnN0YW5jZShwYXJlbnRJbnN0YW5jZSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHN3aXRjaEluc3RhbmNlKGluc3RhbmNlLCB0eXBlLCBuZXdQcm9wcywgZmliZXIpIHtcbiAgICB2YXIgX2luc3RhbmNlJF9fcjNmO1xuICAgIGNvbnN0IHBhcmVudCA9IChfaW5zdGFuY2UkX19yM2YgPSBpbnN0YW5jZS5fX3IzZikgPT0gbnVsbCA/IHZvaWQgMCA6IF9pbnN0YW5jZSRfX3IzZi5wYXJlbnQ7XG4gICAgaWYgKCFwYXJlbnQpIHJldHVybjtcbiAgICBjb25zdCBuZXdJbnN0YW5jZSA9IGNyZWF0ZUluc3RhbmNlKHR5cGUsIG5ld1Byb3BzLCBpbnN0YW5jZS5fX3IzZi5yb290KTtcblxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvaXNzdWVzLzEzNDhcbiAgICAvLyBXaGVuIGFyZ3MgY2hhbmdlIHRoZSBpbnN0YW5jZSBoYXMgdG8gYmUgcmUtY29uc3RydWN0ZWQsIHdoaWNoIHRoZW5cbiAgICAvLyBmb3JjZXMgcjNmIHRvIHJlLXBhcmVudCB0aGUgY2hpbGRyZW4gYW5kIG5vbi1zY2VuZSBvYmplY3RzXG4gICAgaWYgKGluc3RhbmNlLmNoaWxkcmVuKSB7XG4gICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGluc3RhbmNlLmNoaWxkcmVuKSB7XG4gICAgICAgIGlmIChjaGlsZC5fX3IzZikgYXBwZW5kQ2hpbGQobmV3SW5zdGFuY2UsIGNoaWxkKTtcbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLmNoaWxkcmVuID0gaW5zdGFuY2UuY2hpbGRyZW4uZmlsdGVyKGNoaWxkID0+ICFjaGlsZC5fX3IzZik7XG4gICAgfVxuICAgIGluc3RhbmNlLl9fcjNmLm9iamVjdHMuZm9yRWFjaChjaGlsZCA9PiBhcHBlbmRDaGlsZChuZXdJbnN0YW5jZSwgY2hpbGQpKTtcbiAgICBpbnN0YW5jZS5fX3IzZi5vYmplY3RzID0gW107XG4gICAgaWYgKCFpbnN0YW5jZS5fX3IzZi5hdXRvUmVtb3ZlZEJlZm9yZUFwcGVuZCkge1xuICAgICAgcmVtb3ZlQ2hpbGQocGFyZW50LCBpbnN0YW5jZSk7XG4gICAgfVxuICAgIGlmIChuZXdJbnN0YW5jZS5wYXJlbnQpIHtcbiAgICAgIG5ld0luc3RhbmNlLl9fcjNmLmF1dG9SZW1vdmVkQmVmb3JlQXBwZW5kID0gdHJ1ZTtcbiAgICB9XG4gICAgYXBwZW5kQ2hpbGQocGFyZW50LCBuZXdJbnN0YW5jZSk7XG5cbiAgICAvLyBSZS1iaW5kIGV2ZW50IGhhbmRsZXJzIG9uIHRoZSBpbml0aWFsIHJvb3RcbiAgICBpZiAobmV3SW5zdGFuY2UucmF5Y2FzdCAmJiBuZXdJbnN0YW5jZS5fX3IzZi5ldmVudENvdW50KSB7XG4gICAgICBjb25zdCByb290U3RhdGUgPSBmaW5kSW5pdGlhbFJvb3QobmV3SW5zdGFuY2UpLmdldFN0YXRlKCk7XG4gICAgICByb290U3RhdGUuaW50ZXJuYWwuaW50ZXJhY3Rpb24ucHVzaChuZXdJbnN0YW5jZSk7XG4gICAgfVxuICAgIFtmaWJlciwgZmliZXIuYWx0ZXJuYXRlXS5mb3JFYWNoKGZpYmVyID0+IHtcbiAgICAgIGlmIChmaWJlciAhPT0gbnVsbCkge1xuICAgICAgICBmaWJlci5zdGF0ZU5vZGUgPSBuZXdJbnN0YW5jZTtcbiAgICAgICAgaWYgKGZpYmVyLnJlZikge1xuICAgICAgICAgIGlmICh0eXBlb2YgZmliZXIucmVmID09PSAnZnVuY3Rpb24nKSBmaWJlci5yZWYobmV3SW5zdGFuY2UpO2Vsc2UgZmliZXIucmVmLmN1cnJlbnQgPSBuZXdJbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLy8gRG9uJ3QgaGFuZGxlIHRleHQgaW5zdGFuY2VzLCB3YXJuIG9uIHVuZGVmaW5lZCBiZWhhdmlvclxuICBjb25zdCBoYW5kbGVUZXh0SW5zdGFuY2UgPSAoKSA9PiBjb25zb2xlLndhcm4oJ1RleHQgaXMgbm90IGFsbG93ZWQgaW4gdGhlIFIzRiB0cmVlISBUaGlzIGNvdWxkIGJlIHN0cmF5IHdoaXRlc3BhY2Ugb3IgY2hhcmFjdGVycy4nKTtcbiAgY29uc3QgcmVjb25jaWxlciA9IFJlY29uY2lsZXIoe1xuICAgIGNyZWF0ZUluc3RhbmNlLFxuICAgIHJlbW92ZUNoaWxkLFxuICAgIGFwcGVuZENoaWxkLFxuICAgIGFwcGVuZEluaXRpYWxDaGlsZDogYXBwZW5kQ2hpbGQsXG4gICAgaW5zZXJ0QmVmb3JlLFxuICAgIHN1cHBvcnRzTXV0YXRpb246IHRydWUsXG4gICAgaXNQcmltYXJ5UmVuZGVyZXI6IGZhbHNlLFxuICAgIHN1cHBvcnRzUGVyc2lzdGVuY2U6IGZhbHNlLFxuICAgIHN1cHBvcnRzSHlkcmF0aW9uOiBmYWxzZSxcbiAgICBub1RpbWVvdXQ6IC0xLFxuICAgIGFwcGVuZENoaWxkVG9Db250YWluZXI6IChjb250YWluZXIsIGNoaWxkKSA9PiB7XG4gICAgICBpZiAoIWNoaWxkKSByZXR1cm47XG5cbiAgICAgIC8vIERvbid0IGFwcGVuZCB0byB1bm1vdW50ZWQgY29udGFpbmVyXG4gICAgICBjb25zdCBzY2VuZSA9IGNvbnRhaW5lci5nZXRTdGF0ZSgpLnNjZW5lO1xuICAgICAgaWYgKCFzY2VuZS5fX3IzZikgcmV0dXJuO1xuXG4gICAgICAvLyBMaW5rIGN1cnJlbnQgcm9vdCB0byB0aGUgZGVmYXVsdCBzY2VuZVxuICAgICAgc2NlbmUuX19yM2Yucm9vdCA9IGNvbnRhaW5lcjtcbiAgICAgIGFwcGVuZENoaWxkKHNjZW5lLCBjaGlsZCk7XG4gICAgfSxcbiAgICByZW1vdmVDaGlsZEZyb21Db250YWluZXI6IChjb250YWluZXIsIGNoaWxkKSA9PiB7XG4gICAgICBpZiAoIWNoaWxkKSByZXR1cm47XG4gICAgICByZW1vdmVDaGlsZChjb250YWluZXIuZ2V0U3RhdGUoKS5zY2VuZSwgY2hpbGQpO1xuICAgIH0sXG4gICAgaW5zZXJ0SW5Db250YWluZXJCZWZvcmU6IChjb250YWluZXIsIGNoaWxkLCBiZWZvcmVDaGlsZCkgPT4ge1xuICAgICAgaWYgKCFjaGlsZCB8fCAhYmVmb3JlQ2hpbGQpIHJldHVybjtcblxuICAgICAgLy8gRG9uJ3QgYXBwZW5kIHRvIHVubW91bnRlZCBjb250YWluZXJcbiAgICAgIGNvbnN0IHNjZW5lID0gY29udGFpbmVyLmdldFN0YXRlKCkuc2NlbmU7XG4gICAgICBpZiAoIXNjZW5lLl9fcjNmKSByZXR1cm47XG4gICAgICBpbnNlcnRCZWZvcmUoc2NlbmUsIGNoaWxkLCBiZWZvcmVDaGlsZCk7XG4gICAgfSxcbiAgICBnZXRSb290SG9zdENvbnRleHQ6ICgpID0+IG51bGwsXG4gICAgZ2V0Q2hpbGRIb3N0Q29udGV4dDogcGFyZW50SG9zdENvbnRleHQgPT4gcGFyZW50SG9zdENvbnRleHQsXG4gICAgZmluYWxpemVJbml0aWFsQ2hpbGRyZW4oaW5zdGFuY2UpIHtcbiAgICAgIHZhciBfaW5zdGFuY2UkX19yM2YyO1xuICAgICAgY29uc3QgbG9jYWxTdGF0ZSA9IChfaW5zdGFuY2UkX19yM2YyID0gaW5zdGFuY2UgPT0gbnVsbCA/IHZvaWQgMCA6IGluc3RhbmNlLl9fcjNmKSAhPSBudWxsID8gX2luc3RhbmNlJF9fcjNmMiA6IHt9O1xuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8yMDI3MVxuICAgICAgLy8gUmV0dXJuaW5nIHRydWUgd2lsbCB0cmlnZ2VyIGNvbW1pdE1vdW50XG4gICAgICByZXR1cm4gQm9vbGVhbihsb2NhbFN0YXRlLmhhbmRsZXJzKTtcbiAgICB9LFxuICAgIHByZXBhcmVVcGRhdGUoaW5zdGFuY2UsIF90eXBlLCBvbGRQcm9wcywgbmV3UHJvcHMpIHtcbiAgICAgIHZhciBfaW5zdGFuY2UkX19yM2YzO1xuICAgICAgY29uc3QgbG9jYWxTdGF0ZSA9IChfaW5zdGFuY2UkX19yM2YzID0gaW5zdGFuY2UgPT0gbnVsbCA/IHZvaWQgMCA6IGluc3RhbmNlLl9fcjNmKSAhPSBudWxsID8gX2luc3RhbmNlJF9fcjNmMyA6IHt9O1xuXG4gICAgICAvLyBDcmVhdGUgZGlmZi1zZXRzXG4gICAgICBpZiAobG9jYWxTdGF0ZS5wcmltaXRpdmUgJiYgbmV3UHJvcHMub2JqZWN0ICYmIG5ld1Byb3BzLm9iamVjdCAhPT0gaW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIFt0cnVlXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRoaXMgaXMgYSBkYXRhIG9iamVjdCwgbGV0J3MgZXh0cmFjdCBjcml0aWNhbCBpbmZvcm1hdGlvbiBhYm91dCBpdFxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgYXJnczogYXJnc05ldyA9IFtdLFxuICAgICAgICAgIGNoaWxkcmVuOiBjTixcbiAgICAgICAgICAuLi5yZXN0TmV3XG4gICAgICAgIH0gPSBuZXdQcm9wcztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGFyZ3M6IGFyZ3NPbGQgPSBbXSxcbiAgICAgICAgICBjaGlsZHJlbjogY08sXG4gICAgICAgICAgLi4ucmVzdE9sZFxuICAgICAgICB9ID0gb2xkUHJvcHM7XG5cbiAgICAgICAgLy8gVGhyb3cgaWYgYW4gb2JqZWN0IG9yIGxpdGVyYWwgd2FzIHBhc3NlZCBmb3IgYXJnc1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJnc05ldykpIHRocm93IG5ldyBFcnJvcignUjNGOiB0aGUgYXJncyBwcm9wIG11c3QgYmUgYW4gYXJyYXkhJyk7XG5cbiAgICAgICAgLy8gSWYgaXQgaGFzIG5ldyBwcm9wcyBvciBhcmd1bWVudHMsIHRoZW4gaXQgbmVlZHMgdG8gYmUgcmUtaW5zdGFudGlhdGVkXG4gICAgICAgIGlmIChhcmdzTmV3LnNvbWUoKHZhbHVlLCBpbmRleCkgPT4gdmFsdWUgIT09IGFyZ3NPbGRbaW5kZXhdKSkgcmV0dXJuIFt0cnVlXTtcbiAgICAgICAgLy8gQ3JlYXRlIGEgZGlmZi1zZXQsIGZsYWcgaWYgdGhlcmUgYXJlIGFueSBjaGFuZ2VzXG4gICAgICAgIGNvbnN0IGRpZmYgPSBkaWZmUHJvcHMoaW5zdGFuY2UsIHJlc3ROZXcsIHJlc3RPbGQsIHRydWUpO1xuICAgICAgICBpZiAoZGlmZi5jaGFuZ2VzLmxlbmd0aCkgcmV0dXJuIFtmYWxzZSwgZGlmZl07XG5cbiAgICAgICAgLy8gT3RoZXJ3aXNlIGRvIG5vdCB0b3VjaCB0aGUgaW5zdGFuY2VcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBjb21taXRVcGRhdGUoaW5zdGFuY2UsIFtyZWNvbnN0cnVjdCwgZGlmZl0sIHR5cGUsIF9vbGRQcm9wcywgbmV3UHJvcHMsIGZpYmVyKSB7XG4gICAgICAvLyBSZWNvbnN0cnVjdCB3aGVuIGFyZ3Mgb3IgPHByaW1pdGl2ZSBvYmplY3Q9ey4uLn0gaGF2ZSBjaGFuZ2VzXG4gICAgICBpZiAocmVjb25zdHJ1Y3QpIHN3aXRjaEluc3RhbmNlKGluc3RhbmNlLCB0eXBlLCBuZXdQcm9wcywgZmliZXIpO1xuICAgICAgLy8gT3RoZXJ3aXNlIGp1c3Qgb3ZlcndyaXRlIHByb3BzXG4gICAgICBlbHNlIGFwcGx5UHJvcHMkMShpbnN0YW5jZSwgZGlmZik7XG4gICAgfSxcbiAgICBjb21taXRNb3VudChpbnN0YW5jZSwgX3R5cGUsIF9wcm9wcywgX2ludCkge1xuICAgICAgdmFyIF9pbnN0YW5jZSRfX3IzZjQ7XG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzIwMjcxXG4gICAgICAvLyBUaGlzIHdpbGwgbWFrZSBzdXJlIGV2ZW50cyBhcmUgb25seSBhZGRlZCBvbmNlIHRvIHRoZSBjZW50cmFsIGNvbnRhaW5lciBvbiB0aGUgaW5pdGlhbCByb290XG4gICAgICBjb25zdCBsb2NhbFN0YXRlID0gKF9pbnN0YW5jZSRfX3IzZjQgPSBpbnN0YW5jZS5fX3IzZikgIT0gbnVsbCA/IF9pbnN0YW5jZSRfX3IzZjQgOiB7fTtcbiAgICAgIGlmIChpbnN0YW5jZS5yYXljYXN0ICYmIGxvY2FsU3RhdGUuaGFuZGxlcnMgJiYgbG9jYWxTdGF0ZS5ldmVudENvdW50KSB7XG4gICAgICAgIGZpbmRJbml0aWFsUm9vdChpbnN0YW5jZSkuZ2V0U3RhdGUoKS5pbnRlcm5hbC5pbnRlcmFjdGlvbi5wdXNoKGluc3RhbmNlKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGdldFB1YmxpY0luc3RhbmNlOiBpbnN0YW5jZSA9PiBpbnN0YW5jZSxcbiAgICBwcmVwYXJlRm9yQ29tbWl0OiAoKSA9PiBudWxsLFxuICAgIHByZXBhcmVQb3J0YWxNb3VudDogY29udGFpbmVyID0+IHByZXBhcmUoY29udGFpbmVyLmdldFN0YXRlKCkuc2NlbmUpLFxuICAgIHJlc2V0QWZ0ZXJDb21taXQ6ICgpID0+IHt9LFxuICAgIHNob3VsZFNldFRleHRDb250ZW50OiAoKSA9PiBmYWxzZSxcbiAgICBjbGVhckNvbnRhaW5lcjogKCkgPT4gZmFsc2UsXG4gICAgaGlkZUluc3RhbmNlKGluc3RhbmNlKSB7XG4gICAgICB2YXIgX2luc3RhbmNlJF9fcjNmNTtcbiAgICAgIC8vIERldGFjaCB3aGlsZSB0aGUgaW5zdGFuY2UgaXMgaGlkZGVuXG4gICAgICBjb25zdCB7XG4gICAgICAgIGF0dGFjaDogdHlwZSxcbiAgICAgICAgcGFyZW50XG4gICAgICB9ID0gKF9pbnN0YW5jZSRfX3IzZjUgPSBpbnN0YW5jZS5fX3IzZikgIT0gbnVsbCA/IF9pbnN0YW5jZSRfX3IzZjUgOiB7fTtcbiAgICAgIGlmICh0eXBlICYmIHBhcmVudCkgZGV0YWNoKHBhcmVudCwgaW5zdGFuY2UsIHR5cGUpO1xuICAgICAgaWYgKGluc3RhbmNlLmlzT2JqZWN0M0QpIGluc3RhbmNlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgIGludmFsaWRhdGVJbnN0YW5jZShpbnN0YW5jZSk7XG4gICAgfSxcbiAgICB1bmhpZGVJbnN0YW5jZShpbnN0YW5jZSwgcHJvcHMpIHtcbiAgICAgIHZhciBfaW5zdGFuY2UkX19yM2Y2O1xuICAgICAgLy8gUmUtYXR0YWNoIHdoZW4gdGhlIGluc3RhbmNlIGlzIHVuaGlkZGVuXG4gICAgICBjb25zdCB7XG4gICAgICAgIGF0dGFjaDogdHlwZSxcbiAgICAgICAgcGFyZW50XG4gICAgICB9ID0gKF9pbnN0YW5jZSRfX3IzZjYgPSBpbnN0YW5jZS5fX3IzZikgIT0gbnVsbCA/IF9pbnN0YW5jZSRfX3IzZjYgOiB7fTtcbiAgICAgIGlmICh0eXBlICYmIHBhcmVudCkgYXR0YWNoKHBhcmVudCwgaW5zdGFuY2UsIHR5cGUpO1xuICAgICAgaWYgKGluc3RhbmNlLmlzT2JqZWN0M0QgJiYgcHJvcHMudmlzaWJsZSA9PSBudWxsIHx8IHByb3BzLnZpc2libGUpIGluc3RhbmNlLnZpc2libGUgPSB0cnVlO1xuICAgICAgaW52YWxpZGF0ZUluc3RhbmNlKGluc3RhbmNlKTtcbiAgICB9LFxuICAgIGNyZWF0ZVRleHRJbnN0YW5jZTogaGFuZGxlVGV4dEluc3RhbmNlLFxuICAgIGhpZGVUZXh0SW5zdGFuY2U6IGhhbmRsZVRleHRJbnN0YW5jZSxcbiAgICB1bmhpZGVUZXh0SW5zdGFuY2U6IGhhbmRsZVRleHRJbnN0YW5jZSxcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcG1uZHJzL3JlYWN0LXRocmVlLWZpYmVyL3B1bGwvMjM2MCNkaXNjdXNzaW9uX3I5MTYzNTY4NzRcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgZ2V0Q3VycmVudEV2ZW50UHJpb3JpdHk6ICgpID0+IF9nZXRFdmVudFByaW9yaXR5ID8gX2dldEV2ZW50UHJpb3JpdHkoKSA6IERlZmF1bHRFdmVudFByaW9yaXR5LFxuICAgIGJlZm9yZUFjdGl2ZUluc3RhbmNlQmx1cjogKCkgPT4ge30sXG4gICAgYWZ0ZXJBY3RpdmVJbnN0YW5jZUJsdXI6ICgpID0+IHt9LFxuICAgIGRldGFjaERlbGV0ZWRJbnN0YW5jZTogKCkgPT4ge30sXG4gICAgbm93OiB0eXBlb2YgcGVyZm9ybWFuY2UgIT09ICd1bmRlZmluZWQnICYmIGlzLmZ1bihwZXJmb3JtYW5jZS5ub3cpID8gcGVyZm9ybWFuY2Uubm93IDogaXMuZnVuKERhdGUubm93KSA/IERhdGUubm93IDogKCkgPT4gMCxcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcG1uZHJzL3JlYWN0LXRocmVlLWZpYmVyL3B1bGwvMjM2MCNkaXNjdXNzaW9uX3I5MjA4ODM1MDNcbiAgICBzY2hlZHVsZVRpbWVvdXQ6IGlzLmZ1bihzZXRUaW1lb3V0KSA/IHNldFRpbWVvdXQgOiB1bmRlZmluZWQsXG4gICAgY2FuY2VsVGltZW91dDogaXMuZnVuKGNsZWFyVGltZW91dCkgPyBjbGVhclRpbWVvdXQgOiB1bmRlZmluZWRcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgcmVjb25jaWxlcixcbiAgICBhcHBseVByb3BzOiBhcHBseVByb3BzJDFcbiAgfTtcbn1cblxudmFyIF93aW5kb3ckZG9jdW1lbnQsIF93aW5kb3ckbmF2aWdhdG9yO1xuLyoqXHJcbiAqIFJldHVybnMgYHRydWVgIHdpdGggY29ycmVjdCBUUyB0eXBlIGluZmVyZW5jZSBpZiBhbiBvYmplY3QgaGFzIGEgY29uZmlndXJhYmxlIGNvbG9yIHNwYWNlIChzaW5jZSByMTUyKS5cclxuICovXG5jb25zdCBoYXNDb2xvclNwYWNlID0gb2JqZWN0ID0+ICdjb2xvclNwYWNlJyBpbiBvYmplY3QgfHwgJ291dHB1dENvbG9yU3BhY2UnIGluIG9iamVjdDtcbi8qKlxyXG4gKiBUaGUgY3VycmVudCBUSFJFRS5Db2xvck1hbmFnZW1lbnQgaW5zdGFuY2UsIGlmIHByZXNlbnQuXHJcbiAqL1xuY29uc3QgZ2V0Q29sb3JNYW5hZ2VtZW50ID0gKCkgPT4ge1xuICB2YXIgX0NvbG9yTWFuYWdlbWVudDtcbiAgcmV0dXJuIChfQ29sb3JNYW5hZ2VtZW50ID0gY2F0YWxvZ3VlLkNvbG9yTWFuYWdlbWVudCkgIT0gbnVsbCA/IF9Db2xvck1hbmFnZW1lbnQgOiBudWxsO1xufTtcbmNvbnN0IGlzT3J0aG9ncmFwaGljQ2FtZXJhID0gZGVmID0+IGRlZiAmJiBkZWYuaXNPcnRob2dyYXBoaWNDYW1lcmE7XG5jb25zdCBpc1JlZiA9IG9iaiA9PiBvYmogJiYgb2JqLmhhc093blByb3BlcnR5KCdjdXJyZW50Jyk7XG5cbi8qKlxyXG4gKiBBbiBTU1ItZnJpZW5kbHkgdXNlTGF5b3V0RWZmZWN0LlxyXG4gKlxyXG4gKiBSZWFjdCBjdXJyZW50bHkgdGhyb3dzIGEgd2FybmluZyB3aGVuIHVzaW5nIHVzZUxheW91dEVmZmVjdCBvbiB0aGUgc2VydmVyLlxyXG4gKiBUbyBnZXQgYXJvdW5kIGl0LCB3ZSBjYW4gY29uZGl0aW9uYWxseSB1c2VFZmZlY3Qgb24gdGhlIHNlcnZlciAobm8tb3ApIGFuZFxyXG4gKiB1c2VMYXlvdXRFZmZlY3QgZWxzZXdoZXJlLlxyXG4gKlxyXG4gKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMTQ5MjdcclxuICovXG5jb25zdCB1c2VJc29tb3JwaGljTGF5b3V0RWZmZWN0ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgKChfd2luZG93JGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50KSAhPSBudWxsICYmIF93aW5kb3ckZG9jdW1lbnQuY3JlYXRlRWxlbWVudCB8fCAoKF93aW5kb3ckbmF2aWdhdG9yID0gd2luZG93Lm5hdmlnYXRvcikgPT0gbnVsbCA/IHZvaWQgMCA6IF93aW5kb3ckbmF2aWdhdG9yLnByb2R1Y3QpID09PSAnUmVhY3ROYXRpdmUnKSA/IFJlYWN0LnVzZUxheW91dEVmZmVjdCA6IFJlYWN0LnVzZUVmZmVjdDtcbmZ1bmN0aW9uIHVzZU11dGFibGVDYWxsYmFjayhmbikge1xuICBjb25zdCByZWYgPSBSZWFjdC51c2VSZWYoZm4pO1xuICB1c2VJc29tb3JwaGljTGF5b3V0RWZmZWN0KCgpID0+IHZvaWQgKHJlZi5jdXJyZW50ID0gZm4pLCBbZm5dKTtcbiAgcmV0dXJuIHJlZjtcbn1cbmZ1bmN0aW9uIEJsb2NrKHtcbiAgc2V0XG59KSB7XG4gIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIHNldChuZXcgUHJvbWlzZSgoKSA9PiBudWxsKSk7XG4gICAgcmV0dXJuICgpID0+IHNldChmYWxzZSk7XG4gIH0sIFtzZXRdKTtcbiAgcmV0dXJuIG51bGw7XG59XG5jbGFzcyBFcnJvckJvdW5kYXJ5IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBlcnJvcjogZmFsc2VcbiAgICB9O1xuICB9XG4gIGNvbXBvbmVudERpZENhdGNoKGVycikge1xuICAgIHRoaXMucHJvcHMuc2V0KGVycik7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLmVycm9yID8gbnVsbCA6IHRoaXMucHJvcHMuY2hpbGRyZW47XG4gIH1cbn1cbkVycm9yQm91bmRhcnkuZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yID0gKCkgPT4gKHtcbiAgZXJyb3I6IHRydWVcbn0pO1xuY29uc3QgREVGQVVMVCA9ICdfX2RlZmF1bHQnO1xuY29uc3QgREVGQVVMVFMgPSBuZXcgTWFwKCk7XG5jb25zdCBpc0RpZmZTZXQgPSBkZWYgPT4gZGVmICYmICEhZGVmLm1lbW9pemVkICYmICEhZGVmLmNoYW5nZXM7XG5mdW5jdGlvbiBjYWxjdWxhdGVEcHIoZHByKSB7XG4gIHZhciBfd2luZG93JGRldmljZVBpeGVsUmE7XG4gIC8vIEVyciBvbiB0aGUgc2lkZSBvZiBwcm9ncmVzcyBieSBhc3N1bWluZyAyeCBkcHIgaWYgd2UgY2FuJ3QgZGV0ZWN0IGl0XG4gIC8vIFRoaXMgd2lsbCBoYXBwZW4gaW4gd29ya2VycyB3aGVyZSB3aW5kb3cgaXMgZGVmaW5lZCBidXQgZHByIGlzbid0LlxuICBjb25zdCB0YXJnZXQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IChfd2luZG93JGRldmljZVBpeGVsUmEgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbykgIT0gbnVsbCA/IF93aW5kb3ckZGV2aWNlUGl4ZWxSYSA6IDIgOiAxO1xuICByZXR1cm4gQXJyYXkuaXNBcnJheShkcHIpID8gTWF0aC5taW4oTWF0aC5tYXgoZHByWzBdLCB0YXJnZXQpLCBkcHJbMV0pIDogZHByO1xufVxuXG4vKipcclxuICogUmV0dXJucyBpbnN0YW5jZSByb290IHN0YXRlXHJcbiAqL1xuY29uc3QgZ2V0Um9vdFN0YXRlID0gb2JqID0+IHtcbiAgdmFyIF9yM2Y7XG4gIHJldHVybiAoX3IzZiA9IG9iai5fX3IzZikgPT0gbnVsbCA/IHZvaWQgMCA6IF9yM2Yucm9vdC5nZXRTdGF0ZSgpO1xufTtcblxuLyoqXHJcbiAqIFJldHVybnMgdGhlIGluc3RhbmNlcyBpbml0aWFsIChvdXRtb3N0KSByb290XHJcbiAqL1xuZnVuY3Rpb24gZmluZEluaXRpYWxSb290KGNoaWxkKSB7XG4gIGxldCByb290ID0gY2hpbGQuX19yM2Yucm9vdDtcbiAgd2hpbGUgKHJvb3QuZ2V0U3RhdGUoKS5wcmV2aW91c1Jvb3QpIHJvb3QgPSByb290LmdldFN0YXRlKCkucHJldmlvdXNSb290O1xuICByZXR1cm4gcm9vdDtcbn1cbi8vIEEgY29sbGVjdGlvbiBvZiBjb21wYXJlIGZ1bmN0aW9uc1xuY29uc3QgaXMgPSB7XG4gIG9iajogYSA9PiBhID09PSBPYmplY3QoYSkgJiYgIWlzLmFycihhKSAmJiB0eXBlb2YgYSAhPT0gJ2Z1bmN0aW9uJyxcbiAgZnVuOiBhID0+IHR5cGVvZiBhID09PSAnZnVuY3Rpb24nLFxuICBzdHI6IGEgPT4gdHlwZW9mIGEgPT09ICdzdHJpbmcnLFxuICBudW06IGEgPT4gdHlwZW9mIGEgPT09ICdudW1iZXInLFxuICBib286IGEgPT4gdHlwZW9mIGEgPT09ICdib29sZWFuJyxcbiAgdW5kOiBhID0+IGEgPT09IHZvaWQgMCxcbiAgYXJyOiBhID0+IEFycmF5LmlzQXJyYXkoYSksXG4gIGVxdShhLCBiLCB7XG4gICAgYXJyYXlzID0gJ3NoYWxsb3cnLFxuICAgIG9iamVjdHMgPSAncmVmZXJlbmNlJyxcbiAgICBzdHJpY3QgPSB0cnVlXG4gIH0gPSB7fSkge1xuICAgIC8vIFdyb25nIHR5cGUgb3Igb25lIG9mIHRoZSB0d28gdW5kZWZpbmVkLCBkb2Vzbid0IG1hdGNoXG4gICAgaWYgKHR5cGVvZiBhICE9PSB0eXBlb2YgYiB8fCAhIWEgIT09ICEhYikgcmV0dXJuIGZhbHNlO1xuICAgIC8vIEF0b21pYywganVzdCBjb21wYXJlIGEgYWdhaW5zdCBiXG4gICAgaWYgKGlzLnN0cihhKSB8fCBpcy5udW0oYSkpIHJldHVybiBhID09PSBiO1xuICAgIGNvbnN0IGlzT2JqID0gaXMub2JqKGEpO1xuICAgIGlmIChpc09iaiAmJiBvYmplY3RzID09PSAncmVmZXJlbmNlJykgcmV0dXJuIGEgPT09IGI7XG4gICAgY29uc3QgaXNBcnIgPSBpcy5hcnIoYSk7XG4gICAgaWYgKGlzQXJyICYmIGFycmF5cyA9PT0gJ3JlZmVyZW5jZScpIHJldHVybiBhID09PSBiO1xuICAgIC8vIEFycmF5IG9yIE9iamVjdCwgc2hhbGxvdyBjb21wYXJlIGZpcnN0IHRvIHNlZSBpZiBpdCdzIGEgbWF0Y2hcbiAgICBpZiAoKGlzQXJyIHx8IGlzT2JqKSAmJiBhID09PSBiKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBMYXN0IHJlc29ydCwgZ28gdGhyb3VnaCBrZXlzXG4gICAgbGV0IGk7XG4gICAgLy8gQ2hlY2sgaWYgYSBoYXMgYWxsIHRoZSBrZXlzIG9mIGJcbiAgICBmb3IgKGkgaW4gYSkgaWYgKCEoaSBpbiBiKSkgcmV0dXJuIGZhbHNlO1xuICAgIC8vIENoZWNrIGlmIHZhbHVlcyBiZXR3ZWVuIGtleXMgbWF0Y2hcbiAgICBpZiAoaXNPYmogJiYgYXJyYXlzID09PSAnc2hhbGxvdycgJiYgb2JqZWN0cyA9PT0gJ3NoYWxsb3cnKSB7XG4gICAgICBmb3IgKGkgaW4gc3RyaWN0ID8gYiA6IGEpIGlmICghaXMuZXF1KGFbaV0sIGJbaV0sIHtcbiAgICAgICAgc3RyaWN0LFxuICAgICAgICBvYmplY3RzOiAncmVmZXJlbmNlJ1xuICAgICAgfSkpIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChpIGluIHN0cmljdCA/IGIgOiBhKSBpZiAoYVtpXSAhPT0gYltpXSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBJZiBpIGlzIHVuZGVmaW5lZFxuICAgIGlmIChpcy51bmQoaSkpIHtcbiAgICAgIC8vIElmIGJvdGggYXJyYXlzIGFyZSBlbXB0eSB3ZSBjb25zaWRlciB0aGVtIGVxdWFsXG4gICAgICBpZiAoaXNBcnIgJiYgYS5sZW5ndGggPT09IDAgJiYgYi5sZW5ndGggPT09IDApIHJldHVybiB0cnVlO1xuICAgICAgLy8gSWYgYm90aCBvYmplY3RzIGFyZSBlbXB0eSB3ZSBjb25zaWRlciB0aGVtIGVxdWFsXG4gICAgICBpZiAoaXNPYmogJiYgT2JqZWN0LmtleXMoYSkubGVuZ3RoID09PSAwICYmIE9iamVjdC5rZXlzKGIpLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRydWU7XG4gICAgICAvLyBPdGhlcndpc2UgbWF0Y2ggdGhlbSBieSB2YWx1ZVxuICAgICAgaWYgKGEgIT09IGIpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn07XG5cbi8qKlxyXG4gKiBDb2xsZWN0cyBub2RlcyBhbmQgbWF0ZXJpYWxzIGZyb20gYSBUSFJFRS5PYmplY3QzRC5cclxuICovXG5mdW5jdGlvbiBidWlsZEdyYXBoKG9iamVjdCkge1xuICBjb25zdCBkYXRhID0ge1xuICAgIG5vZGVzOiB7fSxcbiAgICBtYXRlcmlhbHM6IHt9XG4gIH07XG4gIGlmIChvYmplY3QpIHtcbiAgICBvYmplY3QudHJhdmVyc2Uob2JqID0+IHtcbiAgICAgIGlmIChvYmoubmFtZSkgZGF0YS5ub2Rlc1tvYmoubmFtZV0gPSBvYmo7XG4gICAgICBpZiAob2JqLm1hdGVyaWFsICYmICFkYXRhLm1hdGVyaWFsc1tvYmoubWF0ZXJpYWwubmFtZV0pIGRhdGEubWF0ZXJpYWxzW29iai5tYXRlcmlhbC5uYW1lXSA9IG9iai5tYXRlcmlhbDtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZGF0YTtcbn1cblxuLy8gRGlzcG9zZXMgYW4gb2JqZWN0IGFuZCBhbGwgaXRzIHByb3BlcnRpZXNcbmZ1bmN0aW9uIGRpc3Bvc2Uob2JqKSB7XG4gIGlmIChvYmouZGlzcG9zZSAmJiBvYmoudHlwZSAhPT0gJ1NjZW5lJykgb2JqLmRpc3Bvc2UoKTtcbiAgZm9yIChjb25zdCBwIGluIG9iaikge1xuICAgIHAuZGlzcG9zZSA9PSBudWxsID8gdm9pZCAwIDogcC5kaXNwb3NlKCk7XG4gICAgZGVsZXRlIG9ialtwXTtcbiAgfVxufVxuXG4vLyBFYWNoIG9iamVjdCBpbiB0aGUgc2NlbmUgY2FycmllcyBhIHNtYWxsIExvY2FsU3RhdGUgZGVzY3JpcHRvclxuZnVuY3Rpb24gcHJlcGFyZShvYmplY3QsIHN0YXRlKSB7XG4gIGNvbnN0IGluc3RhbmNlID0gb2JqZWN0O1xuICBpbnN0YW5jZS5fX3IzZiA9IHtcbiAgICB0eXBlOiAnJyxcbiAgICByb290OiBudWxsLFxuICAgIHByZXZpb3VzQXR0YWNoOiBudWxsLFxuICAgIG1lbW9pemVkUHJvcHM6IHt9LFxuICAgIGV2ZW50Q291bnQ6IDAsXG4gICAgaGFuZGxlcnM6IHt9LFxuICAgIG9iamVjdHM6IFtdLFxuICAgIHBhcmVudDogbnVsbCxcbiAgICAuLi5zdGF0ZVxuICB9O1xuICByZXR1cm4gb2JqZWN0O1xufVxuZnVuY3Rpb24gcmVzb2x2ZShpbnN0YW5jZSwga2V5KSB7XG4gIGxldCB0YXJnZXQgPSBpbnN0YW5jZTtcbiAgaWYgKGtleS5pbmNsdWRlcygnLScpKSB7XG4gICAgY29uc3QgZW50cmllcyA9IGtleS5zcGxpdCgnLScpO1xuICAgIGNvbnN0IGxhc3QgPSBlbnRyaWVzLnBvcCgpO1xuICAgIHRhcmdldCA9IGVudHJpZXMucmVkdWNlKChhY2MsIGtleSkgPT4gYWNjW2tleV0sIGluc3RhbmNlKTtcbiAgICByZXR1cm4ge1xuICAgICAgdGFyZ2V0LFxuICAgICAga2V5OiBsYXN0XG4gICAgfTtcbiAgfSBlbHNlIHJldHVybiB7XG4gICAgdGFyZ2V0LFxuICAgIGtleVxuICB9O1xufVxuXG4vLyBDaGVja3MgaWYgYSBkYXNoLWNhc2VkIHN0cmluZyBlbmRzIHdpdGggYW4gaW50ZWdlclxuY29uc3QgSU5ERVhfUkVHRVggPSAvLVxcZCskLztcbmZ1bmN0aW9uIGF0dGFjaChwYXJlbnQsIGNoaWxkLCB0eXBlKSB7XG4gIGlmIChpcy5zdHIodHlwZSkpIHtcbiAgICAvLyBJZiBhdHRhY2hpbmcgaW50byBhbiBhcnJheSAoZm9vLTApLCBjcmVhdGUgb25lXG4gICAgaWYgKElOREVYX1JFR0VYLnRlc3QodHlwZSkpIHtcbiAgICAgIGNvbnN0IHJvb3QgPSB0eXBlLnJlcGxhY2UoSU5ERVhfUkVHRVgsICcnKTtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdGFyZ2V0LFxuICAgICAgICBrZXlcbiAgICAgIH0gPSByZXNvbHZlKHBhcmVudCwgcm9vdCk7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGFyZ2V0W2tleV0pKSB0YXJnZXRba2V5XSA9IFtdO1xuICAgIH1cbiAgICBjb25zdCB7XG4gICAgICB0YXJnZXQsXG4gICAgICBrZXlcbiAgICB9ID0gcmVzb2x2ZShwYXJlbnQsIHR5cGUpO1xuICAgIGNoaWxkLl9fcjNmLnByZXZpb3VzQXR0YWNoID0gdGFyZ2V0W2tleV07XG4gICAgdGFyZ2V0W2tleV0gPSBjaGlsZDtcbiAgfSBlbHNlIGNoaWxkLl9fcjNmLnByZXZpb3VzQXR0YWNoID0gdHlwZShwYXJlbnQsIGNoaWxkKTtcbn1cbmZ1bmN0aW9uIGRldGFjaChwYXJlbnQsIGNoaWxkLCB0eXBlKSB7XG4gIHZhciBfY2hpbGQkX19yM2YsIF9jaGlsZCRfX3IzZjI7XG4gIGlmIChpcy5zdHIodHlwZSkpIHtcbiAgICBjb25zdCB7XG4gICAgICB0YXJnZXQsXG4gICAgICBrZXlcbiAgICB9ID0gcmVzb2x2ZShwYXJlbnQsIHR5cGUpO1xuICAgIGNvbnN0IHByZXZpb3VzID0gY2hpbGQuX19yM2YucHJldmlvdXNBdHRhY2g7XG4gICAgLy8gV2hlbiB0aGUgcHJldmlvdXMgdmFsdWUgd2FzIHVuZGVmaW5lZCwgaXQgbWVhbnMgdGhlIHZhbHVlIHdhcyBuZXZlciBzZXQgdG8gYmVnaW4gd2l0aFxuICAgIGlmIChwcmV2aW91cyA9PT0gdW5kZWZpbmVkKSBkZWxldGUgdGFyZ2V0W2tleV07XG4gICAgLy8gT3RoZXJ3aXNlIHNldCB0aGUgcHJldmlvdXMgdmFsdWVcbiAgICBlbHNlIHRhcmdldFtrZXldID0gcHJldmlvdXM7XG4gIH0gZWxzZSAoX2NoaWxkJF9fcjNmID0gY2hpbGQuX19yM2YpID09IG51bGwgPyB2b2lkIDAgOiBfY2hpbGQkX19yM2YucHJldmlvdXNBdHRhY2ggPT0gbnVsbCA/IHZvaWQgMCA6IF9jaGlsZCRfX3IzZi5wcmV2aW91c0F0dGFjaChwYXJlbnQsIGNoaWxkKTtcbiAgKF9jaGlsZCRfX3IzZjIgPSBjaGlsZC5fX3IzZikgPT0gbnVsbCA/IHRydWUgOiBkZWxldGUgX2NoaWxkJF9fcjNmMi5wcmV2aW91c0F0dGFjaDtcbn1cbi8vIFRoaXMgZnVuY3Rpb24gcHJlcGFyZXMgYSBzZXQgb2YgY2hhbmdlcyB0byBiZSBhcHBsaWVkIHRvIHRoZSBpbnN0YW5jZVxuZnVuY3Rpb24gZGlmZlByb3BzKGluc3RhbmNlLCB7XG4gIGNoaWxkcmVuOiBjTixcbiAga2V5OiBrTixcbiAgcmVmOiByTixcbiAgLi4ucHJvcHNcbn0sIHtcbiAgY2hpbGRyZW46IGNQLFxuICBrZXk6IGtQLFxuICByZWY6IHJQLFxuICAuLi5wcmV2aW91c1xufSA9IHt9LCByZW1vdmUgPSBmYWxzZSkge1xuICBjb25zdCBsb2NhbFN0YXRlID0gaW5zdGFuY2UuX19yM2Y7XG4gIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhwcm9wcyk7XG4gIGNvbnN0IGNoYW5nZXMgPSBbXTtcblxuICAvLyBDYXRjaCByZW1vdmVkIHByb3BzLCBwcmVwZW5kIHRoZW0gc28gdGhleSBjYW4gYmUgcmVzZXQgb3IgcmVtb3ZlZFxuICBpZiAocmVtb3ZlKSB7XG4gICAgY29uc3QgcHJldmlvdXNLZXlzID0gT2JqZWN0LmtleXMocHJldmlvdXMpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJldmlvdXNLZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIXByb3BzLmhhc093blByb3BlcnR5KHByZXZpb3VzS2V5c1tpXSkpIGVudHJpZXMudW5zaGlmdChbcHJldmlvdXNLZXlzW2ldLCBERUZBVUxUICsgJ3JlbW92ZSddKTtcbiAgICB9XG4gIH1cbiAgZW50cmllcy5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICB2YXIgX2luc3RhbmNlJF9fcjNmO1xuICAgIC8vIEJhaWwgb3V0IG9uIHByaW1pdGl2ZSBvYmplY3RcbiAgICBpZiAoKF9pbnN0YW5jZSRfX3IzZiA9IGluc3RhbmNlLl9fcjNmKSAhPSBudWxsICYmIF9pbnN0YW5jZSRfX3IzZi5wcmltaXRpdmUgJiYga2V5ID09PSAnb2JqZWN0JykgcmV0dXJuO1xuICAgIC8vIFdoZW4gcHJvcHMgbWF0Y2ggYmFpbCBvdXRcbiAgICBpZiAoaXMuZXF1KHZhbHVlLCBwcmV2aW91c1trZXldKSkgcmV0dXJuO1xuICAgIC8vIENvbGxlY3QgaGFuZGxlcnMgYW5kIGJhaWwgb3V0XG4gICAgaWYgKC9eb24oUG9pbnRlcnxDbGlja3xEb3VibGVDbGlja3xDb250ZXh0TWVudXxXaGVlbCkvLnRlc3Qoa2V5KSkgcmV0dXJuIGNoYW5nZXMucHVzaChba2V5LCB2YWx1ZSwgdHJ1ZSwgW11dKTtcbiAgICAvLyBTcGxpdCBkYXNoZWQgcHJvcHNcbiAgICBsZXQgZW50cmllcyA9IFtdO1xuICAgIGlmIChrZXkuaW5jbHVkZXMoJy0nKSkgZW50cmllcyA9IGtleS5zcGxpdCgnLScpO1xuICAgIGNoYW5nZXMucHVzaChba2V5LCB2YWx1ZSwgZmFsc2UsIGVudHJpZXNdKTtcblxuICAgIC8vIFJlc2V0IHBpZXJjZWQgcHJvcHNcbiAgICBmb3IgKGNvbnN0IHByb3AgaW4gcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcHJvcHNbcHJvcF07XG4gICAgICBpZiAocHJvcC5zdGFydHNXaXRoKGAke2tleX0tYCkpIGNoYW5nZXMucHVzaChbcHJvcCwgdmFsdWUsIGZhbHNlLCBwcm9wLnNwbGl0KCctJyldKTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBtZW1vaXplZCA9IHtcbiAgICAuLi5wcm9wc1xuICB9O1xuICBpZiAobG9jYWxTdGF0ZSAhPSBudWxsICYmIGxvY2FsU3RhdGUubWVtb2l6ZWRQcm9wcyAmJiBsb2NhbFN0YXRlICE9IG51bGwgJiYgbG9jYWxTdGF0ZS5tZW1vaXplZFByb3BzLmFyZ3MpIG1lbW9pemVkLmFyZ3MgPSBsb2NhbFN0YXRlLm1lbW9pemVkUHJvcHMuYXJncztcbiAgaWYgKGxvY2FsU3RhdGUgIT0gbnVsbCAmJiBsb2NhbFN0YXRlLm1lbW9pemVkUHJvcHMgJiYgbG9jYWxTdGF0ZSAhPSBudWxsICYmIGxvY2FsU3RhdGUubWVtb2l6ZWRQcm9wcy5hdHRhY2gpIG1lbW9pemVkLmF0dGFjaCA9IGxvY2FsU3RhdGUubWVtb2l6ZWRQcm9wcy5hdHRhY2g7XG4gIHJldHVybiB7XG4gICAgbWVtb2l6ZWQsXG4gICAgY2hhbmdlc1xuICB9O1xufVxuY29uc3QgX19ERVZfXyA9IHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nO1xuXG4vLyBUaGlzIGZ1bmN0aW9uIGFwcGxpZXMgYSBzZXQgb2YgY2hhbmdlcyB0byB0aGUgaW5zdGFuY2VcbmZ1bmN0aW9uIGFwcGx5UHJvcHMkMShpbnN0YW5jZSwgZGF0YSkge1xuICB2YXIgX2luc3RhbmNlJF9fcjNmMjtcbiAgLy8gRmlsdGVyIGVxdWFscywgZXZlbnRzIGFuZCByZXNlcnZlZCBwcm9wc1xuICBjb25zdCBsb2NhbFN0YXRlID0gaW5zdGFuY2UuX19yM2Y7XG4gIGNvbnN0IHJvb3QgPSBsb2NhbFN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBsb2NhbFN0YXRlLnJvb3Q7XG4gIGNvbnN0IHJvb3RTdGF0ZSA9IHJvb3QgPT0gbnVsbCA/IHZvaWQgMCA6IHJvb3QuZ2V0U3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHJvb3QuZ2V0U3RhdGUoKTtcbiAgY29uc3Qge1xuICAgIG1lbW9pemVkLFxuICAgIGNoYW5nZXNcbiAgfSA9IGlzRGlmZlNldChkYXRhKSA/IGRhdGEgOiBkaWZmUHJvcHMoaW5zdGFuY2UsIGRhdGEpO1xuICBjb25zdCBwcmV2SGFuZGxlcnMgPSBsb2NhbFN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBsb2NhbFN0YXRlLmV2ZW50Q291bnQ7XG5cbiAgLy8gUHJlcGFyZSBtZW1vaXplZCBwcm9wc1xuICBpZiAoaW5zdGFuY2UuX19yM2YpIGluc3RhbmNlLl9fcjNmLm1lbW9pemVkUHJvcHMgPSBtZW1vaXplZDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IFtrZXksIHZhbHVlLCBpc0V2ZW50LCBrZXlzXSA9IGNoYW5nZXNbaV07XG5cbiAgICAvLyBBbGlhcyAob3V0cHV0KWVuY29kaW5nID0+IChvdXRwdXQpY29sb3JTcGFjZSAoc2luY2UgcjE1MilcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcG1uZHJzL3JlYWN0LXRocmVlLWZpYmVyL3B1bGwvMjgyOVxuICAgIGlmIChoYXNDb2xvclNwYWNlKGluc3RhbmNlKSkge1xuICAgICAgY29uc3Qgc1JHQkVuY29kaW5nID0gMzAwMTtcbiAgICAgIGNvbnN0IFNSR0JDb2xvclNwYWNlID0gJ3NyZ2InO1xuICAgICAgY29uc3QgTGluZWFyU1JHQkNvbG9yU3BhY2UgPSAnc3JnYi1saW5lYXInO1xuICAgICAgaWYgKGtleSA9PT0gJ2VuY29kaW5nJykge1xuICAgICAgICBrZXkgPSAnY29sb3JTcGFjZSc7XG4gICAgICAgIHZhbHVlID0gdmFsdWUgPT09IHNSR0JFbmNvZGluZyA/IFNSR0JDb2xvclNwYWNlIDogTGluZWFyU1JHQkNvbG9yU3BhY2U7XG4gICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ291dHB1dEVuY29kaW5nJykge1xuICAgICAgICBrZXkgPSAnb3V0cHV0Q29sb3JTcGFjZSc7XG4gICAgICAgIHZhbHVlID0gdmFsdWUgPT09IHNSR0JFbmNvZGluZyA/IFNSR0JDb2xvclNwYWNlIDogTGluZWFyU1JHQkNvbG9yU3BhY2U7XG4gICAgICB9XG4gICAgfVxuICAgIGxldCBjdXJyZW50SW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICBsZXQgdGFyZ2V0UHJvcCA9IGN1cnJlbnRJbnN0YW5jZVtrZXldO1xuXG4gICAgLy8gUmV2b2x2ZSBkYXNoZWQgcHJvcHNcbiAgICBpZiAoa2V5cy5sZW5ndGgpIHtcbiAgICAgIHRhcmdldFByb3AgPSBrZXlzLnJlZHVjZSgoYWNjLCBrZXkpID0+IGFjY1trZXldLCBpbnN0YW5jZSk7XG4gICAgICAvLyBJZiB0aGUgdGFyZ2V0IGlzIGF0b21pYywgaXQgZm9yY2VzIHVzIHRvIHN3aXRjaCB0aGUgcm9vdFxuICAgICAgaWYgKCEodGFyZ2V0UHJvcCAmJiB0YXJnZXRQcm9wLnNldCkpIHtcbiAgICAgICAgY29uc3QgW25hbWUsIC4uLnJldmVyc2VFbnRyaWVzXSA9IGtleXMucmV2ZXJzZSgpO1xuICAgICAgICBjdXJyZW50SW5zdGFuY2UgPSByZXZlcnNlRW50cmllcy5yZXZlcnNlKCkucmVkdWNlKChhY2MsIGtleSkgPT4gYWNjW2tleV0sIGluc3RhbmNlKTtcbiAgICAgICAga2V5ID0gbmFtZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbXJkb29iL3RocmVlLmpzL2lzc3Vlcy8yMTIwOVxuICAgIC8vIEhNUi9mYXN0LXJlZnJlc2ggcmVsaWVzIG9uIHRoZSBhYmlsaXR5IHRvIGNhbmNlbCBvdXQgcHJvcHMsIGJ1dCB0aHJlZWpzXG4gICAgLy8gaGFzIG5vIG1lYW5zIHRvIGRvIHRoaXMuIEhlbmNlIHdlIGN1cmF0ZSBhIHNtYWxsIGNvbGxlY3Rpb24gb2YgdmFsdWUtY2xhc3Nlc1xuICAgIC8vIHdpdGggdGhlaXIgcmVzcGVjdGl2ZSBjb25zdHJ1Y3Rvci9zZXQgYXJndW1lbnRzXG4gICAgLy8gRm9yIHJlbW92ZWQgcHJvcHMsIHRyeSB0byBzZXQgZGVmYXVsdCB2YWx1ZXMsIGlmIHBvc3NpYmxlXG4gICAgaWYgKHZhbHVlID09PSBERUZBVUxUICsgJ3JlbW92ZScpIHtcbiAgICAgIGlmIChjdXJyZW50SW5zdGFuY2UuY29uc3RydWN0b3IpIHtcbiAgICAgICAgLy8gY3JlYXRlIGEgYmxhbmsgc2xhdGUgb2YgdGhlIGluc3RhbmNlIGFuZCBjb3B5IHRoZSBwYXJ0aWN1bGFyIHBhcmFtZXRlci5cbiAgICAgICAgbGV0IGN0b3IgPSBERUZBVUxUUy5nZXQoY3VycmVudEluc3RhbmNlLmNvbnN0cnVjdG9yKTtcbiAgICAgICAgaWYgKCFjdG9yKSB7XG4gICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICAgIGN0b3IgPSBuZXcgY3VycmVudEluc3RhbmNlLmNvbnN0cnVjdG9yKCk7XG4gICAgICAgICAgREVGQVVMVFMuc2V0KGN1cnJlbnRJbnN0YW5jZS5jb25zdHJ1Y3RvciwgY3Rvcik7XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWUgPSBjdG9yW2tleV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBpbnN0YW5jZSBkb2VzIG5vdCBoYXZlIGNvbnN0cnVjdG9yLCBqdXN0IHNldCBpdCB0byAwXG4gICAgICAgIHZhbHVlID0gMDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEZWFsIHdpdGggcG9pbnRlciBldmVudHMgLi4uXG4gICAgaWYgKGlzRXZlbnQgJiYgbG9jYWxTdGF0ZSkge1xuICAgICAgaWYgKHZhbHVlKSBsb2NhbFN0YXRlLmhhbmRsZXJzW2tleV0gPSB2YWx1ZTtlbHNlIGRlbGV0ZSBsb2NhbFN0YXRlLmhhbmRsZXJzW2tleV07XG4gICAgICBsb2NhbFN0YXRlLmV2ZW50Q291bnQgPSBPYmplY3Qua2V5cyhsb2NhbFN0YXRlLmhhbmRsZXJzKS5sZW5ndGg7XG4gICAgfVxuICAgIC8vIFNwZWNpYWwgdHJlYXRtZW50IGZvciBvYmplY3RzIHdpdGggc3VwcG9ydCBmb3Igc2V0L2NvcHksIGFuZCBsYXllcnNcbiAgICBlbHNlIGlmICh0YXJnZXRQcm9wICYmIHRhcmdldFByb3Auc2V0ICYmICh0YXJnZXRQcm9wLmNvcHkgfHwgdGFyZ2V0UHJvcCBpbnN0YW5jZW9mIFRIUkVFLkxheWVycykpIHtcbiAgICAgIC8vIElmIHZhbHVlIGlzIGFuIGFycmF5XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgaWYgKHRhcmdldFByb3AuZnJvbUFycmF5KSB0YXJnZXRQcm9wLmZyb21BcnJheSh2YWx1ZSk7ZWxzZSB0YXJnZXRQcm9wLnNldCguLi52YWx1ZSk7XG4gICAgICB9XG4gICAgICAvLyBUZXN0IGFnYWluIHRhcmdldC5jb3B5KGNsYXNzKSBuZXh0IC4uLlxuICAgICAgZWxzZSBpZiAodGFyZ2V0UHJvcC5jb3B5ICYmIHZhbHVlICYmIHZhbHVlLmNvbnN0cnVjdG9yICYmIChcbiAgICAgIC8vIFNvbWUgZW52aXJvbm1lbnRzIG1heSBicmVhayBzdHJpY3QgaWRlbnRpdHkgY2hlY2tzIGJ5IGR1cGxpY2F0aW5nIHZlcnNpb25zIG9mIHRocmVlLmpzLlxuICAgICAgLy8gTG9vc2VuIHRvIHVubWluaWZpZWQgbmFtZXMsIGlnbm9yaW5nIGRlc2NlbmRlbnRzLlxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BtbmRycy9yZWFjdC10aHJlZS1maWJlci9pc3N1ZXMvMjg1NlxuICAgICAgLy8gVE9ETzogZml4IHVwc3RyZWFtIGFuZCByZW1vdmUgaW4gdjlcbiAgICAgIF9fREVWX18gPyB0YXJnZXRQcm9wLmNvbnN0cnVjdG9yLm5hbWUgPT09IHZhbHVlLmNvbnN0cnVjdG9yLm5hbWUgOiB0YXJnZXRQcm9wLmNvbnN0cnVjdG9yID09PSB2YWx1ZS5jb25zdHJ1Y3RvcikpIHtcbiAgICAgICAgdGFyZ2V0UHJvcC5jb3B5KHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIC8vIElmIG5vdGhpbmcgZWxzZSBmaXRzLCBqdXN0IHNldCB0aGUgc2luZ2xlIHZhbHVlLCBpZ25vcmUgdW5kZWZpbmVkXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcG1uZHJzL3JlYWN0LXRocmVlLWZpYmVyL2lzc3Vlcy8yNzRcbiAgICAgIGVsc2UgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3QgaXNDb2xvciA9IHRhcmdldFByb3AgaW5zdGFuY2VvZiBUSFJFRS5Db2xvcjtcbiAgICAgICAgLy8gQWxsb3cgc2V0dGluZyBhcnJheSBzY2FsYXJzXG4gICAgICAgIGlmICghaXNDb2xvciAmJiB0YXJnZXRQcm9wLnNldFNjYWxhcikgdGFyZ2V0UHJvcC5zZXRTY2FsYXIodmFsdWUpO1xuICAgICAgICAvLyBMYXllcnMgaGF2ZSBubyBjb3B5IGZ1bmN0aW9uLCB3ZSBtdXN0IHRoZXJlZm9yZSBjb3B5IHRoZSBtYXNrIHByb3BlcnR5XG4gICAgICAgIGVsc2UgaWYgKHRhcmdldFByb3AgaW5zdGFuY2VvZiBUSFJFRS5MYXllcnMgJiYgdmFsdWUgaW5zdGFuY2VvZiBUSFJFRS5MYXllcnMpIHRhcmdldFByb3AubWFzayA9IHZhbHVlLm1hc2s7XG4gICAgICAgIC8vIE90aGVyd2lzZSBqdXN0IHNldCAuLi5cbiAgICAgICAgZWxzZSB0YXJnZXRQcm9wLnNldCh2YWx1ZSk7XG4gICAgICAgIC8vIEZvciB2ZXJzaW9ucyBvZiB0aHJlZSB3aGljaCBkb24ndCBzdXBwb3J0IFRIUkVFLkNvbG9yTWFuYWdlbWVudCxcbiAgICAgICAgLy8gQXV0by1jb252ZXJ0IHNSR0IgY29sb3JzXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvaXNzdWVzLzM0NFxuICAgICAgICBpZiAoIWdldENvbG9yTWFuYWdlbWVudCgpICYmIHJvb3RTdGF0ZSAmJiAhcm9vdFN0YXRlLmxpbmVhciAmJiBpc0NvbG9yKSB0YXJnZXRQcm9wLmNvbnZlcnRTUkdCVG9MaW5lYXIoKTtcbiAgICAgIH1cbiAgICAgIC8vIEVsc2UsIGp1c3Qgb3ZlcndyaXRlIHRoZSB2YWx1ZVxuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50SW5zdGFuY2Vba2V5XSA9IHZhbHVlO1xuXG4gICAgICAvLyBBdXRvLWNvbnZlcnQgc1JHQiB0ZXh0dXJlcywgZm9yIG5vdyAuLi5cbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvaXNzdWVzLzM0NFxuICAgICAgaWYgKGN1cnJlbnRJbnN0YW5jZVtrZXldIGluc3RhbmNlb2YgVEhSRUUuVGV4dHVyZSAmJlxuICAgICAgLy8gc1JHQiB0ZXh0dXJlcyBtdXN0IGJlIFJHQkE4IHNpbmNlIHIxMzcgaHR0cHM6Ly9naXRodWIuY29tL21yZG9vYi90aHJlZS5qcy9wdWxsLzIzMTI5XG4gICAgICBjdXJyZW50SW5zdGFuY2Vba2V5XS5mb3JtYXQgPT09IFRIUkVFLlJHQkFGb3JtYXQgJiYgY3VycmVudEluc3RhbmNlW2tleV0udHlwZSA9PT0gVEhSRUUuVW5zaWduZWRCeXRlVHlwZSAmJiByb290U3RhdGUpIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IGN1cnJlbnRJbnN0YW5jZVtrZXldO1xuICAgICAgICBpZiAoaGFzQ29sb3JTcGFjZSh0ZXh0dXJlKSAmJiBoYXNDb2xvclNwYWNlKHJvb3RTdGF0ZS5nbCkpIHRleHR1cmUuY29sb3JTcGFjZSA9IHJvb3RTdGF0ZS5nbC5vdXRwdXRDb2xvclNwYWNlO2Vsc2UgdGV4dHVyZS5lbmNvZGluZyA9IHJvb3RTdGF0ZS5nbC5vdXRwdXRFbmNvZGluZztcbiAgICAgIH1cbiAgICB9XG4gICAgaW52YWxpZGF0ZUluc3RhbmNlKGluc3RhbmNlKTtcbiAgfVxuICBpZiAobG9jYWxTdGF0ZSAmJiBsb2NhbFN0YXRlLnBhcmVudCAmJiBpbnN0YW5jZS5yYXljYXN0ICYmIHByZXZIYW5kbGVycyAhPT0gbG9jYWxTdGF0ZS5ldmVudENvdW50KSB7XG4gICAgLy8gR2V0IHRoZSBpbml0aWFsIHJvb3Qgc3RhdGUncyBpbnRlcm5hbHNcbiAgICBjb25zdCBpbnRlcm5hbCA9IGZpbmRJbml0aWFsUm9vdChpbnN0YW5jZSkuZ2V0U3RhdGUoKS5pbnRlcm5hbDtcbiAgICAvLyBQcmUtZW1wdGl2ZWx5IHJlbW92ZSB0aGUgaW5zdGFuY2UgZnJvbSB0aGUgaW50ZXJhY3Rpb24gbWFuYWdlclxuICAgIGNvbnN0IGluZGV4ID0gaW50ZXJuYWwuaW50ZXJhY3Rpb24uaW5kZXhPZihpbnN0YW5jZSk7XG4gICAgaWYgKGluZGV4ID4gLTEpIGludGVybmFsLmludGVyYWN0aW9uLnNwbGljZShpbmRleCwgMSk7XG4gICAgLy8gQWRkIHRoZSBpbnN0YW5jZSB0byB0aGUgaW50ZXJhY3Rpb24gbWFuYWdlciBvbmx5IHdoZW4gaXQgaGFzIGhhbmRsZXJzXG4gICAgaWYgKGxvY2FsU3RhdGUuZXZlbnRDb3VudCkgaW50ZXJuYWwuaW50ZXJhY3Rpb24ucHVzaChpbnN0YW5jZSk7XG4gIH1cblxuICAvLyBDYWxsIHRoZSB1cGRhdGUgbGlmZWN5Y2xlIHdoZW4gaXQgaXMgYmVpbmcgdXBkYXRlZCwgYnV0IG9ubHkgd2hlbiBpdCBpcyBwYXJ0IG9mIHRoZSBzY2VuZS5cbiAgLy8gU2tpcCB1cGRhdGVzIHRvIHRoZSBgb25VcGRhdGVgIHByb3AgaXRzZWxmXG4gIGNvbnN0IGlzQ2lyY3VsYXIgPSBjaGFuZ2VzLmxlbmd0aCA9PT0gMSAmJiBjaGFuZ2VzWzBdWzBdID09PSAnb25VcGRhdGUnO1xuICBpZiAoIWlzQ2lyY3VsYXIgJiYgY2hhbmdlcy5sZW5ndGggJiYgKF9pbnN0YW5jZSRfX3IzZjIgPSBpbnN0YW5jZS5fX3IzZikgIT0gbnVsbCAmJiBfaW5zdGFuY2UkX19yM2YyLnBhcmVudCkgdXBkYXRlSW5zdGFuY2UoaW5zdGFuY2UpO1xuICByZXR1cm4gaW5zdGFuY2U7XG59XG5mdW5jdGlvbiBpbnZhbGlkYXRlSW5zdGFuY2UoaW5zdGFuY2UpIHtcbiAgdmFyIF9pbnN0YW5jZSRfX3IzZjMsIF9pbnN0YW5jZSRfX3IzZjMkcm9vdDtcbiAgY29uc3Qgc3RhdGUgPSAoX2luc3RhbmNlJF9fcjNmMyA9IGluc3RhbmNlLl9fcjNmKSA9PSBudWxsID8gdm9pZCAwIDogKF9pbnN0YW5jZSRfX3IzZjMkcm9vdCA9IF9pbnN0YW5jZSRfX3IzZjMucm9vdCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9pbnN0YW5jZSRfX3IzZjMkcm9vdC5nZXRTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogX2luc3RhbmNlJF9fcjNmMyRyb290LmdldFN0YXRlKCk7XG4gIGlmIChzdGF0ZSAmJiBzdGF0ZS5pbnRlcm5hbC5mcmFtZXMgPT09IDApIHN0YXRlLmludmFsaWRhdGUoKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZUluc3RhbmNlKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLm9uVXBkYXRlID09IG51bGwgPyB2b2lkIDAgOiBpbnN0YW5jZS5vblVwZGF0ZShpbnN0YW5jZSk7XG59XG5mdW5jdGlvbiB1cGRhdGVDYW1lcmEoY2FtZXJhLCBzaXplKSB7XG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvaXNzdWVzLzkyXG4gIC8vIERvIG5vdCBtZXNzIHdpdGggdGhlIGNhbWVyYSBpZiBpdCBiZWxvbmdzIHRvIHRoZSB1c2VyXG4gIGlmICghY2FtZXJhLm1hbnVhbCkge1xuICAgIGlmIChpc09ydGhvZ3JhcGhpY0NhbWVyYShjYW1lcmEpKSB7XG4gICAgICBjYW1lcmEubGVmdCA9IHNpemUud2lkdGggLyAtMjtcbiAgICAgIGNhbWVyYS5yaWdodCA9IHNpemUud2lkdGggLyAyO1xuICAgICAgY2FtZXJhLnRvcCA9IHNpemUuaGVpZ2h0IC8gMjtcbiAgICAgIGNhbWVyYS5ib3R0b20gPSBzaXplLmhlaWdodCAvIC0yO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYW1lcmEuYXNwZWN0ID0gc2l6ZS53aWR0aCAvIHNpemUuaGVpZ2h0O1xuICAgIH1cbiAgICBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvaXNzdWVzLzE3OFxuICAgIC8vIFVwZGF0ZSBtYXRyaXggd29ybGQgc2luY2UgdGhlIHJlbmRlcmVyIGlzIGEgZnJhbWUgbGF0ZVxuICAgIGNhbWVyYS51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1ha2VJZChldmVudCkge1xuICByZXR1cm4gKGV2ZW50LmV2ZW50T2JqZWN0IHx8IGV2ZW50Lm9iamVjdCkudXVpZCArICcvJyArIGV2ZW50LmluZGV4ICsgZXZlbnQuaW5zdGFuY2VJZDtcbn1cblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L3RyZWUvbWFpbi9wYWNrYWdlcy9yZWFjdC1yZWNvbmNpbGVyI2dldGN1cnJlbnRldmVudHByaW9yaXR5XG4vLyBHaXZlcyBSZWFjdCBhIGNsdWUgYXMgdG8gaG93IGltcG9ydCB0aGUgY3VycmVudCBpbnRlcmFjdGlvbiBpc1xuZnVuY3Rpb24gZ2V0RXZlbnRQcmlvcml0eSgpIHtcbiAgdmFyIF9nbG9iYWxTY29wZSRldmVudDtcbiAgLy8gR2V0IGEgaGFuZGxlIHRvIHRoZSBjdXJyZW50IGdsb2JhbCBzY29wZSBpbiB3aW5kb3cgYW5kIHdvcmtlciBjb250ZXh0cyBpZiBhYmxlXG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvcHVsbC8yNDkzXG4gIGNvbnN0IGdsb2JhbFNjb3BlID0gdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmIHNlbGYgfHwgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93O1xuICBpZiAoIWdsb2JhbFNjb3BlKSByZXR1cm4gRGVmYXVsdEV2ZW50UHJpb3JpdHk7XG4gIGNvbnN0IG5hbWUgPSAoX2dsb2JhbFNjb3BlJGV2ZW50ID0gZ2xvYmFsU2NvcGUuZXZlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZ2xvYmFsU2NvcGUkZXZlbnQudHlwZTtcbiAgc3dpdGNoIChuYW1lKSB7XG4gICAgY2FzZSAnY2xpY2snOlxuICAgIGNhc2UgJ2NvbnRleHRtZW51JzpcbiAgICBjYXNlICdkYmxjbGljayc6XG4gICAgY2FzZSAncG9pbnRlcmNhbmNlbCc6XG4gICAgY2FzZSAncG9pbnRlcmRvd24nOlxuICAgIGNhc2UgJ3BvaW50ZXJ1cCc6XG4gICAgICByZXR1cm4gRGlzY3JldGVFdmVudFByaW9yaXR5O1xuICAgIGNhc2UgJ3BvaW50ZXJtb3ZlJzpcbiAgICBjYXNlICdwb2ludGVyb3V0JzpcbiAgICBjYXNlICdwb2ludGVyb3Zlcic6XG4gICAgY2FzZSAncG9pbnRlcmVudGVyJzpcbiAgICBjYXNlICdwb2ludGVybGVhdmUnOlxuICAgIGNhc2UgJ3doZWVsJzpcbiAgICAgIHJldHVybiBDb250aW51b3VzRXZlbnRQcmlvcml0eTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIERlZmF1bHRFdmVudFByaW9yaXR5O1xuICB9XG59XG5cbi8qKlxyXG4gKiBSZWxlYXNlIHBvaW50ZXIgY2FwdHVyZXMuXHJcbiAqIFRoaXMgaXMgY2FsbGVkIGJ5IHJlbGVhc2VQb2ludGVyQ2FwdHVyZSBpbiB0aGUgQVBJLCBhbmQgd2hlbiBhbiBvYmplY3QgaXMgcmVtb3ZlZC5cclxuICovXG5mdW5jdGlvbiByZWxlYXNlSW50ZXJuYWxQb2ludGVyQ2FwdHVyZShjYXB0dXJlZE1hcCwgb2JqLCBjYXB0dXJlcywgcG9pbnRlcklkKSB7XG4gIGNvbnN0IGNhcHR1cmVEYXRhID0gY2FwdHVyZXMuZ2V0KG9iaik7XG4gIGlmIChjYXB0dXJlRGF0YSkge1xuICAgIGNhcHR1cmVzLmRlbGV0ZShvYmopO1xuICAgIC8vIElmIHRoaXMgd2FzIHRoZSBsYXN0IGNhcHR1cmluZyBvYmplY3QgZm9yIHRoaXMgcG9pbnRlclxuICAgIGlmIChjYXB0dXJlcy5zaXplID09PSAwKSB7XG4gICAgICBjYXB0dXJlZE1hcC5kZWxldGUocG9pbnRlcklkKTtcbiAgICAgIGNhcHR1cmVEYXRhLnRhcmdldC5yZWxlYXNlUG9pbnRlckNhcHR1cmUocG9pbnRlcklkKTtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIHJlbW92ZUludGVyYWN0aXZpdHkoc3RvcmUsIG9iamVjdCkge1xuICBjb25zdCB7XG4gICAgaW50ZXJuYWxcbiAgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gIC8vIFJlbW92ZXMgZXZlcnkgdHJhY2Ugb2YgYW4gb2JqZWN0IGZyb20gdGhlIGRhdGEgc3RvcmVcbiAgaW50ZXJuYWwuaW50ZXJhY3Rpb24gPSBpbnRlcm5hbC5pbnRlcmFjdGlvbi5maWx0ZXIobyA9PiBvICE9PSBvYmplY3QpO1xuICBpbnRlcm5hbC5pbml0aWFsSGl0cyA9IGludGVybmFsLmluaXRpYWxIaXRzLmZpbHRlcihvID0+IG8gIT09IG9iamVjdCk7XG4gIGludGVybmFsLmhvdmVyZWQuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xuICAgIGlmICh2YWx1ZS5ldmVudE9iamVjdCA9PT0gb2JqZWN0IHx8IHZhbHVlLm9iamVjdCA9PT0gb2JqZWN0KSB7XG4gICAgICAvLyBDbGVhciBvdXQgaW50ZXJzZWN0cywgdGhleSBhcmUgb3V0ZGF0ZWQgYnkgbm93XG4gICAgICBpbnRlcm5hbC5ob3ZlcmVkLmRlbGV0ZShrZXkpO1xuICAgIH1cbiAgfSk7XG4gIGludGVybmFsLmNhcHR1cmVkTWFwLmZvckVhY2goKGNhcHR1cmVzLCBwb2ludGVySWQpID0+IHtcbiAgICByZWxlYXNlSW50ZXJuYWxQb2ludGVyQ2FwdHVyZShpbnRlcm5hbC5jYXB0dXJlZE1hcCwgb2JqZWN0LCBjYXB0dXJlcywgcG9pbnRlcklkKTtcbiAgfSk7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudHMoc3RvcmUpIHtcbiAgLyoqIENhbGN1bGF0ZXMgZGVsdGEgKi9cbiAgZnVuY3Rpb24gY2FsY3VsYXRlRGlzdGFuY2UoZXZlbnQpIHtcbiAgICBjb25zdCB7XG4gICAgICBpbnRlcm5hbFxuICAgIH0gPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICAgIGNvbnN0IGR4ID0gZXZlbnQub2Zmc2V0WCAtIGludGVybmFsLmluaXRpYWxDbGlja1swXTtcbiAgICBjb25zdCBkeSA9IGV2ZW50Lm9mZnNldFkgLSBpbnRlcm5hbC5pbml0aWFsQ2xpY2tbMV07XG4gICAgcmV0dXJuIE1hdGgucm91bmQoTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KSk7XG4gIH1cblxuICAvKiogUmV0dXJucyB0cnVlIGlmIGFuIGluc3RhbmNlIGhhcyBhIHZhbGlkIHBvaW50ZXItZXZlbnQgcmVnaXN0ZXJlZCwgdGhpcyBleGNsdWRlcyBzY3JvbGwsIGNsaWNrcyBldGMgKi9cbiAgZnVuY3Rpb24gZmlsdGVyUG9pbnRlckV2ZW50cyhvYmplY3RzKSB7XG4gICAgcmV0dXJuIG9iamVjdHMuZmlsdGVyKG9iaiA9PiBbJ01vdmUnLCAnT3ZlcicsICdFbnRlcicsICdPdXQnLCAnTGVhdmUnXS5zb21lKG5hbWUgPT4ge1xuICAgICAgdmFyIF9yM2Y7XG4gICAgICByZXR1cm4gKF9yM2YgPSBvYmouX19yM2YpID09IG51bGwgPyB2b2lkIDAgOiBfcjNmLmhhbmRsZXJzWydvblBvaW50ZXInICsgbmFtZV07XG4gICAgfSkpO1xuICB9XG4gIGZ1bmN0aW9uIGludGVyc2VjdChldmVudCwgZmlsdGVyKSB7XG4gICAgY29uc3Qgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICAgIGNvbnN0IGR1cGxpY2F0ZXMgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgaW50ZXJzZWN0aW9ucyA9IFtdO1xuICAgIC8vIEFsbG93IGNhbGxlcnMgdG8gZWxpbWluYXRlIGV2ZW50IG9iamVjdHNcbiAgICBjb25zdCBldmVudHNPYmplY3RzID0gZmlsdGVyID8gZmlsdGVyKHN0YXRlLmludGVybmFsLmludGVyYWN0aW9uKSA6IHN0YXRlLmludGVybmFsLmludGVyYWN0aW9uO1xuICAgIC8vIFJlc2V0IGFsbCByYXljYXN0ZXIgY2FtZXJhcyB0byB1bmRlZmluZWRcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50c09iamVjdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHN0YXRlID0gZ2V0Um9vdFN0YXRlKGV2ZW50c09iamVjdHNbaV0pO1xuICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgIHN0YXRlLnJheWNhc3Rlci5jYW1lcmEgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghc3RhdGUucHJldmlvdXNSb290KSB7XG4gICAgICAvLyBNYWtlIHN1cmUgcm9vdC1sZXZlbCBwb2ludGVyIGFuZCByYXkgYXJlIHNldCB1cFxuICAgICAgc3RhdGUuZXZlbnRzLmNvbXB1dGUgPT0gbnVsbCA/IHZvaWQgMCA6IHN0YXRlLmV2ZW50cy5jb21wdXRlKGV2ZW50LCBzdGF0ZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZVJheWNhc3Qob2JqKSB7XG4gICAgICBjb25zdCBzdGF0ZSA9IGdldFJvb3RTdGF0ZShvYmopO1xuICAgICAgLy8gU2tpcCBldmVudCBoYW5kbGluZyB3aGVuIG5vRXZlbnRzIGlzIHNldCwgb3Igd2hlbiB0aGUgcmF5Y2FzdGVycyBjYW1lcmEgaXMgbnVsbFxuICAgICAgaWYgKCFzdGF0ZSB8fCAhc3RhdGUuZXZlbnRzLmVuYWJsZWQgfHwgc3RhdGUucmF5Y2FzdGVyLmNhbWVyYSA9PT0gbnVsbCkgcmV0dXJuIFtdO1xuXG4gICAgICAvLyBXaGVuIHRoZSBjYW1lcmEgaXMgdW5kZWZpbmVkIHdlIGhhdmUgdG8gY2FsbCB0aGUgZXZlbnQgbGF5ZXJzIHVwZGF0ZSBmdW5jdGlvblxuICAgICAgaWYgKHN0YXRlLnJheWNhc3Rlci5jYW1lcmEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgX3N0YXRlJHByZXZpb3VzUm9vdDtcbiAgICAgICAgc3RhdGUuZXZlbnRzLmNvbXB1dGUgPT0gbnVsbCA/IHZvaWQgMCA6IHN0YXRlLmV2ZW50cy5jb21wdXRlKGV2ZW50LCBzdGF0ZSwgKF9zdGF0ZSRwcmV2aW91c1Jvb3QgPSBzdGF0ZS5wcmV2aW91c1Jvb3QpID09IG51bGwgPyB2b2lkIDAgOiBfc3RhdGUkcHJldmlvdXNSb290LmdldFN0YXRlKCkpO1xuICAgICAgICAvLyBJZiB0aGUgY2FtZXJhIGlzIHN0aWxsIHVuZGVmaW5lZCB3ZSBoYXZlIHRvIHNraXAgdGhpcyBsYXllciBlbnRpcmVseVxuICAgICAgICBpZiAoc3RhdGUucmF5Y2FzdGVyLmNhbWVyYSA9PT0gdW5kZWZpbmVkKSBzdGF0ZS5yYXljYXN0ZXIuY2FtZXJhID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgLy8gSW50ZXJzZWN0IG9iamVjdCBieSBvYmplY3RcbiAgICAgIHJldHVybiBzdGF0ZS5yYXljYXN0ZXIuY2FtZXJhID8gc3RhdGUucmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdChvYmosIHRydWUpIDogW107XG4gICAgfVxuXG4gICAgLy8gQ29sbGVjdCBldmVudHNcbiAgICBsZXQgaGl0cyA9IGV2ZW50c09iamVjdHNcbiAgICAvLyBJbnRlcnNlY3Qgb2JqZWN0c1xuICAgIC5mbGF0TWFwKGhhbmRsZVJheWNhc3QpXG4gICAgLy8gU29ydCBieSBldmVudCBwcmlvcml0eSBhbmQgZGlzdGFuY2VcbiAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgY29uc3QgYVN0YXRlID0gZ2V0Um9vdFN0YXRlKGEub2JqZWN0KTtcbiAgICAgIGNvbnN0IGJTdGF0ZSA9IGdldFJvb3RTdGF0ZShiLm9iamVjdCk7XG4gICAgICBpZiAoIWFTdGF0ZSB8fCAhYlN0YXRlKSByZXR1cm4gYS5kaXN0YW5jZSAtIGIuZGlzdGFuY2U7XG4gICAgICByZXR1cm4gYlN0YXRlLmV2ZW50cy5wcmlvcml0eSAtIGFTdGF0ZS5ldmVudHMucHJpb3JpdHkgfHwgYS5kaXN0YW5jZSAtIGIuZGlzdGFuY2U7XG4gICAgfSlcbiAgICAvLyBGaWx0ZXIgb3V0IGR1cGxpY2F0ZXNcbiAgICAuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgY29uc3QgaWQgPSBtYWtlSWQoaXRlbSk7XG4gICAgICBpZiAoZHVwbGljYXRlcy5oYXMoaWQpKSByZXR1cm4gZmFsc2U7XG4gICAgICBkdXBsaWNhdGVzLmFkZChpZCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcblxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tcmRvb2IvdGhyZWUuanMvaXNzdWVzLzE2MDMxXG4gICAgLy8gQWxsb3cgY3VzdG9tIHVzZXJsYW5kIGludGVyc2VjdCBzb3J0IG9yZGVyLCB0aGlzIGxpa2VseSBvbmx5IG1ha2VzIHNlbnNlIG9uIHRoZSByb290IGZpbHRlclxuICAgIGlmIChzdGF0ZS5ldmVudHMuZmlsdGVyKSBoaXRzID0gc3RhdGUuZXZlbnRzLmZpbHRlcihoaXRzLCBzdGF0ZSk7XG5cbiAgICAvLyBCdWJibGUgdXAgdGhlIGV2ZW50cywgZmluZCB0aGUgZXZlbnQgc291cmNlIChldmVudE9iamVjdClcbiAgICBmb3IgKGNvbnN0IGhpdCBvZiBoaXRzKSB7XG4gICAgICBsZXQgZXZlbnRPYmplY3QgPSBoaXQub2JqZWN0O1xuICAgICAgLy8gQnViYmxlIGV2ZW50IHVwXG4gICAgICB3aGlsZSAoZXZlbnRPYmplY3QpIHtcbiAgICAgICAgdmFyIF9yM2YyO1xuICAgICAgICBpZiAoKF9yM2YyID0gZXZlbnRPYmplY3QuX19yM2YpICE9IG51bGwgJiYgX3IzZjIuZXZlbnRDb3VudCkgaW50ZXJzZWN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAuLi5oaXQsXG4gICAgICAgICAgZXZlbnRPYmplY3RcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50T2JqZWN0ID0gZXZlbnRPYmplY3QucGFyZW50O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIHRoZSBpbnRlcmFjdGlvbiBpcyBjYXB0dXJlZCwgbWFrZSBhbGwgY2FwdHVyaW5nIHRhcmdldHMgcGFydCBvZiB0aGUgaW50ZXJzZWN0LlxuICAgIGlmICgncG9pbnRlcklkJyBpbiBldmVudCAmJiBzdGF0ZS5pbnRlcm5hbC5jYXB0dXJlZE1hcC5oYXMoZXZlbnQucG9pbnRlcklkKSkge1xuICAgICAgZm9yIChsZXQgY2FwdHVyZURhdGEgb2Ygc3RhdGUuaW50ZXJuYWwuY2FwdHVyZWRNYXAuZ2V0KGV2ZW50LnBvaW50ZXJJZCkudmFsdWVzKCkpIHtcbiAgICAgICAgaWYgKCFkdXBsaWNhdGVzLmhhcyhtYWtlSWQoY2FwdHVyZURhdGEuaW50ZXJzZWN0aW9uKSkpIGludGVyc2VjdGlvbnMucHVzaChjYXB0dXJlRGF0YS5pbnRlcnNlY3Rpb24pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaW50ZXJzZWN0aW9ucztcbiAgfVxuXG4gIC8qKiAgSGFuZGxlcyBpbnRlcnNlY3Rpb25zIGJ5IGZvcndhcmRpbmcgdGhlbSB0byBoYW5kbGVycyAqL1xuICBmdW5jdGlvbiBoYW5kbGVJbnRlcnNlY3RzKGludGVyc2VjdGlvbnMsIGV2ZW50LCBkZWx0YSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCByb290U3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuXG4gICAgLy8gSWYgYW55dGhpbmcgaGFzIGJlZW4gZm91bmQsIGZvcndhcmQgaXQgdG8gdGhlIGV2ZW50IGxpc3RlbmVyc1xuICAgIGlmIChpbnRlcnNlY3Rpb25zLmxlbmd0aCkge1xuICAgICAgY29uc3QgbG9jYWxTdGF0ZSA9IHtcbiAgICAgICAgc3RvcHBlZDogZmFsc2VcbiAgICAgIH07XG4gICAgICBmb3IgKGNvbnN0IGhpdCBvZiBpbnRlcnNlY3Rpb25zKSB7XG4gICAgICAgIGNvbnN0IHN0YXRlID0gZ2V0Um9vdFN0YXRlKGhpdC5vYmplY3QpIHx8IHJvb3RTdGF0ZTtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHJheWNhc3RlcixcbiAgICAgICAgICBwb2ludGVyLFxuICAgICAgICAgIGNhbWVyYSxcbiAgICAgICAgICBpbnRlcm5hbFxuICAgICAgICB9ID0gc3RhdGU7XG4gICAgICAgIGNvbnN0IHVucHJvamVjdGVkUG9pbnQgPSBuZXcgVEhSRUUuVmVjdG9yMyhwb2ludGVyLngsIHBvaW50ZXIueSwgMCkudW5wcm9qZWN0KGNhbWVyYSk7XG4gICAgICAgIGNvbnN0IGhhc1BvaW50ZXJDYXB0dXJlID0gaWQgPT4ge1xuICAgICAgICAgIHZhciBfaW50ZXJuYWwkY2FwdHVyZWRNYXAsIF9pbnRlcm5hbCRjYXB0dXJlZE1hcDI7XG4gICAgICAgICAgcmV0dXJuIChfaW50ZXJuYWwkY2FwdHVyZWRNYXAgPSAoX2ludGVybmFsJGNhcHR1cmVkTWFwMiA9IGludGVybmFsLmNhcHR1cmVkTWFwLmdldChpZCkpID09IG51bGwgPyB2b2lkIDAgOiBfaW50ZXJuYWwkY2FwdHVyZWRNYXAyLmhhcyhoaXQuZXZlbnRPYmplY3QpKSAhPSBudWxsID8gX2ludGVybmFsJGNhcHR1cmVkTWFwIDogZmFsc2U7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHNldFBvaW50ZXJDYXB0dXJlID0gaWQgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcHR1cmVEYXRhID0ge1xuICAgICAgICAgICAgaW50ZXJzZWN0aW9uOiBoaXQsXG4gICAgICAgICAgICB0YXJnZXQ6IGV2ZW50LnRhcmdldFxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGludGVybmFsLmNhcHR1cmVkTWFwLmhhcyhpZCkpIHtcbiAgICAgICAgICAgIC8vIGlmIHRoZSBwb2ludGVySWQgd2FzIHByZXZpb3VzbHkgY2FwdHVyZWQsIHdlIGFkZCB0aGUgaGl0IHRvIHRoZVxuICAgICAgICAgICAgLy8gZXZlbnQgY2FwdHVyZWRNYXAuXG4gICAgICAgICAgICBpbnRlcm5hbC5jYXB0dXJlZE1hcC5nZXQoaWQpLnNldChoaXQuZXZlbnRPYmplY3QsIGNhcHR1cmVEYXRhKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgdGhlIHBvaW50ZXJJZCB3YXMgbm90IHByZXZpb3VzbHkgY2FwdHVyZWQsIHdlIGNyZWF0ZSBhIG1hcFxuICAgICAgICAgICAgLy8gY29udGFpbmluZyB0aGUgaGl0T2JqZWN0LCBhbmQgdGhlIGhpdC4gaGl0T2JqZWN0IGlzIHVzZWQgZm9yXG4gICAgICAgICAgICAvLyBmYXN0ZXIgYWNjZXNzLlxuICAgICAgICAgICAgaW50ZXJuYWwuY2FwdHVyZWRNYXAuc2V0KGlkLCBuZXcgTWFwKFtbaGl0LmV2ZW50T2JqZWN0LCBjYXB0dXJlRGF0YV1dKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV2ZW50LnRhcmdldC5zZXRQb2ludGVyQ2FwdHVyZShpZCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlbGVhc2VQb2ludGVyQ2FwdHVyZSA9IGlkID0+IHtcbiAgICAgICAgICBjb25zdCBjYXB0dXJlcyA9IGludGVybmFsLmNhcHR1cmVkTWFwLmdldChpZCk7XG4gICAgICAgICAgaWYgKGNhcHR1cmVzKSB7XG4gICAgICAgICAgICByZWxlYXNlSW50ZXJuYWxQb2ludGVyQ2FwdHVyZShpbnRlcm5hbC5jYXB0dXJlZE1hcCwgaGl0LmV2ZW50T2JqZWN0LCBjYXB0dXJlcywgaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBZGQgbmF0aXZlIGV2ZW50IHByb3BzXG4gICAgICAgIGxldCBleHRyYWN0RXZlbnRQcm9wcyA9IHt9O1xuICAgICAgICAvLyBUaGlzIGl0ZXJhdGVzIG92ZXIgdGhlIGV2ZW50J3MgcHJvcGVydGllcyBpbmNsdWRpbmcgdGhlIGluaGVyaXRlZCBvbmVzLiBOYXRpdmUgUG9pbnRlckV2ZW50cyBoYXZlIG1vc3Qgb2YgdGhlaXIgcHJvcHMgYXMgZ2V0dGVycyB3aGljaCBhcmUgaW5oZXJpdGVkLCBidXQgcG9seWZpbGxlZCBQb2ludGVyRXZlbnRzIGhhdmUgdGhlbSBhbGwgYXMgdGhlaXIgb3duIHByb3BlcnRpZXMgKGkuZS4gbm90IGluaGVyaXRlZCkuIFdlIGNhbid0IHVzZSBPYmplY3Qua2V5cygpIG9yIE9iamVjdC5lbnRyaWVzKCkgYXMgdGhleSBvbmx5IHJldHVybiBcIm93blwiIHByb3BlcnRpZXM7IG5vciBPYmplY3QuZ2V0UHJvdG90eXBlT2YoZXZlbnQpIGFzIHRoYXQgKmRvZXNuJ3QqIHJldHVybiBcIm93blwiIHByb3BlcnRpZXMsIG9ubHkgaW5oZXJpdGVkIG9uZXMuXG4gICAgICAgIGZvciAobGV0IHByb3AgaW4gZXZlbnQpIHtcbiAgICAgICAgICBsZXQgcHJvcGVydHkgPSBldmVudFtwcm9wXTtcbiAgICAgICAgICAvLyBPbmx5IGNvcHkgb3ZlciBhdG9taWNzLCBsZWF2ZSBmdW5jdGlvbnMgYWxvbmUgYXMgdGhlc2Ugc2hvdWxkIGJlXG4gICAgICAgICAgLy8gY2FsbGVkIGFzIGV2ZW50Lm5hdGl2ZUV2ZW50LmZuKClcbiAgICAgICAgICBpZiAodHlwZW9mIHByb3BlcnR5ICE9PSAnZnVuY3Rpb24nKSBleHRyYWN0RXZlbnRQcm9wc1twcm9wXSA9IHByb3BlcnR5O1xuICAgICAgICB9XG4gICAgICAgIGxldCByYXljYXN0RXZlbnQgPSB7XG4gICAgICAgICAgLi4uaGl0LFxuICAgICAgICAgIC4uLmV4dHJhY3RFdmVudFByb3BzLFxuICAgICAgICAgIHBvaW50ZXIsXG4gICAgICAgICAgaW50ZXJzZWN0aW9ucyxcbiAgICAgICAgICBzdG9wcGVkOiBsb2NhbFN0YXRlLnN0b3BwZWQsXG4gICAgICAgICAgZGVsdGEsXG4gICAgICAgICAgdW5wcm9qZWN0ZWRQb2ludCxcbiAgICAgICAgICByYXk6IHJheWNhc3Rlci5yYXksXG4gICAgICAgICAgY2FtZXJhOiBjYW1lcmEsXG4gICAgICAgICAgLy8gSGlqYWNrIHN0b3BQcm9wYWdhdGlvbiwgd2hpY2gganVzdCBzZXRzIGEgZmxhZ1xuICAgICAgICAgIHN0b3BQcm9wYWdhdGlvbigpIHtcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvaXNzdWVzLzU5NlxuICAgICAgICAgICAgLy8gRXZlbnRzIGFyZSBub3QgYWxsb3dlZCB0byBzdG9wIHByb3BhZ2F0aW9uIGlmIHRoZSBwb2ludGVyIGhhcyBiZWVuIGNhcHR1cmVkXG4gICAgICAgICAgICBjb25zdCBjYXB0dXJlc0ZvclBvaW50ZXIgPSAncG9pbnRlcklkJyBpbiBldmVudCAmJiBpbnRlcm5hbC5jYXB0dXJlZE1hcC5nZXQoZXZlbnQucG9pbnRlcklkKTtcblxuICAgICAgICAgICAgLy8gV2Ugb25seSBhdXRob3JpemUgc3RvcFByb3BhZ2F0aW9uLi4uXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAvLyAuLi5pZiB0aGlzIHBvaW50ZXIgaGFzbid0IGJlZW4gY2FwdHVyZWRcbiAgICAgICAgICAgICFjYXB0dXJlc0ZvclBvaW50ZXIgfHxcbiAgICAgICAgICAgIC8vIC4uLiBvciBpZiB0aGUgaGl0IG9iamVjdCBpcyBjYXB0dXJpbmcgdGhlIHBvaW50ZXJcbiAgICAgICAgICAgIGNhcHR1cmVzRm9yUG9pbnRlci5oYXMoaGl0LmV2ZW50T2JqZWN0KSkge1xuICAgICAgICAgICAgICByYXljYXN0RXZlbnQuc3RvcHBlZCA9IGxvY2FsU3RhdGUuc3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgICAgIC8vIFByb3BhZ2F0aW9uIGlzIHN0b3BwZWQsIHJlbW92ZSBhbGwgb3RoZXIgaG92ZXIgcmVjb3Jkc1xuICAgICAgICAgICAgICAvLyBBbiBldmVudCBoYW5kbGVyIGlzIG9ubHkgYWxsb3dlZCB0byBmbHVzaCBvdGhlciBoYW5kbGVycyBpZiBpdCBpcyBob3ZlcmVkIGl0c2VsZlxuICAgICAgICAgICAgICBpZiAoaW50ZXJuYWwuaG92ZXJlZC5zaXplICYmIEFycmF5LmZyb20oaW50ZXJuYWwuaG92ZXJlZC52YWx1ZXMoKSkuZmluZChpID0+IGkuZXZlbnRPYmplY3QgPT09IGhpdC5ldmVudE9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICAvLyBPYmplY3RzIGNhbm5vdCBmbHVzaCBvdXQgaGlnaGVyIHVwIG9iamVjdHMgdGhhdCBoYXZlIGFscmVhZHkgY2F1Z2h0IHRoZSBldmVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGhpZ2hlciA9IGludGVyc2VjdGlvbnMuc2xpY2UoMCwgaW50ZXJzZWN0aW9ucy5pbmRleE9mKGhpdCkpO1xuICAgICAgICAgICAgICAgIGNhbmNlbFBvaW50ZXIoWy4uLmhpZ2hlciwgaGl0XSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIC8vIHRoZXJlIHNob3VsZCBiZSBhIGRpc3RpbmN0aW9uIGJldHdlZW4gdGFyZ2V0IGFuZCBjdXJyZW50VGFyZ2V0XG4gICAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgICBoYXNQb2ludGVyQ2FwdHVyZSxcbiAgICAgICAgICAgIHNldFBvaW50ZXJDYXB0dXJlLFxuICAgICAgICAgICAgcmVsZWFzZVBvaW50ZXJDYXB0dXJlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjdXJyZW50VGFyZ2V0OiB7XG4gICAgICAgICAgICBoYXNQb2ludGVyQ2FwdHVyZSxcbiAgICAgICAgICAgIHNldFBvaW50ZXJDYXB0dXJlLFxuICAgICAgICAgICAgcmVsZWFzZVBvaW50ZXJDYXB0dXJlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBuYXRpdmVFdmVudDogZXZlbnRcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBDYWxsIHN1YnNjcmliZXJzXG4gICAgICAgIGNhbGxiYWNrKHJheWNhc3RFdmVudCk7XG4gICAgICAgIC8vIEV2ZW50IGJ1YmJsaW5nIG1heSBiZSBpbnRlcnJ1cHRlZCBieSBzdG9wUHJvcGFnYXRpb25cbiAgICAgICAgaWYgKGxvY2FsU3RhdGUuc3RvcHBlZCA9PT0gdHJ1ZSkgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbnRlcnNlY3Rpb25zO1xuICB9XG4gIGZ1bmN0aW9uIGNhbmNlbFBvaW50ZXIoaW50ZXJzZWN0aW9ucykge1xuICAgIGNvbnN0IHtcbiAgICAgIGludGVybmFsXG4gICAgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gICAgZm9yIChjb25zdCBob3ZlcmVkT2JqIG9mIGludGVybmFsLmhvdmVyZWQudmFsdWVzKCkpIHtcbiAgICAgIC8vIFdoZW4gbm8gb2JqZWN0cyB3ZXJlIGhpdCBvciB0aGUgdGhlIGhvdmVyZWQgb2JqZWN0IHdhc24ndCBmb3VuZCB1bmRlcm5lYXRoIHRoZSBjdXJzb3JcbiAgICAgIC8vIHdlIGNhbGwgb25Qb2ludGVyT3V0IGFuZCBkZWxldGUgdGhlIG9iamVjdCBmcm9tIHRoZSBob3ZlcmVkLWVsZW1lbnRzIG1hcFxuICAgICAgaWYgKCFpbnRlcnNlY3Rpb25zLmxlbmd0aCB8fCAhaW50ZXJzZWN0aW9ucy5maW5kKGhpdCA9PiBoaXQub2JqZWN0ID09PSBob3ZlcmVkT2JqLm9iamVjdCAmJiBoaXQuaW5kZXggPT09IGhvdmVyZWRPYmouaW5kZXggJiYgaGl0Lmluc3RhbmNlSWQgPT09IGhvdmVyZWRPYmouaW5zdGFuY2VJZCkpIHtcbiAgICAgICAgY29uc3QgZXZlbnRPYmplY3QgPSBob3ZlcmVkT2JqLmV2ZW50T2JqZWN0O1xuICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGV2ZW50T2JqZWN0Ll9fcjNmO1xuICAgICAgICBjb25zdCBoYW5kbGVycyA9IGluc3RhbmNlID09IG51bGwgPyB2b2lkIDAgOiBpbnN0YW5jZS5oYW5kbGVycztcbiAgICAgICAgaW50ZXJuYWwuaG92ZXJlZC5kZWxldGUobWFrZUlkKGhvdmVyZWRPYmopKTtcbiAgICAgICAgaWYgKGluc3RhbmNlICE9IG51bGwgJiYgaW5zdGFuY2UuZXZlbnRDb3VudCkge1xuICAgICAgICAgIC8vIENsZWFyIG91dCBpbnRlcnNlY3RzLCB0aGV5IGFyZSBvdXRkYXRlZCBieSBub3dcbiAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgLi4uaG92ZXJlZE9iaixcbiAgICAgICAgICAgIGludGVyc2VjdGlvbnNcbiAgICAgICAgICB9O1xuICAgICAgICAgIGhhbmRsZXJzLm9uUG9pbnRlck91dCA9PSBudWxsID8gdm9pZCAwIDogaGFuZGxlcnMub25Qb2ludGVyT3V0KGRhdGEpO1xuICAgICAgICAgIGhhbmRsZXJzLm9uUG9pbnRlckxlYXZlID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVycy5vblBvaW50ZXJMZWF2ZShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBwb2ludGVyTWlzc2VkKGV2ZW50LCBvYmplY3RzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmplY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpbnN0YW5jZSA9IG9iamVjdHNbaV0uX19yM2Y7XG4gICAgICBpbnN0YW5jZSA9PSBudWxsID8gdm9pZCAwIDogaW5zdGFuY2UuaGFuZGxlcnMub25Qb2ludGVyTWlzc2VkID09IG51bGwgPyB2b2lkIDAgOiBpbnN0YW5jZS5oYW5kbGVycy5vblBvaW50ZXJNaXNzZWQoZXZlbnQpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBoYW5kbGVQb2ludGVyKG5hbWUpIHtcbiAgICAvLyBEZWFsIHdpdGggY2FuY2VsYXRpb25cbiAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgIGNhc2UgJ29uUG9pbnRlckxlYXZlJzpcbiAgICAgIGNhc2UgJ29uUG9pbnRlckNhbmNlbCc6XG4gICAgICAgIHJldHVybiAoKSA9PiBjYW5jZWxQb2ludGVyKFtdKTtcbiAgICAgIGNhc2UgJ29uTG9zdFBvaW50ZXJDYXB0dXJlJzpcbiAgICAgICAgcmV0dXJuIGV2ZW50ID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBpbnRlcm5hbFxuICAgICAgICAgIH0gPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICAgIGlmICgncG9pbnRlcklkJyBpbiBldmVudCAmJiBpbnRlcm5hbC5jYXB0dXJlZE1hcC5oYXMoZXZlbnQucG9pbnRlcklkKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIG9iamVjdCBldmVudCBpbnRlcmZhY2UgaGFkIG9uTG9zdFBvaW50ZXJDYXB0dXJlLCB3ZSdkIGNhbGwgaXQgaGVyZSBvbiBldmVyeVxuICAgICAgICAgICAgLy8gb2JqZWN0IHRoYXQncyBnZXR0aW5nIHJlbW92ZWQuIFdlIGNhbGwgaXQgb24gdGhlIG5leHQgZnJhbWUgYmVjYXVzZSBvbkxvc3RQb2ludGVyQ2FwdHVyZVxuICAgICAgICAgICAgLy8gZmlyZXMgYmVmb3JlIG9uUG9pbnRlclVwLiBPdGhlcndpc2UgcG9pbnRlclVwIHdvdWxkIG5ldmVyIGJlIGNhbGxlZCBpZiB0aGUgZXZlbnQgZGlkbid0XG4gICAgICAgICAgICAvLyBoYXBwZW4gaW4gdGhlIG9iamVjdCBpdCBvcmlnaW5hdGVkIGZyb20sIGxlYXZpbmcgY29tcG9uZW50cyBpbiBhIGluLWJldHdlZW4gc3RhdGUuXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBPbmx5IHJlbGVhc2UgaWYgcG9pbnRlci11cCBkaWRuJ3QgZG8gaXQgYWxyZWFkeVxuICAgICAgICAgICAgICBpZiAoaW50ZXJuYWwuY2FwdHVyZWRNYXAuaGFzKGV2ZW50LnBvaW50ZXJJZCkpIHtcbiAgICAgICAgICAgICAgICBpbnRlcm5hbC5jYXB0dXJlZE1hcC5kZWxldGUoZXZlbnQucG9pbnRlcklkKTtcbiAgICAgICAgICAgICAgICBjYW5jZWxQb2ludGVyKFtdKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIEFueSBvdGhlciBwb2ludGVyIGdvZXMgaGVyZSAuLi5cbiAgICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlRXZlbnQoZXZlbnQpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgb25Qb2ludGVyTWlzc2VkLFxuICAgICAgICBpbnRlcm5hbFxuICAgICAgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG5cbiAgICAgIC8vIHByZXBhcmVSYXkoZXZlbnQpXG4gICAgICBpbnRlcm5hbC5sYXN0RXZlbnQuY3VycmVudCA9IGV2ZW50O1xuXG4gICAgICAvLyBHZXQgZnJlc2ggaW50ZXJzZWN0c1xuICAgICAgY29uc3QgaXNQb2ludGVyTW92ZSA9IG5hbWUgPT09ICdvblBvaW50ZXJNb3ZlJztcbiAgICAgIGNvbnN0IGlzQ2xpY2tFdmVudCA9IG5hbWUgPT09ICdvbkNsaWNrJyB8fCBuYW1lID09PSAnb25Db250ZXh0TWVudScgfHwgbmFtZSA9PT0gJ29uRG91YmxlQ2xpY2snO1xuICAgICAgY29uc3QgZmlsdGVyID0gaXNQb2ludGVyTW92ZSA/IGZpbHRlclBvaW50ZXJFdmVudHMgOiB1bmRlZmluZWQ7XG4gICAgICBjb25zdCBoaXRzID0gaW50ZXJzZWN0KGV2ZW50LCBmaWx0ZXIpO1xuICAgICAgY29uc3QgZGVsdGEgPSBpc0NsaWNrRXZlbnQgPyBjYWxjdWxhdGVEaXN0YW5jZShldmVudCkgOiAwO1xuXG4gICAgICAvLyBTYXZlIGluaXRpYWwgY29vcmRpbmF0ZXMgb24gcG9pbnRlci1kb3duXG4gICAgICBpZiAobmFtZSA9PT0gJ29uUG9pbnRlckRvd24nKSB7XG4gICAgICAgIGludGVybmFsLmluaXRpYWxDbGljayA9IFtldmVudC5vZmZzZXRYLCBldmVudC5vZmZzZXRZXTtcbiAgICAgICAgaW50ZXJuYWwuaW5pdGlhbEhpdHMgPSBoaXRzLm1hcChoaXQgPT4gaGl0LmV2ZW50T2JqZWN0KTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgYSBjbGljayB5aWVsZHMgbm8gcmVzdWx0cywgcGFzcyBpdCBiYWNrIHRvIHRoZSB1c2VyIGFzIGEgbWlzc1xuICAgICAgLy8gTWlzc2VkIGV2ZW50cyBoYXZlIHRvIGNvbWUgZmlyc3QgaW4gb3JkZXIgdG8gZXN0YWJsaXNoIHVzZXItbGFuZCBzaWRlLWVmZmVjdCBjbGVhbiB1cFxuICAgICAgaWYgKGlzQ2xpY2tFdmVudCAmJiAhaGl0cy5sZW5ndGgpIHtcbiAgICAgICAgaWYgKGRlbHRhIDw9IDIpIHtcbiAgICAgICAgICBwb2ludGVyTWlzc2VkKGV2ZW50LCBpbnRlcm5hbC5pbnRlcmFjdGlvbik7XG4gICAgICAgICAgaWYgKG9uUG9pbnRlck1pc3NlZCkgb25Qb2ludGVyTWlzc2VkKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gVGFrZSBjYXJlIG9mIHVuaG92ZXJcbiAgICAgIGlmIChpc1BvaW50ZXJNb3ZlKSBjYW5jZWxQb2ludGVyKGhpdHMpO1xuICAgICAgZnVuY3Rpb24gb25JbnRlcnNlY3QoZGF0YSkge1xuICAgICAgICBjb25zdCBldmVudE9iamVjdCA9IGRhdGEuZXZlbnRPYmplY3Q7XG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gZXZlbnRPYmplY3QuX19yM2Y7XG4gICAgICAgIGNvbnN0IGhhbmRsZXJzID0gaW5zdGFuY2UgPT0gbnVsbCA/IHZvaWQgMCA6IGluc3RhbmNlLmhhbmRsZXJzO1xuXG4gICAgICAgIC8vIENoZWNrIHByZXNlbmNlIG9mIGhhbmRsZXJzXG4gICAgICAgIGlmICghKGluc3RhbmNlICE9IG51bGwgJiYgaW5zdGFuY2UuZXZlbnRDb3VudCkpIHJldHVybjtcblxuICAgICAgICAvKlxyXG4gICAgICAgIE1BWUJFIFRPRE8sIERFTEVURSBJRiBOT1Q6IFxyXG4gICAgICAgICAgQ2hlY2sgaWYgdGhlIG9iamVjdCBpcyBjYXB0dXJlZCwgY2FwdHVyZWQgZXZlbnRzIHNob3VsZCBub3QgaGF2ZSBpbnRlcnNlY3RzIHJ1bm5pbmcgaW4gcGFyYWxsZWxcclxuICAgICAgICAgIEJ1dCB3b3VsZG4ndCBpdCBiZSBiZXR0ZXIgdG8ganVzdCByZXBsYWNlIGNhcHR1cmVkTWFwIHdpdGggYSBzaW5nbGUgZW50cnk/XHJcbiAgICAgICAgICBBbHNvLCBhcmUgd2UgT0sgd2l0aCBzdHJhaWdodCB1cCBtYWtpbmcgcGlja2luZyB1cCBtdWx0aXBsZSBvYmplY3RzIGltcG9zc2libGU/XHJcbiAgICAgICAgICBcclxuICAgICAgICBjb25zdCBwb2ludGVySWQgPSAoZGF0YSBhcyBUaHJlZUV2ZW50PFBvaW50ZXJFdmVudD4pLnBvaW50ZXJJZCAgICAgICAgXHJcbiAgICAgICAgaWYgKHBvaW50ZXJJZCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBjb25zdCBjYXB0dXJlZE1lc2hTZXQgPSBpbnRlcm5hbC5jYXB0dXJlZE1hcC5nZXQocG9pbnRlcklkKVxyXG4gICAgICAgICAgaWYgKGNhcHR1cmVkTWVzaFNldCkge1xyXG4gICAgICAgICAgICBjb25zdCBjYXB0dXJlZCA9IGNhcHR1cmVkTWVzaFNldC5nZXQoZXZlbnRPYmplY3QpXHJcbiAgICAgICAgICAgIGlmIChjYXB0dXJlZCAmJiBjYXB0dXJlZC5sb2NhbFN0YXRlLnN0b3BwZWQpIHJldHVyblxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0qL1xuXG4gICAgICAgIGlmIChpc1BvaW50ZXJNb3ZlKSB7XG4gICAgICAgICAgLy8gTW92ZSBldmVudCAuLi5cbiAgICAgICAgICBpZiAoaGFuZGxlcnMub25Qb2ludGVyT3ZlciB8fCBoYW5kbGVycy5vblBvaW50ZXJFbnRlciB8fCBoYW5kbGVycy5vblBvaW50ZXJPdXQgfHwgaGFuZGxlcnMub25Qb2ludGVyTGVhdmUpIHtcbiAgICAgICAgICAgIC8vIFdoZW4gZW50ZXIgb3Igb3V0IGlzIHByZXNlbnQgdGFrZSBjYXJlIG9mIGhvdmVyLXN0YXRlXG4gICAgICAgICAgICBjb25zdCBpZCA9IG1ha2VJZChkYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IGhvdmVyZWRJdGVtID0gaW50ZXJuYWwuaG92ZXJlZC5nZXQoaWQpO1xuICAgICAgICAgICAgaWYgKCFob3ZlcmVkSXRlbSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGUgb2JqZWN0IHdhc24ndCBwcmV2aW91c2x5IGhvdmVyZWQsIGJvb2sgaXQgYW5kIGNhbGwgaXRzIGhhbmRsZXJcbiAgICAgICAgICAgICAgaW50ZXJuYWwuaG92ZXJlZC5zZXQoaWQsIGRhdGEpO1xuICAgICAgICAgICAgICBoYW5kbGVycy5vblBvaW50ZXJPdmVyID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVycy5vblBvaW50ZXJPdmVyKGRhdGEpO1xuICAgICAgICAgICAgICBoYW5kbGVycy5vblBvaW50ZXJFbnRlciA9PSBudWxsID8gdm9pZCAwIDogaGFuZGxlcnMub25Qb2ludGVyRW50ZXIoZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGhvdmVyZWRJdGVtLnN0b3BwZWQpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIG9iamVjdCB3YXMgcHJldmlvdXNseSBob3ZlcmVkIGFuZCBzdG9wcGVkLCB3ZSBzaG91bGRuJ3QgYWxsb3cgb3RoZXIgaXRlbXMgdG8gcHJvY2VlZFxuICAgICAgICAgICAgICBkYXRhLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBDYWxsIG1vdXNlIG1vdmVcbiAgICAgICAgICBoYW5kbGVycy5vblBvaW50ZXJNb3ZlID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVycy5vblBvaW50ZXJNb3ZlKGRhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEFsbCBvdGhlciBldmVudHMgLi4uXG4gICAgICAgICAgY29uc3QgaGFuZGxlciA9IGhhbmRsZXJzW25hbWVdO1xuICAgICAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgICAgICAvLyBGb3J3YXJkIGFsbCBldmVudHMgYmFjayB0byB0aGVpciByZXNwZWN0aXZlIGhhbmRsZXJzIHdpdGggdGhlIGV4Y2VwdGlvbiBvZiBjbGljayBldmVudHMsXG4gICAgICAgICAgICAvLyB3aGljaCBtdXN0IHVzZSB0aGUgaW5pdGlhbCB0YXJnZXRcbiAgICAgICAgICAgIGlmICghaXNDbGlja0V2ZW50IHx8IGludGVybmFsLmluaXRpYWxIaXRzLmluY2x1ZGVzKGV2ZW50T2JqZWN0KSkge1xuICAgICAgICAgICAgICAvLyBNaXNzZWQgZXZlbnRzIGhhdmUgdG8gY29tZSBmaXJzdFxuICAgICAgICAgICAgICBwb2ludGVyTWlzc2VkKGV2ZW50LCBpbnRlcm5hbC5pbnRlcmFjdGlvbi5maWx0ZXIob2JqZWN0ID0+ICFpbnRlcm5hbC5pbml0aWFsSGl0cy5pbmNsdWRlcyhvYmplY3QpKSk7XG4gICAgICAgICAgICAgIC8vIE5vdyBjYWxsIHRoZSBoYW5kbGVyXG4gICAgICAgICAgICAgIGhhbmRsZXIoZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgb25Qb2ludGVyTWlzc2VkIG9uIGFsbCBlbGVtZW50cyB0aGF0IGhhdmUgcG9pbnRlciBvdmVyL291dCBoYW5kbGVycywgYnV0IG5vdCBjbGljayBhbmQgd2VyZW4ndCBoaXRcbiAgICAgICAgICAgIGlmIChpc0NsaWNrRXZlbnQgJiYgaW50ZXJuYWwuaW5pdGlhbEhpdHMuaW5jbHVkZXMoZXZlbnRPYmplY3QpKSB7XG4gICAgICAgICAgICAgIHBvaW50ZXJNaXNzZWQoZXZlbnQsIGludGVybmFsLmludGVyYWN0aW9uLmZpbHRlcihvYmplY3QgPT4gIWludGVybmFsLmluaXRpYWxIaXRzLmluY2x1ZGVzKG9iamVjdCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGhhbmRsZUludGVyc2VjdHMoaGl0cywgZXZlbnQsIGRlbHRhLCBvbkludGVyc2VjdCk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGhhbmRsZVBvaW50ZXJcbiAgfTtcbn1cblxuLy8gS2V5cyB0aGF0IHNob3VsZG4ndCBiZSBjb3BpZWQgYmV0d2VlbiBSM0Ygc3RvcmVzXG5jb25zdCBwcml2YXRlS2V5cyA9IFsnc2V0JywgJ2dldCcsICdzZXRTaXplJywgJ3NldEZyYW1lbG9vcCcsICdzZXREcHInLCAnZXZlbnRzJywgJ2ludmFsaWRhdGUnLCAnYWR2YW5jZScsICdzaXplJywgJ3ZpZXdwb3J0J107XG5jb25zdCBpc1JlbmRlcmVyID0gZGVmID0+ICEhKGRlZiAhPSBudWxsICYmIGRlZi5yZW5kZXIpO1xuY29uc3QgY29udGV4dCA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVDb250ZXh0KG51bGwpO1xuY29uc3QgY3JlYXRlU3RvcmUgPSAoaW52YWxpZGF0ZSwgYWR2YW5jZSkgPT4ge1xuICBjb25zdCByb290U3RhdGUgPSBjcmVhdGUoKHNldCwgZ2V0KSA9PiB7XG4gICAgY29uc3QgcG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIGNvbnN0IGRlZmF1bHRUYXJnZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIGNvbnN0IHRlbXBUYXJnZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRWaWV3cG9ydChjYW1lcmEgPSBnZXQoKS5jYW1lcmEsIHRhcmdldCA9IGRlZmF1bHRUYXJnZXQsIHNpemUgPSBnZXQoKS5zaXplKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHdpZHRoLFxuICAgICAgICBoZWlnaHQsXG4gICAgICAgIHRvcCxcbiAgICAgICAgbGVmdFxuICAgICAgfSA9IHNpemU7XG4gICAgICBjb25zdCBhc3BlY3QgPSB3aWR0aCAvIGhlaWdodDtcbiAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBUSFJFRS5WZWN0b3IzKSB0ZW1wVGFyZ2V0LmNvcHkodGFyZ2V0KTtlbHNlIHRlbXBUYXJnZXQuc2V0KC4uLnRhcmdldCk7XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IGNhbWVyYS5nZXRXb3JsZFBvc2l0aW9uKHBvc2l0aW9uKS5kaXN0YW5jZVRvKHRlbXBUYXJnZXQpO1xuICAgICAgaWYgKGlzT3J0aG9ncmFwaGljQ2FtZXJhKGNhbWVyYSkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB3aWR0aDogd2lkdGggLyBjYW1lcmEuem9vbSxcbiAgICAgICAgICBoZWlnaHQ6IGhlaWdodCAvIGNhbWVyYS56b29tLFxuICAgICAgICAgIHRvcCxcbiAgICAgICAgICBsZWZ0LFxuICAgICAgICAgIGZhY3RvcjogMSxcbiAgICAgICAgICBkaXN0YW5jZSxcbiAgICAgICAgICBhc3BlY3RcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGZvdiA9IGNhbWVyYS5mb3YgKiBNYXRoLlBJIC8gMTgwOyAvLyBjb252ZXJ0IHZlcnRpY2FsIGZvdiB0byByYWRpYW5zXG4gICAgICAgIGNvbnN0IGggPSAyICogTWF0aC50YW4oZm92IC8gMikgKiBkaXN0YW5jZTsgLy8gdmlzaWJsZSBoZWlnaHRcbiAgICAgICAgY29uc3QgdyA9IGggKiAod2lkdGggLyBoZWlnaHQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHdpZHRoOiB3LFxuICAgICAgICAgIGhlaWdodDogaCxcbiAgICAgICAgICB0b3AsXG4gICAgICAgICAgbGVmdCxcbiAgICAgICAgICBmYWN0b3I6IHdpZHRoIC8gdyxcbiAgICAgICAgICBkaXN0YW5jZSxcbiAgICAgICAgICBhc3BlY3RcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gICAgbGV0IHBlcmZvcm1hbmNlVGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICBjb25zdCBzZXRQZXJmb3JtYW5jZUN1cnJlbnQgPSBjdXJyZW50ID0+IHNldChzdGF0ZSA9PiAoe1xuICAgICAgcGVyZm9ybWFuY2U6IHtcbiAgICAgICAgLi4uc3RhdGUucGVyZm9ybWFuY2UsXG4gICAgICAgIGN1cnJlbnRcbiAgICAgIH1cbiAgICB9KSk7XG4gICAgY29uc3QgcG9pbnRlciA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG4gICAgY29uc3Qgcm9vdFN0YXRlID0ge1xuICAgICAgc2V0LFxuICAgICAgZ2V0LFxuICAgICAgLy8gTW9jayBvYmplY3RzIHRoYXQgaGF2ZSB0byBiZSBjb25maWd1cmVkXG4gICAgICBnbDogbnVsbCxcbiAgICAgIGNhbWVyYTogbnVsbCxcbiAgICAgIHJheWNhc3RlcjogbnVsbCxcbiAgICAgIGV2ZW50czoge1xuICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgY29ubmVjdGVkOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIHhyOiBudWxsLFxuICAgICAgc2NlbmU6IG51bGwsXG4gICAgICBpbnZhbGlkYXRlOiAoZnJhbWVzID0gMSkgPT4gaW52YWxpZGF0ZShnZXQoKSwgZnJhbWVzKSxcbiAgICAgIGFkdmFuY2U6ICh0aW1lc3RhbXAsIHJ1bkdsb2JhbEVmZmVjdHMpID0+IGFkdmFuY2UodGltZXN0YW1wLCBydW5HbG9iYWxFZmZlY3RzLCBnZXQoKSksXG4gICAgICBsZWdhY3k6IGZhbHNlLFxuICAgICAgbGluZWFyOiBmYWxzZSxcbiAgICAgIGZsYXQ6IGZhbHNlLFxuICAgICAgY29udHJvbHM6IG51bGwsXG4gICAgICBjbG9jazogbmV3IFRIUkVFLkNsb2NrKCksXG4gICAgICBwb2ludGVyLFxuICAgICAgbW91c2U6IHBvaW50ZXIsXG4gICAgICBmcmFtZWxvb3A6ICdhbHdheXMnLFxuICAgICAgb25Qb2ludGVyTWlzc2VkOiB1bmRlZmluZWQsXG4gICAgICBwZXJmb3JtYW5jZToge1xuICAgICAgICBjdXJyZW50OiAxLFxuICAgICAgICBtaW46IDAuNSxcbiAgICAgICAgbWF4OiAxLFxuICAgICAgICBkZWJvdW5jZTogMjAwLFxuICAgICAgICByZWdyZXNzOiAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RhdGUgPSBnZXQoKTtcbiAgICAgICAgICAvLyBDbGVhciB0aW1lb3V0XG4gICAgICAgICAgaWYgKHBlcmZvcm1hbmNlVGltZW91dCkgY2xlYXJUaW1lb3V0KHBlcmZvcm1hbmNlVGltZW91dCk7XG4gICAgICAgICAgLy8gU2V0IGxvd2VyIGJvdW5kIHBlcmZvcm1hbmNlXG4gICAgICAgICAgaWYgKHN0YXRlLnBlcmZvcm1hbmNlLmN1cnJlbnQgIT09IHN0YXRlLnBlcmZvcm1hbmNlLm1pbikgc2V0UGVyZm9ybWFuY2VDdXJyZW50KHN0YXRlLnBlcmZvcm1hbmNlLm1pbik7XG4gICAgICAgICAgLy8gR28gYmFjayB0byB1cHBlciBib3VuZCBwZXJmb3JtYW5jZSBhZnRlciBhIHdoaWxlIHVubGVzcyBzb21ldGhpbmcgcmVncmVzc2VzIG1lYW53aGlsZVxuICAgICAgICAgIHBlcmZvcm1hbmNlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gc2V0UGVyZm9ybWFuY2VDdXJyZW50KGdldCgpLnBlcmZvcm1hbmNlLm1heCksIHN0YXRlLnBlcmZvcm1hbmNlLmRlYm91bmNlKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNpemU6IHtcbiAgICAgICAgd2lkdGg6IDAsXG4gICAgICAgIGhlaWdodDogMCxcbiAgICAgICAgdG9wOiAwLFxuICAgICAgICBsZWZ0OiAwLFxuICAgICAgICB1cGRhdGVTdHlsZTogZmFsc2VcbiAgICAgIH0sXG4gICAgICB2aWV3cG9ydDoge1xuICAgICAgICBpbml0aWFsRHByOiAwLFxuICAgICAgICBkcHI6IDAsXG4gICAgICAgIHdpZHRoOiAwLFxuICAgICAgICBoZWlnaHQ6IDAsXG4gICAgICAgIHRvcDogMCxcbiAgICAgICAgbGVmdDogMCxcbiAgICAgICAgYXNwZWN0OiAwLFxuICAgICAgICBkaXN0YW5jZTogMCxcbiAgICAgICAgZmFjdG9yOiAwLFxuICAgICAgICBnZXRDdXJyZW50Vmlld3BvcnRcbiAgICAgIH0sXG4gICAgICBzZXRFdmVudHM6IGV2ZW50cyA9PiBzZXQoc3RhdGUgPT4gKHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGV2ZW50czoge1xuICAgICAgICAgIC4uLnN0YXRlLmV2ZW50cyxcbiAgICAgICAgICAuLi5ldmVudHNcbiAgICAgICAgfVxuICAgICAgfSkpLFxuICAgICAgc2V0U2l6ZTogKHdpZHRoLCBoZWlnaHQsIHVwZGF0ZVN0eWxlLCB0b3AsIGxlZnQpID0+IHtcbiAgICAgICAgY29uc3QgY2FtZXJhID0gZ2V0KCkuY2FtZXJhO1xuICAgICAgICBjb25zdCBzaXplID0ge1xuICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICB0b3A6IHRvcCB8fCAwLFxuICAgICAgICAgIGxlZnQ6IGxlZnQgfHwgMCxcbiAgICAgICAgICB1cGRhdGVTdHlsZVxuICAgICAgICB9O1xuICAgICAgICBzZXQoc3RhdGUgPT4gKHtcbiAgICAgICAgICBzaXplLFxuICAgICAgICAgIHZpZXdwb3J0OiB7XG4gICAgICAgICAgICAuLi5zdGF0ZS52aWV3cG9ydCxcbiAgICAgICAgICAgIC4uLmdldEN1cnJlbnRWaWV3cG9ydChjYW1lcmEsIGRlZmF1bHRUYXJnZXQsIHNpemUpXG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICB9LFxuICAgICAgc2V0RHByOiBkcHIgPT4gc2V0KHN0YXRlID0+IHtcbiAgICAgICAgY29uc3QgcmVzb2x2ZWQgPSBjYWxjdWxhdGVEcHIoZHByKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2aWV3cG9ydDoge1xuICAgICAgICAgICAgLi4uc3RhdGUudmlld3BvcnQsXG4gICAgICAgICAgICBkcHI6IHJlc29sdmVkLFxuICAgICAgICAgICAgaW5pdGlhbERwcjogc3RhdGUudmlld3BvcnQuaW5pdGlhbERwciB8fCByZXNvbHZlZFxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgICAgc2V0RnJhbWVsb29wOiAoZnJhbWVsb29wID0gJ2Fsd2F5cycpID0+IHtcbiAgICAgICAgY29uc3QgY2xvY2sgPSBnZXQoKS5jbG9jaztcblxuICAgICAgICAvLyBpZiBmcmFtZWxvb3AgPT09IFwibmV2ZXJcIiBjbG9jay5lbGFwc2VkVGltZSBpcyB1cGRhdGVkIHVzaW5nIGFkdmFuY2UodGltZXN0YW1wKVxuICAgICAgICBjbG9jay5zdG9wKCk7XG4gICAgICAgIGNsb2NrLmVsYXBzZWRUaW1lID0gMDtcbiAgICAgICAgaWYgKGZyYW1lbG9vcCAhPT0gJ25ldmVyJykge1xuICAgICAgICAgIGNsb2NrLnN0YXJ0KCk7XG4gICAgICAgICAgY2xvY2suZWxhcHNlZFRpbWUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHNldCgoKSA9PiAoe1xuICAgICAgICAgIGZyYW1lbG9vcFxuICAgICAgICB9KSk7XG4gICAgICB9LFxuICAgICAgcHJldmlvdXNSb290OiB1bmRlZmluZWQsXG4gICAgICBpbnRlcm5hbDoge1xuICAgICAgICBhY3RpdmU6IGZhbHNlLFxuICAgICAgICBwcmlvcml0eTogMCxcbiAgICAgICAgZnJhbWVzOiAwLFxuICAgICAgICBsYXN0RXZlbnQ6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVSZWYoKSxcbiAgICAgICAgaW50ZXJhY3Rpb246IFtdLFxuICAgICAgICBob3ZlcmVkOiBuZXcgTWFwKCksXG4gICAgICAgIHN1YnNjcmliZXJzOiBbXSxcbiAgICAgICAgaW5pdGlhbENsaWNrOiBbMCwgMF0sXG4gICAgICAgIGluaXRpYWxIaXRzOiBbXSxcbiAgICAgICAgY2FwdHVyZWRNYXA6IG5ldyBNYXAoKSxcbiAgICAgICAgc3Vic2NyaWJlOiAocmVmLCBwcmlvcml0eSwgc3RvcmUpID0+IHtcbiAgICAgICAgICBjb25zdCBpbnRlcm5hbCA9IGdldCgpLmludGVybmFsO1xuICAgICAgICAgIC8vIElmIHRoaXMgc3Vic2NyaXB0aW9uIHdhcyBnaXZlbiBhIHByaW9yaXR5LCBpdCB0YWtlcyByZW5kZXJpbmcgaW50byBpdHMgb3duIGhhbmRzXG4gICAgICAgICAgLy8gRm9yIHRoYXQgcmVhc29uIHdlIHN3aXRjaCBvZmYgYXV0b21hdGljIHJlbmRlcmluZyBhbmQgaW5jcmVhc2UgdGhlIG1hbnVhbCBmbGFnXG4gICAgICAgICAgLy8gQXMgbG9uZyBhcyB0aGlzIGZsYWcgaXMgcG9zaXRpdmUgdGhlcmUgY2FuIGJlIG5vIGludGVybmFsIHJlbmRlcmluZyBhdCBhbGxcbiAgICAgICAgICAvLyBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG11bHRpcGxlIHJlbmRlciBzdWJzY3JpcHRpb25zXG4gICAgICAgICAgaW50ZXJuYWwucHJpb3JpdHkgPSBpbnRlcm5hbC5wcmlvcml0eSArIChwcmlvcml0eSA+IDAgPyAxIDogMCk7XG4gICAgICAgICAgaW50ZXJuYWwuc3Vic2NyaWJlcnMucHVzaCh7XG4gICAgICAgICAgICByZWYsXG4gICAgICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgICAgIHN0b3JlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy8gUmVnaXN0ZXIgc3Vic2NyaWJlciBhbmQgc29ydCBsYXllcnMgZnJvbSBsb3dlc3QgdG8gaGlnaGVzdCwgbWVhbmluZyxcbiAgICAgICAgICAvLyBoaWdoZXN0IHByaW9yaXR5IHJlbmRlcnMgbGFzdCAob24gdG9wIG9mIHRoZSBvdGhlciBmcmFtZXMpXG4gICAgICAgICAgaW50ZXJuYWwuc3Vic2NyaWJlcnMgPSBpbnRlcm5hbC5zdWJzY3JpYmVycy5zb3J0KChhLCBiKSA9PiBhLnByaW9yaXR5IC0gYi5wcmlvcml0eSk7XG4gICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGludGVybmFsID0gZ2V0KCkuaW50ZXJuYWw7XG4gICAgICAgICAgICBpZiAoaW50ZXJuYWwgIT0gbnVsbCAmJiBpbnRlcm5hbC5zdWJzY3JpYmVycykge1xuICAgICAgICAgICAgICAvLyBEZWNyZWFzZSBtYW51YWwgZmxhZyBpZiB0aGlzIHN1YnNjcmlwdGlvbiBoYWQgYSBwcmlvcml0eVxuICAgICAgICAgICAgICBpbnRlcm5hbC5wcmlvcml0eSA9IGludGVybmFsLnByaW9yaXR5IC0gKHByaW9yaXR5ID4gMCA/IDEgOiAwKTtcbiAgICAgICAgICAgICAgLy8gUmVtb3ZlIHN1YnNjcmliZXIgZnJvbSBsaXN0XG4gICAgICAgICAgICAgIGludGVybmFsLnN1YnNjcmliZXJzID0gaW50ZXJuYWwuc3Vic2NyaWJlcnMuZmlsdGVyKHMgPT4gcy5yZWYgIT09IHJlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIHJvb3RTdGF0ZTtcbiAgfSk7XG4gIGNvbnN0IHN0YXRlID0gcm9vdFN0YXRlLmdldFN0YXRlKCk7XG4gIGxldCBvbGRTaXplID0gc3RhdGUuc2l6ZTtcbiAgbGV0IG9sZERwciA9IHN0YXRlLnZpZXdwb3J0LmRwcjtcbiAgbGV0IG9sZENhbWVyYSA9IHN0YXRlLmNhbWVyYTtcbiAgcm9vdFN0YXRlLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgY2FtZXJhLFxuICAgICAgc2l6ZSxcbiAgICAgIHZpZXdwb3J0LFxuICAgICAgZ2wsXG4gICAgICBzZXRcbiAgICB9ID0gcm9vdFN0YXRlLmdldFN0YXRlKCk7XG5cbiAgICAvLyBSZXNpemUgY2FtZXJhIGFuZCByZW5kZXJlciBvbiBjaGFuZ2VzIHRvIHNpemUgYW5kIHBpeGVscmF0aW9cbiAgICBpZiAoc2l6ZS53aWR0aCAhPT0gb2xkU2l6ZS53aWR0aCB8fCBzaXplLmhlaWdodCAhPT0gb2xkU2l6ZS5oZWlnaHQgfHwgdmlld3BvcnQuZHByICE9PSBvbGREcHIpIHtcbiAgICAgIHZhciBfc2l6ZSR1cGRhdGVTdHlsZTtcbiAgICAgIG9sZFNpemUgPSBzaXplO1xuICAgICAgb2xkRHByID0gdmlld3BvcnQuZHByO1xuICAgICAgLy8gVXBkYXRlIGNhbWVyYSAmIHJlbmRlcmVyXG4gICAgICB1cGRhdGVDYW1lcmEoY2FtZXJhLCBzaXplKTtcbiAgICAgIGdsLnNldFBpeGVsUmF0aW8odmlld3BvcnQuZHByKTtcbiAgICAgIGNvbnN0IHVwZGF0ZVN0eWxlID0gKF9zaXplJHVwZGF0ZVN0eWxlID0gc2l6ZS51cGRhdGVTdHlsZSkgIT0gbnVsbCA/IF9zaXplJHVwZGF0ZVN0eWxlIDogdHlwZW9mIEhUTUxDYW52YXNFbGVtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBnbC5kb21FbGVtZW50IGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgICBnbC5zZXRTaXplKHNpemUud2lkdGgsIHNpemUuaGVpZ2h0LCB1cGRhdGVTdHlsZSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHZpZXdwb3J0IG9uY2UgdGhlIGNhbWVyYSBjaGFuZ2VzXG4gICAgaWYgKGNhbWVyYSAhPT0gb2xkQ2FtZXJhKSB7XG4gICAgICBvbGRDYW1lcmEgPSBjYW1lcmE7XG4gICAgICAvLyBVcGRhdGUgdmlld3BvcnRcbiAgICAgIHNldChzdGF0ZSA9PiAoe1xuICAgICAgICB2aWV3cG9ydDoge1xuICAgICAgICAgIC4uLnN0YXRlLnZpZXdwb3J0LFxuICAgICAgICAgIC4uLnN0YXRlLnZpZXdwb3J0LmdldEN1cnJlbnRWaWV3cG9ydChjYW1lcmEpXG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIEludmFsaWRhdGUgb24gYW55IGNoYW5nZVxuICByb290U3RhdGUuc3Vic2NyaWJlKHN0YXRlID0+IGludmFsaWRhdGUoc3RhdGUpKTtcblxuICAvLyBSZXR1cm4gcm9vdCBzdGF0ZVxuICByZXR1cm4gcm9vdFN0YXRlO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlU3VicyhjYWxsYmFjaywgc3Vicykge1xuICBjb25zdCBzdWIgPSB7XG4gICAgY2FsbGJhY2tcbiAgfTtcbiAgc3Vicy5hZGQoc3ViKTtcbiAgcmV0dXJuICgpID0+IHZvaWQgc3Vicy5kZWxldGUoc3ViKTtcbn1cbmxldCBpO1xubGV0IGdsb2JhbEVmZmVjdHMgPSBuZXcgU2V0KCk7XG5sZXQgZ2xvYmFsQWZ0ZXJFZmZlY3RzID0gbmV3IFNldCgpO1xubGV0IGdsb2JhbFRhaWxFZmZlY3RzID0gbmV3IFNldCgpO1xuXG4vKipcclxuICogQWRkcyBhIGdsb2JhbCByZW5kZXIgY2FsbGJhY2sgd2hpY2ggaXMgY2FsbGVkIGVhY2ggZnJhbWUuXHJcbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLnBtbmQucnMvcmVhY3QtdGhyZWUtZmliZXIvYXBpL2FkZGl0aW9uYWwtZXhwb3J0cyNhZGRFZmZlY3RcclxuICovXG5jb25zdCBhZGRFZmZlY3QgPSBjYWxsYmFjayA9PiBjcmVhdGVTdWJzKGNhbGxiYWNrLCBnbG9iYWxFZmZlY3RzKTtcblxuLyoqXHJcbiAqIEFkZHMgYSBnbG9iYWwgYWZ0ZXItcmVuZGVyIGNhbGxiYWNrIHdoaWNoIGlzIGNhbGxlZCBlYWNoIGZyYW1lLlxyXG4gKiBAc2VlIGh0dHBzOi8vZG9jcy5wbW5kLnJzL3JlYWN0LXRocmVlLWZpYmVyL2FwaS9hZGRpdGlvbmFsLWV4cG9ydHMjYWRkQWZ0ZXJFZmZlY3RcclxuICovXG5jb25zdCBhZGRBZnRlckVmZmVjdCA9IGNhbGxiYWNrID0+IGNyZWF0ZVN1YnMoY2FsbGJhY2ssIGdsb2JhbEFmdGVyRWZmZWN0cyk7XG5cbi8qKlxyXG4gKiBBZGRzIGEgZ2xvYmFsIGNhbGxiYWNrIHdoaWNoIGlzIGNhbGxlZCB3aGVuIHJlbmRlcmluZyBzdG9wcy5cclxuICogQHNlZSBodHRwczovL2RvY3MucG1uZC5ycy9yZWFjdC10aHJlZS1maWJlci9hcGkvYWRkaXRpb25hbC1leHBvcnRzI2FkZFRhaWxcclxuICovXG5jb25zdCBhZGRUYWlsID0gY2FsbGJhY2sgPT4gY3JlYXRlU3VicyhjYWxsYmFjaywgZ2xvYmFsVGFpbEVmZmVjdHMpO1xuZnVuY3Rpb24gcnVuKGVmZmVjdHMsIHRpbWVzdGFtcCkge1xuICBpZiAoIWVmZmVjdHMuc2l6ZSkgcmV0dXJuO1xuICBmb3IgKGNvbnN0IHtcbiAgICBjYWxsYmFja1xuICB9IG9mIGVmZmVjdHMudmFsdWVzKCkpIHtcbiAgICBjYWxsYmFjayh0aW1lc3RhbXApO1xuICB9XG59XG5mdW5jdGlvbiBmbHVzaEdsb2JhbEVmZmVjdHModHlwZSwgdGltZXN0YW1wKSB7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ2JlZm9yZSc6XG4gICAgICByZXR1cm4gcnVuKGdsb2JhbEVmZmVjdHMsIHRpbWVzdGFtcCk7XG4gICAgY2FzZSAnYWZ0ZXInOlxuICAgICAgcmV0dXJuIHJ1bihnbG9iYWxBZnRlckVmZmVjdHMsIHRpbWVzdGFtcCk7XG4gICAgY2FzZSAndGFpbCc6XG4gICAgICByZXR1cm4gcnVuKGdsb2JhbFRhaWxFZmZlY3RzLCB0aW1lc3RhbXApO1xuICB9XG59XG5sZXQgc3Vic2NyaWJlcnM7XG5sZXQgc3Vic2NyaXB0aW9uO1xuZnVuY3Rpb24gcmVuZGVyJDEodGltZXN0YW1wLCBzdGF0ZSwgZnJhbWUpIHtcbiAgLy8gUnVuIGxvY2FsIGVmZmVjdHNcbiAgbGV0IGRlbHRhID0gc3RhdGUuY2xvY2suZ2V0RGVsdGEoKTtcbiAgLy8gSW4gZnJhbWVsb29wPSduZXZlcicgbW9kZSwgY2xvY2sgdGltZXMgYXJlIHVwZGF0ZWQgdXNpbmcgdGhlIHByb3ZpZGVkIHRpbWVzdGFtcFxuICBpZiAoc3RhdGUuZnJhbWVsb29wID09PSAnbmV2ZXInICYmIHR5cGVvZiB0aW1lc3RhbXAgPT09ICdudW1iZXInKSB7XG4gICAgZGVsdGEgPSB0aW1lc3RhbXAgLSBzdGF0ZS5jbG9jay5lbGFwc2VkVGltZTtcbiAgICBzdGF0ZS5jbG9jay5vbGRUaW1lID0gc3RhdGUuY2xvY2suZWxhcHNlZFRpbWU7XG4gICAgc3RhdGUuY2xvY2suZWxhcHNlZFRpbWUgPSB0aW1lc3RhbXA7XG4gIH1cbiAgLy8gQ2FsbCBzdWJzY3JpYmVycyAodXNlRnJhbWUpXG4gIHN1YnNjcmliZXJzID0gc3RhdGUuaW50ZXJuYWwuc3Vic2NyaWJlcnM7XG4gIGZvciAoaSA9IDA7IGkgPCBzdWJzY3JpYmVycy5sZW5ndGg7IGkrKykge1xuICAgIHN1YnNjcmlwdGlvbiA9IHN1YnNjcmliZXJzW2ldO1xuICAgIHN1YnNjcmlwdGlvbi5yZWYuY3VycmVudChzdWJzY3JpcHRpb24uc3RvcmUuZ2V0U3RhdGUoKSwgZGVsdGEsIGZyYW1lKTtcbiAgfVxuICAvLyBSZW5kZXIgY29udGVudFxuICBpZiAoIXN0YXRlLmludGVybmFsLnByaW9yaXR5ICYmIHN0YXRlLmdsLnJlbmRlcikgc3RhdGUuZ2wucmVuZGVyKHN0YXRlLnNjZW5lLCBzdGF0ZS5jYW1lcmEpO1xuICAvLyBEZWNyZWFzZSBmcmFtZSBjb3VudFxuICBzdGF0ZS5pbnRlcm5hbC5mcmFtZXMgPSBNYXRoLm1heCgwLCBzdGF0ZS5pbnRlcm5hbC5mcmFtZXMgLSAxKTtcbiAgcmV0dXJuIHN0YXRlLmZyYW1lbG9vcCA9PT0gJ2Fsd2F5cycgPyAxIDogc3RhdGUuaW50ZXJuYWwuZnJhbWVzO1xufVxuZnVuY3Rpb24gY3JlYXRlTG9vcChyb290cykge1xuICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICBsZXQgdXNlRnJhbWVJblByb2dyZXNzID0gZmFsc2U7XG4gIGxldCByZXBlYXQ7XG4gIGxldCBmcmFtZTtcbiAgbGV0IHN0YXRlO1xuICBmdW5jdGlvbiBsb29wKHRpbWVzdGFtcCkge1xuICAgIGZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgIHJlcGVhdCA9IDA7XG5cbiAgICAvLyBSdW4gZWZmZWN0c1xuICAgIGZsdXNoR2xvYmFsRWZmZWN0cygnYmVmb3JlJywgdGltZXN0YW1wKTtcblxuICAgIC8vIFJlbmRlciBhbGwgcm9vdHNcbiAgICB1c2VGcmFtZUluUHJvZ3Jlc3MgPSB0cnVlO1xuICAgIGZvciAoY29uc3Qgcm9vdCBvZiByb290cy52YWx1ZXMoKSkge1xuICAgICAgdmFyIF9zdGF0ZSRnbCR4cjtcbiAgICAgIHN0YXRlID0gcm9vdC5zdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgLy8gSWYgdGhlIGZyYW1lbG9vcCBpcyBpbnZhbGlkYXRlZCwgZG8gbm90IHJ1biBhbm90aGVyIGZyYW1lXG4gICAgICBpZiAoc3RhdGUuaW50ZXJuYWwuYWN0aXZlICYmIChzdGF0ZS5mcmFtZWxvb3AgPT09ICdhbHdheXMnIHx8IHN0YXRlLmludGVybmFsLmZyYW1lcyA+IDApICYmICEoKF9zdGF0ZSRnbCR4ciA9IHN0YXRlLmdsLnhyKSAhPSBudWxsICYmIF9zdGF0ZSRnbCR4ci5pc1ByZXNlbnRpbmcpKSB7XG4gICAgICAgIHJlcGVhdCArPSByZW5kZXIkMSh0aW1lc3RhbXAsIHN0YXRlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdXNlRnJhbWVJblByb2dyZXNzID0gZmFsc2U7XG5cbiAgICAvLyBSdW4gYWZ0ZXItZWZmZWN0c1xuICAgIGZsdXNoR2xvYmFsRWZmZWN0cygnYWZ0ZXInLCB0aW1lc3RhbXApO1xuXG4gICAgLy8gU3RvcCB0aGUgbG9vcCBpZiBub3RoaW5nIGludmFsaWRhdGVzIGl0XG4gICAgaWYgKHJlcGVhdCA9PT0gMCkge1xuICAgICAgLy8gVGFpbCBjYWxsIGVmZmVjdHMsIHRoZXkgYXJlIGNhbGxlZCB3aGVuIHJlbmRlcmluZyBzdG9wc1xuICAgICAgZmx1c2hHbG9iYWxFZmZlY3RzKCd0YWlsJywgdGltZXN0YW1wKTtcblxuICAgICAgLy8gRmxhZyBlbmQgb2Ygb3BlcmF0aW9uXG4gICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICByZXR1cm4gY2FuY2VsQW5pbWF0aW9uRnJhbWUoZnJhbWUpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBpbnZhbGlkYXRlKHN0YXRlLCBmcmFtZXMgPSAxKSB7XG4gICAgdmFyIF9zdGF0ZSRnbCR4cjI7XG4gICAgaWYgKCFzdGF0ZSkgcmV0dXJuIHJvb3RzLmZvckVhY2gocm9vdCA9PiBpbnZhbGlkYXRlKHJvb3Quc3RvcmUuZ2V0U3RhdGUoKSwgZnJhbWVzKSk7XG4gICAgaWYgKChfc3RhdGUkZ2wkeHIyID0gc3RhdGUuZ2wueHIpICE9IG51bGwgJiYgX3N0YXRlJGdsJHhyMi5pc1ByZXNlbnRpbmcgfHwgIXN0YXRlLmludGVybmFsLmFjdGl2ZSB8fCBzdGF0ZS5mcmFtZWxvb3AgPT09ICduZXZlcicpIHJldHVybjtcbiAgICBpZiAoZnJhbWVzID4gMSkge1xuICAgICAgLy8gbGVnYWN5IHN1cHBvcnQgZm9yIHBlb3BsZSB1c2luZyBmcmFtZXMgcGFyYW1ldGVyc1xuICAgICAgLy8gSW5jcmVhc2UgZnJhbWVzLCBkbyBub3QgZ28gaGlnaGVyIHRoYW4gNjBcbiAgICAgIHN0YXRlLmludGVybmFsLmZyYW1lcyA9IE1hdGgubWluKDYwLCBzdGF0ZS5pbnRlcm5hbC5mcmFtZXMgKyBmcmFtZXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodXNlRnJhbWVJblByb2dyZXNzKSB7XG4gICAgICAgIC8vY2FsbGVkIGZyb20gd2l0aGluIGEgdXNlRnJhbWUsIGl0IG1lYW5zIHRoZSB1c2VyIHdhbnRzIGFuIGFkZGl0aW9uYWwgZnJhbWVcbiAgICAgICAgc3RhdGUuaW50ZXJuYWwuZnJhbWVzID0gMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vdGhlIHVzZXIgbmVlZCBhIG5ldyBmcmFtZSwgbm8gbmVlZCB0byBpbmNyZW1lbnQgZnVydGhlciB0aGFuIDFcbiAgICAgICAgc3RhdGUuaW50ZXJuYWwuZnJhbWVzID0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgcmVuZGVyLWxvb3AgaXNuJ3QgYWN0aXZlLCBzdGFydCBpdFxuICAgIGlmICghcnVubmluZykge1xuICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGFkdmFuY2UodGltZXN0YW1wLCBydW5HbG9iYWxFZmZlY3RzID0gdHJ1ZSwgc3RhdGUsIGZyYW1lKSB7XG4gICAgaWYgKHJ1bkdsb2JhbEVmZmVjdHMpIGZsdXNoR2xvYmFsRWZmZWN0cygnYmVmb3JlJywgdGltZXN0YW1wKTtcbiAgICBpZiAoIXN0YXRlKSBmb3IgKGNvbnN0IHJvb3Qgb2Ygcm9vdHMudmFsdWVzKCkpIHJlbmRlciQxKHRpbWVzdGFtcCwgcm9vdC5zdG9yZS5nZXRTdGF0ZSgpKTtlbHNlIHJlbmRlciQxKHRpbWVzdGFtcCwgc3RhdGUsIGZyYW1lKTtcbiAgICBpZiAocnVuR2xvYmFsRWZmZWN0cykgZmx1c2hHbG9iYWxFZmZlY3RzKCdhZnRlcicsIHRpbWVzdGFtcCk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBsb29wLFxuICAgIGludmFsaWRhdGUsXG4gICAgYWR2YW5jZVxuICB9O1xufVxuXG4vKipcclxuICogRXhwb3NlcyBhbiBvYmplY3QncyB7QGxpbmsgTG9jYWxTdGF0ZX0uXHJcbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLnBtbmQucnMvcmVhY3QtdGhyZWUtZmliZXIvYXBpL2FkZGl0aW9uYWwtZXhwb3J0cyN1c2VJbnN0YW5jZUhhbmRsZVxyXG4gKlxyXG4gKiAqKk5vdGUqKjogdGhpcyBpcyBhbiBlc2NhcGUgaGF0Y2ggdG8gcmVhY3QtaW50ZXJuYWwgZmllbGRzLiBFeHBlY3QgdGhpcyB0byBjaGFuZ2Ugc2lnbmlmaWNhbnRseSBiZXR3ZWVuIHZlcnNpb25zLlxyXG4gKi9cbmZ1bmN0aW9uIHVzZUluc3RhbmNlSGFuZGxlKHJlZikge1xuICBjb25zdCBpbnN0YW5jZSA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgdXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdCgoKSA9PiB2b2lkIChpbnN0YW5jZS5jdXJyZW50ID0gcmVmLmN1cnJlbnQuX19yM2YpLCBbcmVmXSk7XG4gIHJldHVybiBpbnN0YW5jZTtcbn1cbmZ1bmN0aW9uIHVzZVN0b3JlKCkge1xuICBjb25zdCBzdG9yZSA9IFJlYWN0LnVzZUNvbnRleHQoY29udGV4dCk7XG4gIGlmICghc3RvcmUpIHRocm93IG5ldyBFcnJvcignUjNGOiBIb29rcyBjYW4gb25seSBiZSB1c2VkIHdpdGhpbiB0aGUgQ2FudmFzIGNvbXBvbmVudCEnKTtcbiAgcmV0dXJuIHN0b3JlO1xufVxuXG4vKipcclxuICogQWNjZXNzZXMgUjNGJ3MgaW50ZXJuYWwgc3RhdGUsIGNvbnRhaW5pbmcgcmVuZGVyZXIsIGNhbnZhcywgc2NlbmUsIGV0Yy5cclxuICogQHNlZSBodHRwczovL2RvY3MucG1uZC5ycy9yZWFjdC10aHJlZS1maWJlci9hcGkvaG9va3MjdXNldGhyZWVcclxuICovXG5mdW5jdGlvbiB1c2VUaHJlZShzZWxlY3RvciA9IHN0YXRlID0+IHN0YXRlLCBlcXVhbGl0eUZuKSB7XG4gIHJldHVybiB1c2VTdG9yZSgpKHNlbGVjdG9yLCBlcXVhbGl0eUZuKTtcbn1cblxuLyoqXHJcbiAqIEV4ZWN1dGVzIGEgY2FsbGJhY2sgYmVmb3JlIHJlbmRlciBpbiBhIHNoYXJlZCBmcmFtZSBsb29wLlxyXG4gKiBDYW4gb3JkZXIgZWZmZWN0cyB3aXRoIHJlbmRlciBwcmlvcml0eSBvciBtYW51YWxseSByZW5kZXIgd2l0aCBhIHBvc2l0aXZlIHByaW9yaXR5LlxyXG4gKiBAc2VlIGh0dHBzOi8vZG9jcy5wbW5kLnJzL3JlYWN0LXRocmVlLWZpYmVyL2FwaS9ob29rcyN1c2VmcmFtZVxyXG4gKi9cbmZ1bmN0aW9uIHVzZUZyYW1lKGNhbGxiYWNrLCByZW5kZXJQcmlvcml0eSA9IDApIHtcbiAgY29uc3Qgc3RvcmUgPSB1c2VTdG9yZSgpO1xuICBjb25zdCBzdWJzY3JpYmUgPSBzdG9yZS5nZXRTdGF0ZSgpLmludGVybmFsLnN1YnNjcmliZTtcbiAgLy8gTWVtb2l6ZSByZWZcbiAgY29uc3QgcmVmID0gdXNlTXV0YWJsZUNhbGxiYWNrKGNhbGxiYWNrKTtcbiAgLy8gU3Vic2NyaWJlIG9uIG1vdW50LCB1bnN1YnNjcmliZSBvbiB1bm1vdW50XG4gIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QoKCkgPT4gc3Vic2NyaWJlKHJlZiwgcmVuZGVyUHJpb3JpdHksIHN0b3JlKSwgW3JlbmRlclByaW9yaXR5LCBzdWJzY3JpYmUsIHN0b3JlXSk7XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcclxuICogUmV0dXJucyBhIG5vZGUgZ3JhcGggb2YgYW4gb2JqZWN0IHdpdGggbmFtZWQgbm9kZXMgJiBtYXRlcmlhbHMuXHJcbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLnBtbmQucnMvcmVhY3QtdGhyZWUtZmliZXIvYXBpL2hvb2tzI3VzZWdyYXBoXHJcbiAqL1xuZnVuY3Rpb24gdXNlR3JhcGgob2JqZWN0KSB7XG4gIHJldHVybiBSZWFjdC51c2VNZW1vKCgpID0+IGJ1aWxkR3JhcGgob2JqZWN0KSwgW29iamVjdF0pO1xufVxuY29uc3QgbWVtb2l6ZWRMb2FkZXJzID0gbmV3IFdlYWtNYXAoKTtcbmZ1bmN0aW9uIGxvYWRpbmdGbihleHRlbnNpb25zLCBvblByb2dyZXNzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoUHJvdG8sIC4uLmlucHV0KSB7XG4gICAgLy8gQ29uc3RydWN0IG5ldyBsb2FkZXIgYW5kIHJ1biBleHRlbnNpb25zXG4gICAgbGV0IGxvYWRlciA9IG1lbW9pemVkTG9hZGVycy5nZXQoUHJvdG8pO1xuICAgIGlmICghbG9hZGVyKSB7XG4gICAgICBsb2FkZXIgPSBuZXcgUHJvdG8oKTtcbiAgICAgIG1lbW9pemVkTG9hZGVycy5zZXQoUHJvdG8sIGxvYWRlcik7XG4gICAgfVxuICAgIGlmIChleHRlbnNpb25zKSBleHRlbnNpb25zKGxvYWRlcik7XG4gICAgLy8gR28gdGhyb3VnaCB0aGUgdXJscyBhbmQgbG9hZCB0aGVtXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGlucHV0Lm1hcChpbnB1dCA9PiBuZXcgUHJvbWlzZSgocmVzLCByZWplY3QpID0+IGxvYWRlci5sb2FkKGlucHV0LCBkYXRhID0+IHtcbiAgICAgIGlmIChkYXRhLnNjZW5lKSBPYmplY3QuYXNzaWduKGRhdGEsIGJ1aWxkR3JhcGgoZGF0YS5zY2VuZSkpO1xuICAgICAgcmVzKGRhdGEpO1xuICAgIH0sIG9uUHJvZ3Jlc3MsIGVycm9yID0+IHJlamVjdChuZXcgRXJyb3IoYENvdWxkIG5vdCBsb2FkICR7aW5wdXR9OiAke2Vycm9yID09IG51bGwgPyB2b2lkIDAgOiBlcnJvci5tZXNzYWdlfWApKSkpKSk7XG4gIH07XG59XG4vKipcclxuICogU3luY2hyb25vdXNseSBsb2FkcyBhbmQgY2FjaGVzIGFzc2V0cyB3aXRoIGEgdGhyZWUgbG9hZGVyLlxyXG4gKlxyXG4gKiBOb3RlOiB0aGlzIGhvb2sncyBjYWxsZXIgbXVzdCBiZSB3cmFwcGVkIHdpdGggYFJlYWN0LlN1c3BlbnNlYFxyXG4gKiBAc2VlIGh0dHBzOi8vZG9jcy5wbW5kLnJzL3JlYWN0LXRocmVlLWZpYmVyL2FwaS9ob29rcyN1c2Vsb2FkZXJcclxuICovXG5mdW5jdGlvbiB1c2VMb2FkZXIoUHJvdG8sIGlucHV0LCBleHRlbnNpb25zLCBvblByb2dyZXNzKSB7XG4gIC8vIFVzZSBzdXNwZW5zZSB0byBsb2FkIGFzeW5jIGFzc2V0c1xuICBjb25zdCBrZXlzID0gQXJyYXkuaXNBcnJheShpbnB1dCkgPyBpbnB1dCA6IFtpbnB1dF07XG4gIGNvbnN0IHJlc3VsdHMgPSBzdXNwZW5kKGxvYWRpbmdGbihleHRlbnNpb25zLCBvblByb2dyZXNzKSwgW1Byb3RvLCAuLi5rZXlzXSwge1xuICAgIGVxdWFsOiBpcy5lcXVcbiAgfSk7XG4gIC8vIFJldHVybiB0aGUgb2JqZWN0L3NcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoaW5wdXQpID8gcmVzdWx0cyA6IHJlc3VsdHNbMF07XG59XG5cbi8qKlxyXG4gKiBQcmVsb2FkcyBhbiBhc3NldCBpbnRvIGNhY2hlIGFzIGEgc2lkZS1lZmZlY3QuXHJcbiAqL1xudXNlTG9hZGVyLnByZWxvYWQgPSBmdW5jdGlvbiAoUHJvdG8sIGlucHV0LCBleHRlbnNpb25zKSB7XG4gIGNvbnN0IGtleXMgPSBBcnJheS5pc0FycmF5KGlucHV0KSA/IGlucHV0IDogW2lucHV0XTtcbiAgcmV0dXJuIHByZWxvYWQobG9hZGluZ0ZuKGV4dGVuc2lvbnMpLCBbUHJvdG8sIC4uLmtleXNdKTtcbn07XG5cbi8qKlxyXG4gKiBSZW1vdmVzIGEgbG9hZGVkIGFzc2V0IGZyb20gY2FjaGUuXHJcbiAqL1xudXNlTG9hZGVyLmNsZWFyID0gZnVuY3Rpb24gKFByb3RvLCBpbnB1dCkge1xuICBjb25zdCBrZXlzID0gQXJyYXkuaXNBcnJheShpbnB1dCkgPyBpbnB1dCA6IFtpbnB1dF07XG4gIHJldHVybiBjbGVhcihbUHJvdG8sIC4uLmtleXNdKTtcbn07XG5cbmNvbnN0IHJvb3RzID0gbmV3IE1hcCgpO1xuY29uc3Qge1xuICBpbnZhbGlkYXRlLFxuICBhZHZhbmNlXG59ID0gY3JlYXRlTG9vcChyb290cyk7XG5jb25zdCB7XG4gIHJlY29uY2lsZXIsXG4gIGFwcGx5UHJvcHNcbn0gPSBjcmVhdGVSZW5kZXJlcihyb290cywgZ2V0RXZlbnRQcmlvcml0eSk7XG5jb25zdCBzaGFsbG93TG9vc2UgPSB7XG4gIG9iamVjdHM6ICdzaGFsbG93JyxcbiAgc3RyaWN0OiBmYWxzZVxufTtcbmNvbnN0IGNyZWF0ZVJlbmRlcmVySW5zdGFuY2UgPSAoZ2wsIGNhbnZhcykgPT4ge1xuICBjb25zdCBjdXN0b21SZW5kZXJlciA9IHR5cGVvZiBnbCA9PT0gJ2Z1bmN0aW9uJyA/IGdsKGNhbnZhcykgOiBnbDtcbiAgaWYgKGlzUmVuZGVyZXIoY3VzdG9tUmVuZGVyZXIpKSByZXR1cm4gY3VzdG9tUmVuZGVyZXI7ZWxzZSByZXR1cm4gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoe1xuICAgIHBvd2VyUHJlZmVyZW5jZTogJ2hpZ2gtcGVyZm9ybWFuY2UnLFxuICAgIGNhbnZhczogY2FudmFzLFxuICAgIGFudGlhbGlhczogdHJ1ZSxcbiAgICBhbHBoYTogdHJ1ZSxcbiAgICAuLi5nbFxuICB9KTtcbn07XG5mdW5jdGlvbiBjb21wdXRlSW5pdGlhbFNpemUoY2FudmFzLCBkZWZhdWx0U2l6ZSkge1xuICBjb25zdCBkZWZhdWx0U3R5bGUgPSB0eXBlb2YgSFRNTENhbnZhc0VsZW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGNhbnZhcyBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50O1xuICBpZiAoZGVmYXVsdFNpemUpIHtcbiAgICBjb25zdCB7XG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICAgIHRvcCxcbiAgICAgIGxlZnQsXG4gICAgICB1cGRhdGVTdHlsZSA9IGRlZmF1bHRTdHlsZVxuICAgIH0gPSBkZWZhdWx0U2l6ZTtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHQsXG4gICAgICB0b3AsXG4gICAgICBsZWZ0LFxuICAgICAgdXBkYXRlU3R5bGVcbiAgICB9O1xuICB9IGVsc2UgaWYgKHR5cGVvZiBIVE1MQ2FudmFzRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgY2FudmFzIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQgJiYgY2FudmFzLnBhcmVudEVsZW1lbnQpIHtcbiAgICBjb25zdCB7XG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICAgIHRvcCxcbiAgICAgIGxlZnRcbiAgICB9ID0gY2FudmFzLnBhcmVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoLFxuICAgICAgaGVpZ2h0LFxuICAgICAgdG9wLFxuICAgICAgbGVmdCxcbiAgICAgIHVwZGF0ZVN0eWxlOiBkZWZhdWx0U3R5bGVcbiAgICB9O1xuICB9IGVsc2UgaWYgKHR5cGVvZiBPZmZzY3JlZW5DYW52YXMgIT09ICd1bmRlZmluZWQnICYmIGNhbnZhcyBpbnN0YW5jZW9mIE9mZnNjcmVlbkNhbnZhcykge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogY2FudmFzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBjYW52YXMuaGVpZ2h0LFxuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMCxcbiAgICAgIHVwZGF0ZVN0eWxlOiBkZWZhdWx0U3R5bGVcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgd2lkdGg6IDAsXG4gICAgaGVpZ2h0OiAwLFxuICAgIHRvcDogMCxcbiAgICBsZWZ0OiAwXG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVSb290KGNhbnZhcykge1xuICAvLyBDaGVjayBhZ2FpbnN0IG1pc3Rha2VuIHVzZSBvZiBjcmVhdGVSb290XG4gIGNvbnN0IHByZXZSb290ID0gcm9vdHMuZ2V0KGNhbnZhcyk7XG4gIGNvbnN0IHByZXZGaWJlciA9IHByZXZSb290ID09IG51bGwgPyB2b2lkIDAgOiBwcmV2Um9vdC5maWJlcjtcbiAgY29uc3QgcHJldlN0b3JlID0gcHJldlJvb3QgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZSb290LnN0b3JlO1xuICBpZiAocHJldlJvb3QpIGNvbnNvbGUud2FybignUjNGLmNyZWF0ZVJvb3Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIG9uY2UhJyk7XG5cbiAgLy8gUmVwb3J0IHdoZW4gYW4gZXJyb3Igd2FzIGRldGVjdGVkIGluIGEgcHJldmlvdXMgcmVuZGVyXG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvcmVhY3QtdGhyZWUtZmliZXIvcHVsbC8yMjYxXG4gIGNvbnN0IGxvZ1JlY292ZXJhYmxlRXJyb3IgPSB0eXBlb2YgcmVwb3J0RXJyb3IgPT09ICdmdW5jdGlvbicgP1xuICAvLyBJbiBtb2Rlcm4gYnJvd3NlcnMsIHJlcG9ydEVycm9yIHdpbGwgZGlzcGF0Y2ggYW4gZXJyb3IgZXZlbnQsXG4gIC8vIGVtdWxhdGluZyBhbiB1bmNhdWdodCBKYXZhU2NyaXB0IGVycm9yLlxuICByZXBvcnRFcnJvciA6XG4gIC8vIEluIG9sZGVyIGJyb3dzZXJzIGFuZCB0ZXN0IGVudmlyb25tZW50cywgZmFsbGJhY2sgdG8gY29uc29sZS5lcnJvci5cbiAgY29uc29sZS5lcnJvcjtcblxuICAvLyBDcmVhdGUgc3RvcmVcbiAgY29uc3Qgc3RvcmUgPSBwcmV2U3RvcmUgfHwgY3JlYXRlU3RvcmUoaW52YWxpZGF0ZSwgYWR2YW5jZSk7XG4gIC8vIENyZWF0ZSByZW5kZXJlclxuICBjb25zdCBmaWJlciA9IHByZXZGaWJlciB8fCByZWNvbmNpbGVyLmNyZWF0ZUNvbnRhaW5lcihzdG9yZSwgQ29uY3VycmVudFJvb3QsIG51bGwsIGZhbHNlLCBudWxsLCAnJywgbG9nUmVjb3ZlcmFibGVFcnJvciwgbnVsbCk7XG4gIC8vIE1hcCBpdFxuICBpZiAoIXByZXZSb290KSByb290cy5zZXQoY2FudmFzLCB7XG4gICAgZmliZXIsXG4gICAgc3RvcmVcbiAgfSk7XG5cbiAgLy8gTG9jYWxzXG4gIGxldCBvbkNyZWF0ZWQ7XG4gIGxldCBjb25maWd1cmVkID0gZmFsc2U7XG4gIGxldCBsYXN0Q2FtZXJhO1xuICByZXR1cm4ge1xuICAgIGNvbmZpZ3VyZShwcm9wcyA9IHt9KSB7XG4gICAgICBsZXQge1xuICAgICAgICBnbDogZ2xDb25maWcsXG4gICAgICAgIHNpemU6IHByb3BzU2l6ZSxcbiAgICAgICAgc2NlbmU6IHNjZW5lT3B0aW9ucyxcbiAgICAgICAgZXZlbnRzLFxuICAgICAgICBvbkNyZWF0ZWQ6IG9uQ3JlYXRlZENhbGxiYWNrLFxuICAgICAgICBzaGFkb3dzID0gZmFsc2UsXG4gICAgICAgIGxpbmVhciA9IGZhbHNlLFxuICAgICAgICBmbGF0ID0gZmFsc2UsXG4gICAgICAgIGxlZ2FjeSA9IGZhbHNlLFxuICAgICAgICBvcnRob2dyYXBoaWMgPSBmYWxzZSxcbiAgICAgICAgZnJhbWVsb29wID0gJ2Fsd2F5cycsXG4gICAgICAgIGRwciA9IFsxLCAyXSxcbiAgICAgICAgcGVyZm9ybWFuY2UsXG4gICAgICAgIHJheWNhc3RlcjogcmF5Y2FzdE9wdGlvbnMsXG4gICAgICAgIGNhbWVyYTogY2FtZXJhT3B0aW9ucyxcbiAgICAgICAgb25Qb2ludGVyTWlzc2VkXG4gICAgICB9ID0gcHJvcHM7XG4gICAgICBsZXQgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuXG4gICAgICAvLyBTZXQgdXAgcmVuZGVyZXIgKG9uZSB0aW1lIG9ubHkhKVxuICAgICAgbGV0IGdsID0gc3RhdGUuZ2w7XG4gICAgICBpZiAoIXN0YXRlLmdsKSBzdGF0ZS5zZXQoe1xuICAgICAgICBnbDogZ2wgPSBjcmVhdGVSZW5kZXJlckluc3RhbmNlKGdsQ29uZmlnLCBjYW52YXMpXG4gICAgICB9KTtcblxuICAgICAgLy8gU2V0IHVwIHJheWNhc3RlciAob25lIHRpbWUgb25seSEpXG4gICAgICBsZXQgcmF5Y2FzdGVyID0gc3RhdGUucmF5Y2FzdGVyO1xuICAgICAgaWYgKCFyYXljYXN0ZXIpIHN0YXRlLnNldCh7XG4gICAgICAgIHJheWNhc3RlcjogcmF5Y2FzdGVyID0gbmV3IFRIUkVFLlJheWNhc3RlcigpXG4gICAgICB9KTtcblxuICAgICAgLy8gU2V0IHJheWNhc3RlciBvcHRpb25zXG4gICAgICBjb25zdCB7XG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgfSA9IHJheWNhc3RPcHRpb25zIHx8IHt9O1xuICAgICAgaWYgKCFpcy5lcXUob3B0aW9ucywgcmF5Y2FzdGVyLCBzaGFsbG93TG9vc2UpKSBhcHBseVByb3BzKHJheWNhc3Rlciwge1xuICAgICAgICAuLi5vcHRpb25zXG4gICAgICB9KTtcbiAgICAgIGlmICghaXMuZXF1KHBhcmFtcywgcmF5Y2FzdGVyLnBhcmFtcywgc2hhbGxvd0xvb3NlKSkgYXBwbHlQcm9wcyhyYXljYXN0ZXIsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgLi4ucmF5Y2FzdGVyLnBhcmFtcyxcbiAgICAgICAgICAuLi5wYXJhbXNcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSBkZWZhdWx0IGNhbWVyYSwgZG9uJ3Qgb3ZlcndyaXRlIGFueSB1c2VyLXNldCBzdGF0ZVxuICAgICAgaWYgKCFzdGF0ZS5jYW1lcmEgfHwgc3RhdGUuY2FtZXJhID09PSBsYXN0Q2FtZXJhICYmICFpcy5lcXUobGFzdENhbWVyYSwgY2FtZXJhT3B0aW9ucywgc2hhbGxvd0xvb3NlKSkge1xuICAgICAgICBsYXN0Q2FtZXJhID0gY2FtZXJhT3B0aW9ucztcbiAgICAgICAgY29uc3QgaXNDYW1lcmEgPSBjYW1lcmFPcHRpb25zIGluc3RhbmNlb2YgVEhSRUUuQ2FtZXJhO1xuICAgICAgICBjb25zdCBjYW1lcmEgPSBpc0NhbWVyYSA/IGNhbWVyYU9wdGlvbnMgOiBvcnRob2dyYXBoaWMgPyBuZXcgVEhSRUUuT3J0aG9ncmFwaGljQ2FtZXJhKDAsIDAsIDAsIDAsIDAuMSwgMTAwMCkgOiBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNzUsIDAsIDAuMSwgMTAwMCk7XG4gICAgICAgIGlmICghaXNDYW1lcmEpIHtcbiAgICAgICAgICBjYW1lcmEucG9zaXRpb24ueiA9IDU7XG4gICAgICAgICAgaWYgKGNhbWVyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgIGFwcGx5UHJvcHMoY2FtZXJhLCBjYW1lcmFPcHRpb25zKTtcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIHVzZXItZGVmaW5lZCBmcnVzdHVtIGlmIHBvc3NpYmxlXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcG1uZHJzL3JlYWN0LXRocmVlLWZpYmVyL2lzc3Vlcy8zMTYwXG4gICAgICAgICAgICBpZiAoJ2FzcGVjdCcgaW4gY2FtZXJhT3B0aW9ucyB8fCAnbGVmdCcgaW4gY2FtZXJhT3B0aW9ucyB8fCAncmlnaHQnIGluIGNhbWVyYU9wdGlvbnMgfHwgJ2JvdHRvbScgaW4gY2FtZXJhT3B0aW9ucyB8fCAndG9wJyBpbiBjYW1lcmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgIGNhbWVyYS5tYW51YWwgPSB0cnVlO1xuICAgICAgICAgICAgICBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBBbHdheXMgbG9vayBhdCBjZW50ZXIgYnkgZGVmYXVsdFxuICAgICAgICAgIGlmICghc3RhdGUuY2FtZXJhICYmICEoY2FtZXJhT3B0aW9ucyAhPSBudWxsICYmIGNhbWVyYU9wdGlvbnMucm90YXRpb24pKSBjYW1lcmEubG9va0F0KDAsIDAsIDApO1xuICAgICAgICB9XG4gICAgICAgIHN0YXRlLnNldCh7XG4gICAgICAgICAgY2FtZXJhXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENvbmZpZ3VyZSByYXljYXN0ZXJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BtbmRycy9yZWFjdC14ci9pc3N1ZXMvMzAwXG4gICAgICAgIHJheWNhc3Rlci5jYW1lcmEgPSBjYW1lcmE7XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCB1cCBzY2VuZSAob25lIHRpbWUgb25seSEpXG4gICAgICBpZiAoIXN0YXRlLnNjZW5lKSB7XG4gICAgICAgIGxldCBzY2VuZTtcbiAgICAgICAgaWYgKHNjZW5lT3B0aW9ucyBpbnN0YW5jZW9mIFRIUkVFLlNjZW5lKSB7XG4gICAgICAgICAgc2NlbmUgPSBzY2VuZU9wdGlvbnM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTtcbiAgICAgICAgICBpZiAoc2NlbmVPcHRpb25zKSBhcHBseVByb3BzKHNjZW5lLCBzY2VuZU9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHN0YXRlLnNldCh7XG4gICAgICAgICAgc2NlbmU6IHByZXBhcmUoc2NlbmUpXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXQgdXAgWFIgKG9uZSB0aW1lIG9ubHkhKVxuICAgICAgaWYgKCFzdGF0ZS54cikge1xuICAgICAgICB2YXIgX2dsJHhyO1xuICAgICAgICAvLyBIYW5kbGUgZnJhbWUgYmVoYXZpb3IgaW4gV2ViWFJcbiAgICAgICAgY29uc3QgaGFuZGxlWFJGcmFtZSA9ICh0aW1lc3RhbXAsIGZyYW1lKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICAgIGlmIChzdGF0ZS5mcmFtZWxvb3AgPT09ICduZXZlcicpIHJldHVybjtcbiAgICAgICAgICBhZHZhbmNlKHRpbWVzdGFtcCwgdHJ1ZSwgc3RhdGUsIGZyYW1lKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBUb2dnbGUgcmVuZGVyIHN3aXRjaGluZyBvbiBzZXNzaW9uXG4gICAgICAgIGNvbnN0IGhhbmRsZVNlc3Npb25DaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICAgIHN0YXRlLmdsLnhyLmVuYWJsZWQgPSBzdGF0ZS5nbC54ci5pc1ByZXNlbnRpbmc7XG4gICAgICAgICAgc3RhdGUuZ2wueHIuc2V0QW5pbWF0aW9uTG9vcChzdGF0ZS5nbC54ci5pc1ByZXNlbnRpbmcgPyBoYW5kbGVYUkZyYW1lIDogbnVsbCk7XG4gICAgICAgICAgaWYgKCFzdGF0ZS5nbC54ci5pc1ByZXNlbnRpbmcpIGludmFsaWRhdGUoc3RhdGUpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFdlYlhSIHNlc3Npb24gbWFuYWdlclxuICAgICAgICBjb25zdCB4ciA9IHtcbiAgICAgICAgICBjb25uZWN0KCkge1xuICAgICAgICAgICAgY29uc3QgZ2wgPSBzdG9yZS5nZXRTdGF0ZSgpLmdsO1xuICAgICAgICAgICAgZ2wueHIuYWRkRXZlbnRMaXN0ZW5lcignc2Vzc2lvbnN0YXJ0JywgaGFuZGxlU2Vzc2lvbkNoYW5nZSk7XG4gICAgICAgICAgICBnbC54ci5hZGRFdmVudExpc3RlbmVyKCdzZXNzaW9uZW5kJywgaGFuZGxlU2Vzc2lvbkNoYW5nZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICAgICAgY29uc3QgZ2wgPSBzdG9yZS5nZXRTdGF0ZSgpLmdsO1xuICAgICAgICAgICAgZ2wueHIucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Vzc2lvbnN0YXJ0JywgaGFuZGxlU2Vzc2lvbkNoYW5nZSk7XG4gICAgICAgICAgICBnbC54ci5yZW1vdmVFdmVudExpc3RlbmVyKCdzZXNzaW9uZW5kJywgaGFuZGxlU2Vzc2lvbkNoYW5nZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFN1YnNjcmliZSB0byBXZWJYUiBzZXNzaW9uIGV2ZW50c1xuICAgICAgICBpZiAodHlwZW9mICgoX2dsJHhyID0gZ2wueHIpID09IG51bGwgPyB2b2lkIDAgOiBfZ2wkeHIuYWRkRXZlbnRMaXN0ZW5lcikgPT09ICdmdW5jdGlvbicpIHhyLmNvbm5lY3QoKTtcbiAgICAgICAgc3RhdGUuc2V0KHtcbiAgICAgICAgICB4clxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IHNoYWRvd21hcFxuICAgICAgaWYgKGdsLnNoYWRvd01hcCkge1xuICAgICAgICBjb25zdCBvbGRFbmFibGVkID0gZ2wuc2hhZG93TWFwLmVuYWJsZWQ7XG4gICAgICAgIGNvbnN0IG9sZFR5cGUgPSBnbC5zaGFkb3dNYXAudHlwZTtcbiAgICAgICAgZ2wuc2hhZG93TWFwLmVuYWJsZWQgPSAhIXNoYWRvd3M7XG4gICAgICAgIGlmIChpcy5ib28oc2hhZG93cykpIHtcbiAgICAgICAgICBnbC5zaGFkb3dNYXAudHlwZSA9IFRIUkVFLlBDRlNvZnRTaGFkb3dNYXA7XG4gICAgICAgIH0gZWxzZSBpZiAoaXMuc3RyKHNoYWRvd3MpKSB7XG4gICAgICAgICAgdmFyIF90eXBlcyRzaGFkb3dzO1xuICAgICAgICAgIGNvbnN0IHR5cGVzID0ge1xuICAgICAgICAgICAgYmFzaWM6IFRIUkVFLkJhc2ljU2hhZG93TWFwLFxuICAgICAgICAgICAgcGVyY2VudGFnZTogVEhSRUUuUENGU2hhZG93TWFwLFxuICAgICAgICAgICAgc29mdDogVEhSRUUuUENGU29mdFNoYWRvd01hcCxcbiAgICAgICAgICAgIHZhcmlhbmNlOiBUSFJFRS5WU01TaGFkb3dNYXBcbiAgICAgICAgICB9O1xuICAgICAgICAgIGdsLnNoYWRvd01hcC50eXBlID0gKF90eXBlcyRzaGFkb3dzID0gdHlwZXNbc2hhZG93c10pICE9IG51bGwgPyBfdHlwZXMkc2hhZG93cyA6IFRIUkVFLlBDRlNvZnRTaGFkb3dNYXA7XG4gICAgICAgIH0gZWxzZSBpZiAoaXMub2JqKHNoYWRvd3MpKSB7XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihnbC5zaGFkb3dNYXAsIHNoYWRvd3MpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvbGRFbmFibGVkICE9PSBnbC5zaGFkb3dNYXAuZW5hYmxlZCB8fCBvbGRUeXBlICE9PSBnbC5zaGFkb3dNYXAudHlwZSkgZ2wuc2hhZG93TWFwLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2FmZWx5IHNldCBjb2xvciBtYW5hZ2VtZW50IGlmIGF2YWlsYWJsZS5cbiAgICAgIC8vIEF2b2lkIGFjY2Vzc2luZyBUSFJFRS5Db2xvck1hbmFnZW1lbnQgdG8gcGxheSBuaWNlIHdpdGggb2xkZXIgdmVyc2lvbnNcbiAgICAgIGNvbnN0IENvbG9yTWFuYWdlbWVudCA9IGdldENvbG9yTWFuYWdlbWVudCgpO1xuICAgICAgaWYgKENvbG9yTWFuYWdlbWVudCkge1xuICAgICAgICBpZiAoJ2VuYWJsZWQnIGluIENvbG9yTWFuYWdlbWVudCkgQ29sb3JNYW5hZ2VtZW50LmVuYWJsZWQgPSAhbGVnYWN5O2Vsc2UgaWYgKCdsZWdhY3lNb2RlJyBpbiBDb2xvck1hbmFnZW1lbnQpIENvbG9yTWFuYWdlbWVudC5sZWdhY3lNb2RlID0gbGVnYWN5O1xuICAgICAgfVxuICAgICAgaWYgKCFjb25maWd1cmVkKSB7XG4gICAgICAgIC8vIFNldCBjb2xvciBzcGFjZSBhbmQgdG9uZW1hcHBpbmcgcHJlZmVyZW5jZXMsIG9uY2VcbiAgICAgICAgY29uc3QgTGluZWFyRW5jb2RpbmcgPSAzMDAwO1xuICAgICAgICBjb25zdCBzUkdCRW5jb2RpbmcgPSAzMDAxO1xuICAgICAgICBhcHBseVByb3BzKGdsLCB7XG4gICAgICAgICAgb3V0cHV0RW5jb2Rpbmc6IGxpbmVhciA/IExpbmVhckVuY29kaW5nIDogc1JHQkVuY29kaW5nLFxuICAgICAgICAgIHRvbmVNYXBwaW5nOiBmbGF0ID8gVEhSRUUuTm9Ub25lTWFwcGluZyA6IFRIUkVFLkFDRVNGaWxtaWNUb25lTWFwcGluZ1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gVXBkYXRlIGNvbG9yIG1hbmFnZW1lbnQgc3RhdGVcbiAgICAgIGlmIChzdGF0ZS5sZWdhY3kgIT09IGxlZ2FjeSkgc3RhdGUuc2V0KCgpID0+ICh7XG4gICAgICAgIGxlZ2FjeVxuICAgICAgfSkpO1xuICAgICAgaWYgKHN0YXRlLmxpbmVhciAhPT0gbGluZWFyKSBzdGF0ZS5zZXQoKCkgPT4gKHtcbiAgICAgICAgbGluZWFyXG4gICAgICB9KSk7XG4gICAgICBpZiAoc3RhdGUuZmxhdCAhPT0gZmxhdCkgc3RhdGUuc2V0KCgpID0+ICh7XG4gICAgICAgIGZsYXRcbiAgICAgIH0pKTtcblxuICAgICAgLy8gU2V0IGdsIHByb3BzXG4gICAgICBpZiAoZ2xDb25maWcgJiYgIWlzLmZ1bihnbENvbmZpZykgJiYgIWlzUmVuZGVyZXIoZ2xDb25maWcpICYmICFpcy5lcXUoZ2xDb25maWcsIGdsLCBzaGFsbG93TG9vc2UpKSBhcHBseVByb3BzKGdsLCBnbENvbmZpZyk7XG4gICAgICAvLyBTdG9yZSBldmVudHMgaW50ZXJuYWxseVxuICAgICAgaWYgKGV2ZW50cyAmJiAhc3RhdGUuZXZlbnRzLmhhbmRsZXJzKSBzdGF0ZS5zZXQoe1xuICAgICAgICBldmVudHM6IGV2ZW50cyhzdG9yZSlcbiAgICAgIH0pO1xuICAgICAgLy8gQ2hlY2sgc2l6ZSwgYWxsb3cgaXQgdG8gdGFrZSBvbiBjb250YWluZXIgYm91bmRzIGluaXRpYWxseVxuICAgICAgY29uc3Qgc2l6ZSA9IGNvbXB1dGVJbml0aWFsU2l6ZShjYW52YXMsIHByb3BzU2l6ZSk7XG4gICAgICBpZiAoIWlzLmVxdShzaXplLCBzdGF0ZS5zaXplLCBzaGFsbG93TG9vc2UpKSB7XG4gICAgICAgIHN0YXRlLnNldFNpemUoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQsIHNpemUudXBkYXRlU3R5bGUsIHNpemUudG9wLCBzaXplLmxlZnQpO1xuICAgICAgfVxuICAgICAgLy8gQ2hlY2sgcGl4ZWxyYXRpb1xuICAgICAgaWYgKGRwciAmJiBzdGF0ZS52aWV3cG9ydC5kcHIgIT09IGNhbGN1bGF0ZURwcihkcHIpKSBzdGF0ZS5zZXREcHIoZHByKTtcbiAgICAgIC8vIENoZWNrIGZyYW1lbG9vcFxuICAgICAgaWYgKHN0YXRlLmZyYW1lbG9vcCAhPT0gZnJhbWVsb29wKSBzdGF0ZS5zZXRGcmFtZWxvb3AoZnJhbWVsb29wKTtcbiAgICAgIC8vIENoZWNrIHBvaW50ZXIgbWlzc2VkXG4gICAgICBpZiAoIXN0YXRlLm9uUG9pbnRlck1pc3NlZCkgc3RhdGUuc2V0KHtcbiAgICAgICAgb25Qb2ludGVyTWlzc2VkXG4gICAgICB9KTtcbiAgICAgIC8vIENoZWNrIHBlcmZvcm1hbmNlXG4gICAgICBpZiAocGVyZm9ybWFuY2UgJiYgIWlzLmVxdShwZXJmb3JtYW5jZSwgc3RhdGUucGVyZm9ybWFuY2UsIHNoYWxsb3dMb29zZSkpIHN0YXRlLnNldChzdGF0ZSA9PiAoe1xuICAgICAgICBwZXJmb3JtYW5jZToge1xuICAgICAgICAgIC4uLnN0YXRlLnBlcmZvcm1hbmNlLFxuICAgICAgICAgIC4uLnBlcmZvcm1hbmNlXG4gICAgICAgIH1cbiAgICAgIH0pKTtcblxuICAgICAgLy8gU2V0IGxvY2Fsc1xuICAgICAgb25DcmVhdGVkID0gb25DcmVhdGVkQ2FsbGJhY2s7XG4gICAgICBjb25maWd1cmVkID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgcmVuZGVyKGNoaWxkcmVuKSB7XG4gICAgICAvLyBUaGUgcm9vdCBoYXMgdG8gYmUgY29uZmlndXJlZCBiZWZvcmUgaXQgY2FuIGJlIHJlbmRlcmVkXG4gICAgICBpZiAoIWNvbmZpZ3VyZWQpIHRoaXMuY29uZmlndXJlKCk7XG4gICAgICByZWNvbmNpbGVyLnVwZGF0ZUNvbnRhaW5lciggLyojX19QVVJFX18qL2pzeChQcm92aWRlciwge1xuICAgICAgICBzdG9yZTogc3RvcmUsXG4gICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlbixcbiAgICAgICAgb25DcmVhdGVkOiBvbkNyZWF0ZWQsXG4gICAgICAgIHJvb3RFbGVtZW50OiBjYW52YXNcbiAgICAgIH0pLCBmaWJlciwgbnVsbCwgKCkgPT4gdW5kZWZpbmVkKTtcbiAgICAgIHJldHVybiBzdG9yZTtcbiAgICB9LFxuICAgIHVubW91bnQoKSB7XG4gICAgICB1bm1vdW50Q29tcG9uZW50QXROb2RlKGNhbnZhcyk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gcmVuZGVyKGNoaWxkcmVuLCBjYW52YXMsIGNvbmZpZykge1xuICBjb25zb2xlLndhcm4oJ1IzRi5yZW5kZXIgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBpbiBSZWFjdCAxOC4gVXNlIGNyZWF0ZVJvb3QgaW5zdGVhZCEnKTtcbiAgY29uc3Qgcm9vdCA9IGNyZWF0ZVJvb3QoY2FudmFzKTtcbiAgcm9vdC5jb25maWd1cmUoY29uZmlnKTtcbiAgcmV0dXJuIHJvb3QucmVuZGVyKGNoaWxkcmVuKTtcbn1cbmZ1bmN0aW9uIFByb3ZpZGVyKHtcbiAgc3RvcmUsXG4gIGNoaWxkcmVuLFxuICBvbkNyZWF0ZWQsXG4gIHJvb3RFbGVtZW50XG59KSB7XG4gIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHN0YXRlID0gc3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAvLyBGbGFnIHRoZSBjYW52YXMgYWN0aXZlLCByZW5kZXJpbmcgd2lsbCBub3cgYmVnaW5cbiAgICBzdGF0ZS5zZXQoc3RhdGUgPT4gKHtcbiAgICAgIGludGVybmFsOiB7XG4gICAgICAgIC4uLnN0YXRlLmludGVybmFsLFxuICAgICAgICBhY3RpdmU6IHRydWVcbiAgICAgIH1cbiAgICB9KSk7XG4gICAgLy8gTm90aWZpeSB0aGF0IGluaXQgaXMgY29tcGxldGVkLCB0aGUgc2NlbmUgZ3JhcGggZXhpc3RzLCBidXQgbm90aGluZyBoYXMgeWV0IHJlbmRlcmVkXG4gICAgaWYgKG9uQ3JlYXRlZCkgb25DcmVhdGVkKHN0YXRlKTtcbiAgICAvLyBDb25uZWN0IGV2ZW50cyB0byB0aGUgdGFyZ2V0cyBwYXJlbnQsIHRoaXMgaXMgZG9uZSB0byBlbnN1cmUgZXZlbnRzIGFyZSByZWdpc3RlcmVkIG9uXG4gICAgLy8gYSBzaGFyZWQgdGFyZ2V0LCBhbmQgbm90IG9uIHRoZSBjYW52YXMgaXRzZWxmXG4gICAgaWYgKCFzdG9yZS5nZXRTdGF0ZSgpLmV2ZW50cy5jb25uZWN0ZWQpIHN0YXRlLmV2ZW50cy5jb25uZWN0ID09IG51bGwgPyB2b2lkIDAgOiBzdGF0ZS5ldmVudHMuY29ubmVjdChyb290RWxlbWVudCk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbXSk7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovanN4KGNvbnRleHQuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZTogc3RvcmUsXG4gICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gIH0pO1xufVxuZnVuY3Rpb24gdW5tb3VudENvbXBvbmVudEF0Tm9kZShjYW52YXMsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IHJvb3QgPSByb290cy5nZXQoY2FudmFzKTtcbiAgY29uc3QgZmliZXIgPSByb290ID09IG51bGwgPyB2b2lkIDAgOiByb290LmZpYmVyO1xuICBpZiAoZmliZXIpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHJvb3QgPT0gbnVsbCA/IHZvaWQgMCA6IHJvb3Quc3RvcmUuZ2V0U3RhdGUoKTtcbiAgICBpZiAoc3RhdGUpIHN0YXRlLmludGVybmFsLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHJlY29uY2lsZXIudXBkYXRlQ29udGFpbmVyKG51bGwsIGZpYmVyLCBudWxsLCAoKSA9PiB7XG4gICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBfc3RhdGUkZ2wsIF9zdGF0ZSRnbCRyZW5kZXJMaXN0cywgX3N0YXRlJGdsMiwgX3N0YXRlJGdsMztcbiAgICAgICAgICAgIHN0YXRlLmV2ZW50cy5kaXNjb25uZWN0ID09IG51bGwgPyB2b2lkIDAgOiBzdGF0ZS5ldmVudHMuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgKF9zdGF0ZSRnbCA9IHN0YXRlLmdsKSA9PSBudWxsID8gdm9pZCAwIDogKF9zdGF0ZSRnbCRyZW5kZXJMaXN0cyA9IF9zdGF0ZSRnbC5yZW5kZXJMaXN0cykgPT0gbnVsbCA/IHZvaWQgMCA6IF9zdGF0ZSRnbCRyZW5kZXJMaXN0cy5kaXNwb3NlID09IG51bGwgPyB2b2lkIDAgOiBfc3RhdGUkZ2wkcmVuZGVyTGlzdHMuZGlzcG9zZSgpO1xuICAgICAgICAgICAgKF9zdGF0ZSRnbDIgPSBzdGF0ZS5nbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9zdGF0ZSRnbDIuZm9yY2VDb250ZXh0TG9zcyA9PSBudWxsID8gdm9pZCAwIDogX3N0YXRlJGdsMi5mb3JjZUNvbnRleHRMb3NzKCk7XG4gICAgICAgICAgICBpZiAoKF9zdGF0ZSRnbDMgPSBzdGF0ZS5nbCkgIT0gbnVsbCAmJiBfc3RhdGUkZ2wzLnhyKSBzdGF0ZS54ci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICBkaXNwb3NlKHN0YXRlKTtcbiAgICAgICAgICAgIHJvb3RzLmRlbGV0ZShjYW52YXMpO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayhjYW52YXMpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8qIC4uLiAqL1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgNTAwKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuZnVuY3Rpb24gY3JlYXRlUG9ydGFsKGNoaWxkcmVuLCBjb250YWluZXIsIHN0YXRlKSB7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovanN4KFBvcnRhbCwge1xuICAgIGNoaWxkcmVuOiBjaGlsZHJlbixcbiAgICBjb250YWluZXI6IGNvbnRhaW5lcixcbiAgICBzdGF0ZTogc3RhdGVcbiAgfSwgY29udGFpbmVyLnV1aWQpO1xufVxuZnVuY3Rpb24gUG9ydGFsKHtcbiAgc3RhdGUgPSB7fSxcbiAgY2hpbGRyZW4sXG4gIGNvbnRhaW5lclxufSkge1xuICAvKiogVGhpcyBoYXMgdG8gYmUgYSBjb21wb25lbnQgYmVjYXVzZSBpdCB3b3VsZCBub3QgYmUgYWJsZSB0byBjYWxsIHVzZVRocmVlL3VzZVN0b3JlIG90aGVyd2lzZSBzaW5jZVxyXG4gICAqICBpZiB0aGlzIGlzIG91ciBlbnZpcm9ubWVudCwgdGhlbiB3ZSBhcmUgbm90IGluIHIzZidzIHJlbmRlcmVyIGJ1dCBpbiByZWFjdC1kb20sIGl0IHdvdWxkIHRyaWdnZXJcclxuICAgKiAgdGhlIFwiUjNGIGhvb2tzIGNhbiBvbmx5IGJlIHVzZWQgd2l0aGluIHRoZSBDYW52YXMgY29tcG9uZW50IVwiIHdhcm5pbmc6XHJcbiAgICogIDxDYW52YXM+XHJcbiAgICogICAge2NyZWF0ZVBvcnRhbCguLi4pfSAqL1xuICBjb25zdCB7XG4gICAgZXZlbnRzLFxuICAgIHNpemUsXG4gICAgLi4ucmVzdFxuICB9ID0gc3RhdGU7XG4gIGNvbnN0IHByZXZpb3VzUm9vdCA9IHVzZVN0b3JlKCk7XG4gIGNvbnN0IFtyYXljYXN0ZXJdID0gUmVhY3QudXNlU3RhdGUoKCkgPT4gbmV3IFRIUkVFLlJheWNhc3RlcigpKTtcbiAgY29uc3QgW3BvaW50ZXJdID0gUmVhY3QudXNlU3RhdGUoKCkgPT4gbmV3IFRIUkVFLlZlY3RvcjIoKSk7XG4gIGNvbnN0IGluamVjdCA9IFJlYWN0LnVzZUNhbGxiYWNrKChyb290U3RhdGUsIGluamVjdFN0YXRlKSA9PiB7XG4gICAgY29uc3QgaW50ZXJzZWN0ID0ge1xuICAgICAgLi4ucm9vdFN0YXRlXG4gICAgfTsgLy8gYWxsIHByZXYgc3RhdGUgcHJvcHNcblxuICAgIC8vIE9ubHkgdGhlIGZpZWxkcyBvZiBcInJvb3RTdGF0ZVwiIHRoYXQgZG8gbm90IGRpZmZlciBmcm9tIGluamVjdFN0YXRlXG4gICAgLy8gU29tZSBwcm9wcyBzaG91bGQgYmUgb2ZmLWxpbWl0c1xuICAgIC8vIE90aGVyd2lzZSBmaWx0ZXIgb3V0IHRoZSBwcm9wcyB0aGF0IGFyZSBkaWZmZXJlbnQgYW5kIGxldCB0aGUgaW5qZWN0IGxheWVyIHRha2UgcHJlY2VkZW5jZVxuICAgIE9iamVjdC5rZXlzKHJvb3RTdGF0ZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgLy8gU29tZSBwcm9wcyBzaG91bGQgYmUgb2ZmLWxpbWl0c1xuICAgICAgcHJpdmF0ZUtleXMuaW5jbHVkZXMoa2V5KSB8fFxuICAgICAgLy8gT3RoZXJ3aXNlIGZpbHRlciBvdXQgdGhlIHByb3BzIHRoYXQgYXJlIGRpZmZlcmVudCBhbmQgbGV0IHRoZSBpbmplY3QgbGF5ZXIgdGFrZSBwcmVjZWRlbmNlXG4gICAgICAvLyBVbmxlc3MgdGhlIGluamVjdCBsYXllciBwcm9wcyBpcyB1bmRlZmluZWQsIHRoZW4gd2Uga2VlcCB0aGUgcm9vdCBsYXllclxuICAgICAgcm9vdFN0YXRlW2tleV0gIT09IGluamVjdFN0YXRlW2tleV0gJiYgaW5qZWN0U3RhdGVba2V5XSkge1xuICAgICAgICBkZWxldGUgaW50ZXJzZWN0W2tleV07XG4gICAgICB9XG4gICAgfSk7XG4gICAgbGV0IHZpZXdwb3J0ID0gdW5kZWZpbmVkO1xuICAgIGlmIChpbmplY3RTdGF0ZSAmJiBzaXplKSB7XG4gICAgICBjb25zdCBjYW1lcmEgPSBpbmplY3RTdGF0ZS5jYW1lcmE7XG4gICAgICAvLyBDYWxjdWxhdGUgdGhlIG92ZXJyaWRlIHZpZXdwb3J0LCBpZiBwcmVzZW50XG4gICAgICB2aWV3cG9ydCA9IHJvb3RTdGF0ZS52aWV3cG9ydC5nZXRDdXJyZW50Vmlld3BvcnQoY2FtZXJhLCBuZXcgVEhSRUUuVmVjdG9yMygpLCBzaXplKTtcbiAgICAgIC8vIFVwZGF0ZSB0aGUgcG9ydGFsIGNhbWVyYSwgaWYgaXQgZGlmZmVycyBmcm9tIHRoZSBwcmV2aW91cyBsYXllclxuICAgICAgaWYgKGNhbWVyYSAhPT0gcm9vdFN0YXRlLmNhbWVyYSkgdXBkYXRlQ2FtZXJhKGNhbWVyYSwgc2l6ZSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAvLyBUaGUgaW50ZXJzZWN0IGNvbnNpc3RzIG9mIHRoZSBwcmV2aW91cyByb290IHN0YXRlXG4gICAgICAuLi5pbnRlcnNlY3QsXG4gICAgICAvLyBQb3J0YWxzIGhhdmUgdGhlaXIgb3duIHNjZW5lLCB3aGljaCBmb3JtcyB0aGUgcm9vdCwgYSByYXljYXN0ZXIgYW5kIGEgcG9pbnRlclxuICAgICAgc2NlbmU6IGNvbnRhaW5lcixcbiAgICAgIHJheWNhc3RlcixcbiAgICAgIHBvaW50ZXIsXG4gICAgICBtb3VzZTogcG9pbnRlcixcbiAgICAgIC8vIFRoZWlyIHByZXZpb3VzIHJvb3QgaXMgdGhlIGxheWVyIGJlZm9yZSBpdFxuICAgICAgcHJldmlvdXNSb290LFxuICAgICAgLy8gRXZlbnRzLCBzaXplIGFuZCB2aWV3cG9ydCBjYW4gYmUgb3ZlcnJpZGRlbiBieSB0aGUgaW5qZWN0IGxheWVyXG4gICAgICBldmVudHM6IHtcbiAgICAgICAgLi4ucm9vdFN0YXRlLmV2ZW50cyxcbiAgICAgICAgLi4uKGluamVjdFN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBpbmplY3RTdGF0ZS5ldmVudHMpLFxuICAgICAgICAuLi5ldmVudHNcbiAgICAgIH0sXG4gICAgICBzaXplOiB7XG4gICAgICAgIC4uLnJvb3RTdGF0ZS5zaXplLFxuICAgICAgICAuLi5zaXplXG4gICAgICB9LFxuICAgICAgdmlld3BvcnQ6IHtcbiAgICAgICAgLi4ucm9vdFN0YXRlLnZpZXdwb3J0LFxuICAgICAgICAuLi52aWV3cG9ydFxuICAgICAgfSxcbiAgICAgIC4uLnJlc3RcbiAgICB9O1xuICB9LFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIFtzdGF0ZV0pO1xuICBjb25zdCBbdXNlUG9ydGFsU3RvcmVdID0gUmVhY3QudXNlU3RhdGUoKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBhIG1pcnJvcmVkIHN0b3JlLCBiYXNlZCBvbiB0aGUgcHJldmlvdXMgcm9vdCB3aXRoIGEgZmV3IG92ZXJyaWRlcyAuLi5cbiAgICBjb25zdCBwcmV2aW91c1N0YXRlID0gcHJldmlvdXNSb290LmdldFN0YXRlKCk7XG4gICAgY29uc3Qgc3RvcmUgPSBjcmVhdGUoKHNldCwgZ2V0KSA9PiAoe1xuICAgICAgLi4ucHJldmlvdXNTdGF0ZSxcbiAgICAgIHNjZW5lOiBjb250YWluZXIsXG4gICAgICByYXljYXN0ZXIsXG4gICAgICBwb2ludGVyLFxuICAgICAgbW91c2U6IHBvaW50ZXIsXG4gICAgICBwcmV2aW91c1Jvb3QsXG4gICAgICBldmVudHM6IHtcbiAgICAgICAgLi4ucHJldmlvdXNTdGF0ZS5ldmVudHMsXG4gICAgICAgIC4uLmV2ZW50c1xuICAgICAgfSxcbiAgICAgIHNpemU6IHtcbiAgICAgICAgLi4ucHJldmlvdXNTdGF0ZS5zaXplLFxuICAgICAgICAuLi5zaXplXG4gICAgICB9LFxuICAgICAgLi4ucmVzdCxcbiAgICAgIC8vIFNldCBhbmQgZ2V0IHJlZmVyIHRvIHRoaXMgcm9vdC1zdGF0ZVxuICAgICAgc2V0LFxuICAgICAgZ2V0LFxuICAgICAgLy8gTGF5ZXJzIGFyZSBhbGxvd2VkIHRvIG92ZXJyaWRlIGV2ZW50c1xuICAgICAgc2V0RXZlbnRzOiBldmVudHMgPT4gc2V0KHN0YXRlID0+ICh7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5ldmVudHMsXG4gICAgICAgICAgLi4uZXZlbnRzXG4gICAgICAgIH1cbiAgICAgIH0pKVxuICAgIH0pKTtcbiAgICByZXR1cm4gc3RvcmU7XG4gIH0pO1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFN1YnNjcmliZSB0byBwcmV2aW91cyByb290LXN0YXRlIGFuZCBjb3B5IGNoYW5nZXMgb3ZlciB0byB0aGUgbWlycm9yZWQgcG9ydGFsLXN0YXRlXG4gICAgY29uc3QgdW5zdWIgPSBwcmV2aW91c1Jvb3Quc3Vic2NyaWJlKHByZXYgPT4gdXNlUG9ydGFsU3RvcmUuc2V0U3RhdGUoc3RhdGUgPT4gaW5qZWN0KHByZXYsIHN0YXRlKSkpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB1bnN1YigpO1xuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbaW5qZWN0XSk7XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgdXNlUG9ydGFsU3RvcmUuc2V0U3RhdGUoaW5qZWN0U3RhdGUgPT4gaW5qZWN0KHByZXZpb3VzUm9vdC5nZXRTdGF0ZSgpLCBpbmplY3RTdGF0ZSkpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgfSwgW2luamVjdF0pO1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB1c2VQb3J0YWxTdG9yZS5kZXN0cm95KCk7XG4gICAgfTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtdKTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goRnJhZ21lbnQsIHtcbiAgICBjaGlsZHJlbjogcmVjb25jaWxlci5jcmVhdGVQb3J0YWwoIC8qI19fUFVSRV9fKi9qc3goY29udGV4dC5Qcm92aWRlciwge1xuICAgICAgdmFsdWU6IHVzZVBvcnRhbFN0b3JlLFxuICAgICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gICAgfSksIHVzZVBvcnRhbFN0b3JlLCBudWxsKVxuICB9KTtcbn1cbnJlY29uY2lsZXIuaW5qZWN0SW50b0RldlRvb2xzKHtcbiAgYnVuZGxlVHlwZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/IDAgOiAxLFxuICByZW5kZXJlclBhY2thZ2VOYW1lOiAnQHJlYWN0LXRocmVlL2ZpYmVyJyxcbiAgdmVyc2lvbjogUmVhY3QudmVyc2lvblxufSk7XG5jb25zdCBhY3QgPSBSZWFjdC51bnN0YWJsZV9hY3Q7XG5cbmV4cG9ydCB7IHVzZVRocmVlIGFzIEEsIEJsb2NrIGFzIEIsIHVzZUZyYW1lIGFzIEMsIHVzZUdyYXBoIGFzIEQsIEVycm9yQm91bmRhcnkgYXMgRSwgdXNlTG9hZGVyIGFzIEYsIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QgYXMgYSwgY3JlYXRlUm9vdCBhcyBiLCBjcmVhdGVFdmVudHMgYXMgYywgdW5tb3VudENvbXBvbmVudEF0Tm9kZSBhcyBkLCBleHRlbmQgYXMgZSwgY29udGV4dCBhcyBmLCBjcmVhdGVQb3J0YWwgYXMgZywgcmVjb25jaWxlciBhcyBoLCBpc1JlZiBhcyBpLCBhcHBseVByb3BzIGFzIGosIGRpc3Bvc2UgYXMgaywgaW52YWxpZGF0ZSBhcyBsLCBhZHZhbmNlIGFzIG0sIGFkZEVmZmVjdCBhcyBuLCBhZGRBZnRlckVmZmVjdCBhcyBvLCBhZGRUYWlsIGFzIHAsIGZsdXNoR2xvYmFsRWZmZWN0cyBhcyBxLCByZW5kZXIgYXMgciwgZ2V0Um9vdFN0YXRlIGFzIHMsIHRocmVlVHlwZXMgYXMgdCwgdXNlTXV0YWJsZUNhbGxiYWNrIGFzIHUsIGFjdCBhcyB2LCBidWlsZEdyYXBoIGFzIHcsIHJvb3RzIGFzIHgsIHVzZUluc3RhbmNlSGFuZGxlIGFzIHksIHVzZVN0b3JlIGFzIHogfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/fiber/dist/react-three-fiber.esm.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@react-three/fiber/dist/react-three-fiber.esm.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Canvas: () => (/* binding */ Canvas),\n/* harmony export */   ReactThreeFiber: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.t),\n/* harmony export */   _roots: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.x),\n/* harmony export */   act: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.v),\n/* harmony export */   addAfterEffect: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.o),\n/* harmony export */   addEffect: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.n),\n/* harmony export */   addTail: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.p),\n/* harmony export */   advance: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.m),\n/* harmony export */   applyProps: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.j),\n/* harmony export */   buildGraph: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.w),\n/* harmony export */   context: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.f),\n/* harmony export */   createEvents: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.c),\n/* harmony export */   createPortal: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.g),\n/* harmony export */   createRoot: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.b),\n/* harmony export */   dispose: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.k),\n/* harmony export */   events: () => (/* binding */ createPointerEvents),\n/* harmony export */   extend: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.e),\n/* harmony export */   flushGlobalEffects: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.q),\n/* harmony export */   getRootState: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.s),\n/* harmony export */   invalidate: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.l),\n/* harmony export */   reconciler: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.h),\n/* harmony export */   render: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.r),\n/* harmony export */   unmountComponentAtNode: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.d),\n/* harmony export */   useFrame: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.C),\n/* harmony export */   useGraph: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.D),\n/* harmony export */   useInstanceHandle: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.y),\n/* harmony export */   useLoader: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.F),\n/* harmony export */   useStore: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.z),\n/* harmony export */   useThree: () => (/* reexport safe */ _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.A)\n/* harmony export */ });\n/* harmony import */ var _index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-ba8afaa4.esm.js */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-ba8afaa4.esm.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var react_use_measure__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-use-measure */ \"(ssr)/./node_modules/react-use-measure/dist/index.js\");\n/* harmony import */ var its_fine__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! its-fine */ \"(ssr)/./node_modules/its-fine/dist/index.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react_reconciler_constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-reconciler/constants */ \"(ssr)/./node_modules/react-reconciler/constants.js\");\n/* harmony import */ var react_reconciler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-reconciler */ \"(ssr)/./node_modules/react-reconciler/index.js\");\n/* harmony import */ var react_reconciler__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_reconciler__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var scheduler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! scheduler */ \"(ssr)/./node_modules/scheduler/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst DOM_EVENTS = {\n  onClick: ['click', false],\n  onContextMenu: ['contextmenu', false],\n  onDoubleClick: ['dblclick', false],\n  onWheel: ['wheel', true],\n  onPointerDown: ['pointerdown', true],\n  onPointerUp: ['pointerup', true],\n  onPointerLeave: ['pointerleave', true],\n  onPointerMove: ['pointermove', true],\n  onPointerCancel: ['pointercancel', true],\n  onLostPointerCapture: ['lostpointercapture', true]\n};\n\n/** Default R3F event manager for web */\nfunction createPointerEvents(store) {\n  const {\n    handlePointer\n  } = (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.c)(store);\n  return {\n    priority: 1,\n    enabled: true,\n    compute(event, state, previous) {\n      // https://github.com/pmndrs/react-three-fiber/pull/782\n      // Events trigger outside of canvas when moved, use offsetX/Y by default and allow overrides\n      state.pointer.set(event.offsetX / state.size.width * 2 - 1, -(event.offsetY / state.size.height) * 2 + 1);\n      state.raycaster.setFromCamera(state.pointer, state.camera);\n    },\n    connected: undefined,\n    handlers: Object.keys(DOM_EVENTS).reduce((acc, key) => ({\n      ...acc,\n      [key]: handlePointer(key)\n    }), {}),\n    update: () => {\n      var _internal$lastEvent;\n      const {\n        events,\n        internal\n      } = store.getState();\n      if ((_internal$lastEvent = internal.lastEvent) != null && _internal$lastEvent.current && events.handlers) events.handlers.onPointerMove(internal.lastEvent.current);\n    },\n    connect: target => {\n      var _events$handlers;\n      const {\n        set,\n        events\n      } = store.getState();\n      events.disconnect == null ? void 0 : events.disconnect();\n      set(state => ({\n        events: {\n          ...state.events,\n          connected: target\n        }\n      }));\n      Object.entries((_events$handlers = events.handlers) != null ? _events$handlers : []).forEach(([name, event]) => {\n        const [eventName, passive] = DOM_EVENTS[name];\n        target.addEventListener(eventName, event, {\n          passive\n        });\n      });\n    },\n    disconnect: () => {\n      const {\n        set,\n        events\n      } = store.getState();\n      if (events.connected) {\n        var _events$handlers2;\n        Object.entries((_events$handlers2 = events.handlers) != null ? _events$handlers2 : []).forEach(([name, event]) => {\n          if (events && events.connected instanceof HTMLElement) {\n            const [eventName] = DOM_EVENTS[name];\n            events.connected.removeEventListener(eventName, event);\n          }\n        });\n        set(state => ({\n          events: {\n            ...state.events,\n            connected: undefined\n          }\n        }));\n      }\n    }\n  };\n}\n\nconst CanvasImpl = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(function Canvas({\n  children,\n  fallback,\n  resize,\n  style,\n  gl,\n  events = createPointerEvents,\n  eventSource,\n  eventPrefix,\n  shadows,\n  linear,\n  flat,\n  legacy,\n  orthographic,\n  frameloop,\n  dpr,\n  performance,\n  raycaster,\n  camera,\n  scene,\n  onPointerMissed,\n  onCreated,\n  ...props\n}, forwardedRef) {\n  // Create a known catalogue of Threejs-native elements\n  // This will include the entire THREE namespace by default, users can extend\n  // their own elements by using the createRoot API instead\n  react__WEBPACK_IMPORTED_MODULE_1__.useMemo(() => (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.e)(three__WEBPACK_IMPORTED_MODULE_6__), []);\n  const Bridge = (0,its_fine__WEBPACK_IMPORTED_MODULE_7__.useContextBridge)();\n  const [containerRef, containerRect] = (0,react_use_measure__WEBPACK_IMPORTED_MODULE_8__[\"default\"])({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    },\n    ...resize\n  });\n  const canvasRef = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n  const divRef = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n  react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle(forwardedRef, () => canvasRef.current);\n  const handlePointerMissed = (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.u)(onPointerMissed);\n  const [block, setBlock] = react__WEBPACK_IMPORTED_MODULE_1__.useState(false);\n  const [error, setError] = react__WEBPACK_IMPORTED_MODULE_1__.useState(false);\n\n  // Suspend this component if block is a promise (2nd run)\n  if (block) throw block;\n  // Throw exception outwards if anything within canvas throws\n  if (error) throw error;\n  const root = react__WEBPACK_IMPORTED_MODULE_1__.useRef(null);\n  (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.a)(() => {\n    const canvas = canvasRef.current;\n    if (containerRect.width > 0 && containerRect.height > 0 && canvas) {\n      if (!root.current) root.current = (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.b)(canvas);\n      root.current.configure({\n        gl,\n        events,\n        shadows,\n        linear,\n        flat,\n        legacy,\n        orthographic,\n        frameloop,\n        dpr,\n        performance,\n        raycaster,\n        camera,\n        scene,\n        size: containerRect,\n        // Pass mutable reference to onPointerMissed so it's free to update\n        onPointerMissed: (...args) => handlePointerMissed.current == null ? void 0 : handlePointerMissed.current(...args),\n        onCreated: state => {\n          // Connect to event source\n          state.events.connect == null ? void 0 : state.events.connect(eventSource ? (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.i)(eventSource) ? eventSource.current : eventSource : divRef.current);\n          // Set up compute function\n          if (eventPrefix) {\n            state.setEvents({\n              compute: (event, state) => {\n                const x = event[eventPrefix + 'X'];\n                const y = event[eventPrefix + 'Y'];\n                state.pointer.set(x / state.size.width * 2 - 1, -(y / state.size.height) * 2 + 1);\n                state.raycaster.setFromCamera(state.pointer, state.camera);\n              }\n            });\n          }\n          // Call onCreated callback\n          onCreated == null ? void 0 : onCreated(state);\n        }\n      });\n      root.current.render( /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(Bridge, {\n        children: /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.E, {\n          set: setError,\n          children: /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Suspense, {\n            fallback: /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.B, {\n              set: setBlock\n            }),\n            children: children\n          })\n        })\n      }));\n    }\n  });\n  react__WEBPACK_IMPORTED_MODULE_1__.useEffect(() => {\n    const canvas = canvasRef.current;\n    if (canvas) return () => (0,_index_ba8afaa4_esm_js__WEBPACK_IMPORTED_MODULE_0__.d)(canvas);\n  }, []);\n\n  // When the event source is not this div, we need to set pointer-events to none\n  // Or else the canvas will block events from reaching the event source\n  const pointerEvents = eventSource ? 'none' : 'auto';\n  return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", {\n    ref: divRef,\n    style: {\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n      pointerEvents,\n      ...style\n    },\n    ...props,\n    children: /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", {\n      ref: containerRef,\n      style: {\n        width: '100%',\n        height: '100%'\n      },\n      children: /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          display: 'block'\n        },\n        children: fallback\n      })\n    })\n  });\n});\n\n/**\r\n * A DOM canvas which accepts threejs elements as children.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/canvas\r\n */\nconst Canvas = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(function CanvasWrapper(props, ref) {\n  return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(its_fine__WEBPACK_IMPORTED_MODULE_7__.FiberProvider, {\n    children: /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(CanvasImpl, {\n      ...props,\n      ref: ref\n    })\n  });\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2ZpYmVyL2Rpc3QvcmVhY3QtdGhyZWUtZmliZXIuZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTROO0FBQ3lSO0FBQ3RkO0FBQ0E7QUFDWTtBQUNnQjtBQUNuQjtBQUNKO0FBQ25CO0FBQ1M7QUFDUDtBQUNJOztBQUV2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLEVBQUUseURBQVk7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssS0FBSztBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGdDQUFnQyw2Q0FBZ0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsRUFBRSwwQ0FBYSxPQUFPLHlEQUFNLENBQUMsa0NBQUs7QUFDbEMsaUJBQWlCLDBEQUFnQjtBQUNqQyx3Q0FBd0MsNkRBQVU7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsb0JBQW9CLHlDQUFZO0FBQ2hDLGlCQUFpQix5Q0FBWTtBQUM3QixFQUFFLHNEQUF5QjtBQUMzQiw4QkFBOEIseURBQWtCO0FBQ2hELDRCQUE0QiwyQ0FBYztBQUMxQyw0QkFBNEIsMkNBQWM7O0FBRTFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5Q0FBWTtBQUMzQixFQUFFLHlEQUF5QjtBQUMzQjtBQUNBO0FBQ0Esd0NBQXdDLHlEQUFVO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUZBQXFGLHlEQUFLO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCx3Q0FBd0Msc0RBQUc7QUFDM0MsK0JBQStCLHNEQUFHLENBQUMscURBQWE7QUFDaEQ7QUFDQSxpQ0FBaUMsc0RBQUcsQ0FBQywyQ0FBYztBQUNuRCxtQ0FBbUMsc0RBQUcsQ0FBQyxxREFBSztBQUM1QztBQUNBLGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNILEVBQUUsNENBQWU7QUFDakI7QUFDQSw2QkFBNkIseURBQXNCO0FBQ25ELEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHNEQUFHO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwyQkFBMkIsc0RBQUc7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsNkJBQTZCLHNEQUFHO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNkNBQWdCO0FBQzVDLHNCQUFzQixzREFBRyxDQUFDLG1EQUFhO0FBQ3ZDLDJCQUEyQixzREFBRztBQUM5QjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCxDQUFDOztBQUVnRCIsInNvdXJjZXMiOlsid2VicGFjazovL3Nhbmp5b3RpLWxlYXJuaW5nLy4vbm9kZV9tb2R1bGVzL0ByZWFjdC10aHJlZS9maWJlci9kaXN0L3JlYWN0LXRocmVlLWZpYmVyLmVzbS5qcz81NjIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGMgYXMgY3JlYXRlRXZlbnRzLCBlIGFzIGV4dGVuZCwgdSBhcyB1c2VNdXRhYmxlQ2FsbGJhY2ssIGEgYXMgdXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdCwgYiBhcyBjcmVhdGVSb290LCBpIGFzIGlzUmVmLCBFIGFzIEVycm9yQm91bmRhcnksIEIgYXMgQmxvY2ssIGQgYXMgdW5tb3VudENvbXBvbmVudEF0Tm9kZSB9IGZyb20gJy4vaW5kZXgtYmE4YWZhYTQuZXNtLmpzJztcbmV4cG9ydCB7IHQgYXMgUmVhY3RUaHJlZUZpYmVyLCB4IGFzIF9yb290cywgdiBhcyBhY3QsIG8gYXMgYWRkQWZ0ZXJFZmZlY3QsIG4gYXMgYWRkRWZmZWN0LCBwIGFzIGFkZFRhaWwsIG0gYXMgYWR2YW5jZSwgaiBhcyBhcHBseVByb3BzLCB3IGFzIGJ1aWxkR3JhcGgsIGYgYXMgY29udGV4dCwgYyBhcyBjcmVhdGVFdmVudHMsIGcgYXMgY3JlYXRlUG9ydGFsLCBiIGFzIGNyZWF0ZVJvb3QsIGsgYXMgZGlzcG9zZSwgZSBhcyBleHRlbmQsIHEgYXMgZmx1c2hHbG9iYWxFZmZlY3RzLCBzIGFzIGdldFJvb3RTdGF0ZSwgbCBhcyBpbnZhbGlkYXRlLCBoIGFzIHJlY29uY2lsZXIsIHIgYXMgcmVuZGVyLCBkIGFzIHVubW91bnRDb21wb25lbnRBdE5vZGUsIEMgYXMgdXNlRnJhbWUsIEQgYXMgdXNlR3JhcGgsIHkgYXMgdXNlSW5zdGFuY2VIYW5kbGUsIEYgYXMgdXNlTG9hZGVyLCB6IGFzIHVzZVN0b3JlLCBBIGFzIHVzZVRocmVlIH0gZnJvbSAnLi9pbmRleC1iYThhZmFhNC5lc20uanMnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuaW1wb3J0IHVzZU1lYXN1cmUgZnJvbSAncmVhY3QtdXNlLW1lYXN1cmUnO1xuaW1wb3J0IHsgRmliZXJQcm92aWRlciwgdXNlQ29udGV4dEJyaWRnZSB9IGZyb20gJ2l0cy1maW5lJztcbmltcG9ydCB7IGpzeCB9IGZyb20gJ3JlYWN0L2pzeC1ydW50aW1lJztcbmltcG9ydCAncmVhY3QtcmVjb25jaWxlci9jb25zdGFudHMnO1xuaW1wb3J0ICd6dXN0YW5kJztcbmltcG9ydCAncmVhY3QtcmVjb25jaWxlcic7XG5pbXBvcnQgJ3NjaGVkdWxlcic7XG5pbXBvcnQgJ3N1c3BlbmQtcmVhY3QnO1xuXG5jb25zdCBET01fRVZFTlRTID0ge1xuICBvbkNsaWNrOiBbJ2NsaWNrJywgZmFsc2VdLFxuICBvbkNvbnRleHRNZW51OiBbJ2NvbnRleHRtZW51JywgZmFsc2VdLFxuICBvbkRvdWJsZUNsaWNrOiBbJ2RibGNsaWNrJywgZmFsc2VdLFxuICBvbldoZWVsOiBbJ3doZWVsJywgdHJ1ZV0sXG4gIG9uUG9pbnRlckRvd246IFsncG9pbnRlcmRvd24nLCB0cnVlXSxcbiAgb25Qb2ludGVyVXA6IFsncG9pbnRlcnVwJywgdHJ1ZV0sXG4gIG9uUG9pbnRlckxlYXZlOiBbJ3BvaW50ZXJsZWF2ZScsIHRydWVdLFxuICBvblBvaW50ZXJNb3ZlOiBbJ3BvaW50ZXJtb3ZlJywgdHJ1ZV0sXG4gIG9uUG9pbnRlckNhbmNlbDogWydwb2ludGVyY2FuY2VsJywgdHJ1ZV0sXG4gIG9uTG9zdFBvaW50ZXJDYXB0dXJlOiBbJ2xvc3Rwb2ludGVyY2FwdHVyZScsIHRydWVdXG59O1xuXG4vKiogRGVmYXVsdCBSM0YgZXZlbnQgbWFuYWdlciBmb3Igd2ViICovXG5mdW5jdGlvbiBjcmVhdGVQb2ludGVyRXZlbnRzKHN0b3JlKSB7XG4gIGNvbnN0IHtcbiAgICBoYW5kbGVQb2ludGVyXG4gIH0gPSBjcmVhdGVFdmVudHMoc3RvcmUpO1xuICByZXR1cm4ge1xuICAgIHByaW9yaXR5OiAxLFxuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgY29tcHV0ZShldmVudCwgc3RhdGUsIHByZXZpb3VzKSB7XG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcG1uZHJzL3JlYWN0LXRocmVlLWZpYmVyL3B1bGwvNzgyXG4gICAgICAvLyBFdmVudHMgdHJpZ2dlciBvdXRzaWRlIG9mIGNhbnZhcyB3aGVuIG1vdmVkLCB1c2Ugb2Zmc2V0WC9ZIGJ5IGRlZmF1bHQgYW5kIGFsbG93IG92ZXJyaWRlc1xuICAgICAgc3RhdGUucG9pbnRlci5zZXQoZXZlbnQub2Zmc2V0WCAvIHN0YXRlLnNpemUud2lkdGggKiAyIC0gMSwgLShldmVudC5vZmZzZXRZIC8gc3RhdGUuc2l6ZS5oZWlnaHQpICogMiArIDEpO1xuICAgICAgc3RhdGUucmF5Y2FzdGVyLnNldEZyb21DYW1lcmEoc3RhdGUucG9pbnRlciwgc3RhdGUuY2FtZXJhKTtcbiAgICB9LFxuICAgIGNvbm5lY3RlZDogdW5kZWZpbmVkLFxuICAgIGhhbmRsZXJzOiBPYmplY3Qua2V5cyhET01fRVZFTlRTKS5yZWR1Y2UoKGFjYywga2V5KSA9PiAoe1xuICAgICAgLi4uYWNjLFxuICAgICAgW2tleV06IGhhbmRsZVBvaW50ZXIoa2V5KVxuICAgIH0pLCB7fSksXG4gICAgdXBkYXRlOiAoKSA9PiB7XG4gICAgICB2YXIgX2ludGVybmFsJGxhc3RFdmVudDtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZXZlbnRzLFxuICAgICAgICBpbnRlcm5hbFxuICAgICAgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBpZiAoKF9pbnRlcm5hbCRsYXN0RXZlbnQgPSBpbnRlcm5hbC5sYXN0RXZlbnQpICE9IG51bGwgJiYgX2ludGVybmFsJGxhc3RFdmVudC5jdXJyZW50ICYmIGV2ZW50cy5oYW5kbGVycykgZXZlbnRzLmhhbmRsZXJzLm9uUG9pbnRlck1vdmUoaW50ZXJuYWwubGFzdEV2ZW50LmN1cnJlbnQpO1xuICAgIH0sXG4gICAgY29ubmVjdDogdGFyZ2V0ID0+IHtcbiAgICAgIHZhciBfZXZlbnRzJGhhbmRsZXJzO1xuICAgICAgY29uc3Qge1xuICAgICAgICBzZXQsXG4gICAgICAgIGV2ZW50c1xuICAgICAgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBldmVudHMuZGlzY29ubmVjdCA9PSBudWxsID8gdm9pZCAwIDogZXZlbnRzLmRpc2Nvbm5lY3QoKTtcbiAgICAgIHNldChzdGF0ZSA9PiAoe1xuICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5ldmVudHMsXG4gICAgICAgICAgY29ubmVjdGVkOiB0YXJnZXRcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgICAgT2JqZWN0LmVudHJpZXMoKF9ldmVudHMkaGFuZGxlcnMgPSBldmVudHMuaGFuZGxlcnMpICE9IG51bGwgPyBfZXZlbnRzJGhhbmRsZXJzIDogW10pLmZvckVhY2goKFtuYW1lLCBldmVudF0pID0+IHtcbiAgICAgICAgY29uc3QgW2V2ZW50TmFtZSwgcGFzc2l2ZV0gPSBET01fRVZFTlRTW25hbWVdO1xuICAgICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGV2ZW50LCB7XG4gICAgICAgICAgcGFzc2l2ZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGlzY29ubmVjdDogKCkgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICBzZXQsXG4gICAgICAgIGV2ZW50c1xuICAgICAgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBpZiAoZXZlbnRzLmNvbm5lY3RlZCkge1xuICAgICAgICB2YXIgX2V2ZW50cyRoYW5kbGVyczI7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKChfZXZlbnRzJGhhbmRsZXJzMiA9IGV2ZW50cy5oYW5kbGVycykgIT0gbnVsbCA/IF9ldmVudHMkaGFuZGxlcnMyIDogW10pLmZvckVhY2goKFtuYW1lLCBldmVudF0pID0+IHtcbiAgICAgICAgICBpZiAoZXZlbnRzICYmIGV2ZW50cy5jb25uZWN0ZWQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgW2V2ZW50TmFtZV0gPSBET01fRVZFTlRTW25hbWVdO1xuICAgICAgICAgICAgZXZlbnRzLmNvbm5lY3RlZC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHNldChzdGF0ZSA9PiAoe1xuICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgLi4uc3RhdGUuZXZlbnRzLFxuICAgICAgICAgICAgY29ubmVjdGVkOiB1bmRlZmluZWRcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmNvbnN0IENhbnZhc0ltcGwgPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiBDYW52YXMoe1xuICBjaGlsZHJlbixcbiAgZmFsbGJhY2ssXG4gIHJlc2l6ZSxcbiAgc3R5bGUsXG4gIGdsLFxuICBldmVudHMgPSBjcmVhdGVQb2ludGVyRXZlbnRzLFxuICBldmVudFNvdXJjZSxcbiAgZXZlbnRQcmVmaXgsXG4gIHNoYWRvd3MsXG4gIGxpbmVhcixcbiAgZmxhdCxcbiAgbGVnYWN5LFxuICBvcnRob2dyYXBoaWMsXG4gIGZyYW1lbG9vcCxcbiAgZHByLFxuICBwZXJmb3JtYW5jZSxcbiAgcmF5Y2FzdGVyLFxuICBjYW1lcmEsXG4gIHNjZW5lLFxuICBvblBvaW50ZXJNaXNzZWQsXG4gIG9uQ3JlYXRlZCxcbiAgLi4ucHJvcHNcbn0sIGZvcndhcmRlZFJlZikge1xuICAvLyBDcmVhdGUgYSBrbm93biBjYXRhbG9ndWUgb2YgVGhyZWVqcy1uYXRpdmUgZWxlbWVudHNcbiAgLy8gVGhpcyB3aWxsIGluY2x1ZGUgdGhlIGVudGlyZSBUSFJFRSBuYW1lc3BhY2UgYnkgZGVmYXVsdCwgdXNlcnMgY2FuIGV4dGVuZFxuICAvLyB0aGVpciBvd24gZWxlbWVudHMgYnkgdXNpbmcgdGhlIGNyZWF0ZVJvb3QgQVBJIGluc3RlYWRcbiAgUmVhY3QudXNlTWVtbygoKSA9PiBleHRlbmQoVEhSRUUpLCBbXSk7XG4gIGNvbnN0IEJyaWRnZSA9IHVzZUNvbnRleHRCcmlkZ2UoKTtcbiAgY29uc3QgW2NvbnRhaW5lclJlZiwgY29udGFpbmVyUmVjdF0gPSB1c2VNZWFzdXJlKHtcbiAgICBzY3JvbGw6IHRydWUsXG4gICAgZGVib3VuY2U6IHtcbiAgICAgIHNjcm9sbDogNTAsXG4gICAgICByZXNpemU6IDBcbiAgICB9LFxuICAgIC4uLnJlc2l6ZVxuICB9KTtcbiAgY29uc3QgY2FudmFzUmVmID0gUmVhY3QudXNlUmVmKG51bGwpO1xuICBjb25zdCBkaXZSZWYgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIFJlYWN0LnVzZUltcGVyYXRpdmVIYW5kbGUoZm9yd2FyZGVkUmVmLCAoKSA9PiBjYW52YXNSZWYuY3VycmVudCk7XG4gIGNvbnN0IGhhbmRsZVBvaW50ZXJNaXNzZWQgPSB1c2VNdXRhYmxlQ2FsbGJhY2sob25Qb2ludGVyTWlzc2VkKTtcbiAgY29uc3QgW2Jsb2NrLCBzZXRCbG9ja10gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIFN1c3BlbmQgdGhpcyBjb21wb25lbnQgaWYgYmxvY2sgaXMgYSBwcm9taXNlICgybmQgcnVuKVxuICBpZiAoYmxvY2spIHRocm93IGJsb2NrO1xuICAvLyBUaHJvdyBleGNlcHRpb24gb3V0d2FyZHMgaWYgYW55dGhpbmcgd2l0aGluIGNhbnZhcyB0aHJvd3NcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgY29uc3Qgcm9vdCA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgdXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgY2FudmFzID0gY2FudmFzUmVmLmN1cnJlbnQ7XG4gICAgaWYgKGNvbnRhaW5lclJlY3Qud2lkdGggPiAwICYmIGNvbnRhaW5lclJlY3QuaGVpZ2h0ID4gMCAmJiBjYW52YXMpIHtcbiAgICAgIGlmICghcm9vdC5jdXJyZW50KSByb290LmN1cnJlbnQgPSBjcmVhdGVSb290KGNhbnZhcyk7XG4gICAgICByb290LmN1cnJlbnQuY29uZmlndXJlKHtcbiAgICAgICAgZ2wsXG4gICAgICAgIGV2ZW50cyxcbiAgICAgICAgc2hhZG93cyxcbiAgICAgICAgbGluZWFyLFxuICAgICAgICBmbGF0LFxuICAgICAgICBsZWdhY3ksXG4gICAgICAgIG9ydGhvZ3JhcGhpYyxcbiAgICAgICAgZnJhbWVsb29wLFxuICAgICAgICBkcHIsXG4gICAgICAgIHBlcmZvcm1hbmNlLFxuICAgICAgICByYXljYXN0ZXIsXG4gICAgICAgIGNhbWVyYSxcbiAgICAgICAgc2NlbmUsXG4gICAgICAgIHNpemU6IGNvbnRhaW5lclJlY3QsXG4gICAgICAgIC8vIFBhc3MgbXV0YWJsZSByZWZlcmVuY2UgdG8gb25Qb2ludGVyTWlzc2VkIHNvIGl0J3MgZnJlZSB0byB1cGRhdGVcbiAgICAgICAgb25Qb2ludGVyTWlzc2VkOiAoLi4uYXJncykgPT4gaGFuZGxlUG9pbnRlck1pc3NlZC5jdXJyZW50ID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVQb2ludGVyTWlzc2VkLmN1cnJlbnQoLi4uYXJncyksXG4gICAgICAgIG9uQ3JlYXRlZDogc3RhdGUgPT4ge1xuICAgICAgICAgIC8vIENvbm5lY3QgdG8gZXZlbnQgc291cmNlXG4gICAgICAgICAgc3RhdGUuZXZlbnRzLmNvbm5lY3QgPT0gbnVsbCA/IHZvaWQgMCA6IHN0YXRlLmV2ZW50cy5jb25uZWN0KGV2ZW50U291cmNlID8gaXNSZWYoZXZlbnRTb3VyY2UpID8gZXZlbnRTb3VyY2UuY3VycmVudCA6IGV2ZW50U291cmNlIDogZGl2UmVmLmN1cnJlbnQpO1xuICAgICAgICAgIC8vIFNldCB1cCBjb21wdXRlIGZ1bmN0aW9uXG4gICAgICAgICAgaWYgKGV2ZW50UHJlZml4KSB7XG4gICAgICAgICAgICBzdGF0ZS5zZXRFdmVudHMoe1xuICAgICAgICAgICAgICBjb21wdXRlOiAoZXZlbnQsIHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgeCA9IGV2ZW50W2V2ZW50UHJlZml4ICsgJ1gnXTtcbiAgICAgICAgICAgICAgICBjb25zdCB5ID0gZXZlbnRbZXZlbnRQcmVmaXggKyAnWSddO1xuICAgICAgICAgICAgICAgIHN0YXRlLnBvaW50ZXIuc2V0KHggLyBzdGF0ZS5zaXplLndpZHRoICogMiAtIDEsIC0oeSAvIHN0YXRlLnNpemUuaGVpZ2h0KSAqIDIgKyAxKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShzdGF0ZS5wb2ludGVyLCBzdGF0ZS5jYW1lcmEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gQ2FsbCBvbkNyZWF0ZWQgY2FsbGJhY2tcbiAgICAgICAgICBvbkNyZWF0ZWQgPT0gbnVsbCA/IHZvaWQgMCA6IG9uQ3JlYXRlZChzdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcm9vdC5jdXJyZW50LnJlbmRlciggLyojX19QVVJFX18qL2pzeChCcmlkZ2UsIHtcbiAgICAgICAgY2hpbGRyZW46IC8qI19fUFVSRV9fKi9qc3goRXJyb3JCb3VuZGFyeSwge1xuICAgICAgICAgIHNldDogc2V0RXJyb3IsXG4gICAgICAgICAgY2hpbGRyZW46IC8qI19fUFVSRV9fKi9qc3goUmVhY3QuU3VzcGVuc2UsIHtcbiAgICAgICAgICAgIGZhbGxiYWNrOiAvKiNfX1BVUkVfXyovanN4KEJsb2NrLCB7XG4gICAgICAgICAgICAgIHNldDogc2V0QmxvY2tcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH0pKTtcbiAgICB9XG4gIH0pO1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGNhbnZhcyA9IGNhbnZhc1JlZi5jdXJyZW50O1xuICAgIGlmIChjYW52YXMpIHJldHVybiAoKSA9PiB1bm1vdW50Q29tcG9uZW50QXROb2RlKGNhbnZhcyk7XG4gIH0sIFtdKTtcblxuICAvLyBXaGVuIHRoZSBldmVudCBzb3VyY2UgaXMgbm90IHRoaXMgZGl2LCB3ZSBuZWVkIHRvIHNldCBwb2ludGVyLWV2ZW50cyB0byBub25lXG4gIC8vIE9yIGVsc2UgdGhlIGNhbnZhcyB3aWxsIGJsb2NrIGV2ZW50cyBmcm9tIHJlYWNoaW5nIHRoZSBldmVudCBzb3VyY2VcbiAgY29uc3QgcG9pbnRlckV2ZW50cyA9IGV2ZW50U291cmNlID8gJ25vbmUnIDogJ2F1dG8nO1xuICByZXR1cm4gLyojX19QVVJFX18qL2pzeChcImRpdlwiLCB7XG4gICAgcmVmOiBkaXZSZWYsXG4gICAgc3R5bGU6IHtcbiAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIGhlaWdodDogJzEwMCUnLFxuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgICAgcG9pbnRlckV2ZW50cyxcbiAgICAgIC4uLnN0eWxlXG4gICAgfSxcbiAgICAuLi5wcm9wcyxcbiAgICBjaGlsZHJlbjogLyojX19QVVJFX18qL2pzeChcImRpdlwiLCB7XG4gICAgICByZWY6IGNvbnRhaW5lclJlZixcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICAgIGhlaWdodDogJzEwMCUnXG4gICAgICB9LFxuICAgICAgY2hpbGRyZW46IC8qI19fUFVSRV9fKi9qc3goXCJjYW52YXNcIiwge1xuICAgICAgICByZWY6IGNhbnZhc1JlZixcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICAgIH0sXG4gICAgICAgIGNoaWxkcmVuOiBmYWxsYmFja1xuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbn0pO1xuXG4vKipcclxuICogQSBET00gY2FudmFzIHdoaWNoIGFjY2VwdHMgdGhyZWVqcyBlbGVtZW50cyBhcyBjaGlsZHJlbi5cclxuICogQHNlZSBodHRwczovL2RvY3MucG1uZC5ycy9yZWFjdC10aHJlZS1maWJlci9hcGkvY2FudmFzXHJcbiAqL1xuY29uc3QgQ2FudmFzID0gLyojX19QVVJFX18qL1JlYWN0LmZvcndhcmRSZWYoZnVuY3Rpb24gQ2FudmFzV3JhcHBlcihwcm9wcywgcmVmKSB7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovanN4KEZpYmVyUHJvdmlkZXIsIHtcbiAgICBjaGlsZHJlbjogLyojX19QVVJFX18qL2pzeChDYW52YXNJbXBsLCB7XG4gICAgICAuLi5wcm9wcyxcbiAgICAgIHJlZjogcmVmXG4gICAgfSlcbiAgfSk7XG59KTtcblxuZXhwb3J0IHsgQ2FudmFzLCBjcmVhdGVQb2ludGVyRXZlbnRzIGFzIGV2ZW50cyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/fiber/dist/react-three-fiber.esm.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@react-three/fiber/node_modules/zustand/esm/index.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@react-three/fiber/node_modules/zustand/esm/index.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ create)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n\n\nfunction createStore(createState) {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (nextState !== state) {\n      const previousState = state;\n      state = replace ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const subscribeWithSelector = (listener, selector = getState, equalityFn = Object.is) => {\n    console.warn(\"[DEPRECATED] Please use `subscribeWithSelector` middleware\");\n    let currentSlice = selector(state);\n    function listenerToAdd() {\n      const nextSlice = selector(state);\n      if (!equalityFn(currentSlice, nextSlice)) {\n        const previousSlice = currentSlice;\n        listener(currentSlice = nextSlice, previousSlice);\n      }\n    }\n    listeners.add(listenerToAdd);\n    return () => listeners.delete(listenerToAdd);\n  };\n  const subscribe = (listener, selector, equalityFn) => {\n    if (selector || equalityFn) {\n      return subscribeWithSelector(listener, selector, equalityFn);\n    }\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => listeners.clear();\n  const api = { setState, getState, subscribe, destroy };\n  state = createState(setState, getState, api);\n  return api;\n}\n\nconst isSSR = typeof window === \"undefined\" || !window.navigator || /ServerSideRendering|^Deno\\//.test(window.navigator.userAgent);\nconst useIsomorphicLayoutEffect = isSSR ? react__WEBPACK_IMPORTED_MODULE_0__.useEffect : react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect;\nfunction create(createState) {\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useStore = (selector = api.getState, equalityFn = Object.is) => {\n    const [, forceUpdate] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useReducer)((c) => c + 1, 0);\n    const state = api.getState();\n    const stateRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(state);\n    const selectorRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(selector);\n    const equalityFnRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(equalityFn);\n    const erroredRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    const currentSliceRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();\n    if (currentSliceRef.current === void 0) {\n      currentSliceRef.current = selector(state);\n    }\n    let newStateSlice;\n    let hasNewStateSlice = false;\n    if (stateRef.current !== state || selectorRef.current !== selector || equalityFnRef.current !== equalityFn || erroredRef.current) {\n      newStateSlice = selector(state);\n      hasNewStateSlice = !equalityFn(currentSliceRef.current, newStateSlice);\n    }\n    useIsomorphicLayoutEffect(() => {\n      if (hasNewStateSlice) {\n        currentSliceRef.current = newStateSlice;\n      }\n      stateRef.current = state;\n      selectorRef.current = selector;\n      equalityFnRef.current = equalityFn;\n      erroredRef.current = false;\n    });\n    const stateBeforeSubscriptionRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(state);\n    useIsomorphicLayoutEffect(() => {\n      const listener = () => {\n        try {\n          const nextState = api.getState();\n          const nextStateSlice = selectorRef.current(nextState);\n          if (!equalityFnRef.current(currentSliceRef.current, nextStateSlice)) {\n            stateRef.current = nextState;\n            currentSliceRef.current = nextStateSlice;\n            forceUpdate();\n          }\n        } catch (error) {\n          erroredRef.current = true;\n          forceUpdate();\n        }\n      };\n      const unsubscribe = api.subscribe(listener);\n      if (api.getState() !== stateBeforeSubscriptionRef.current) {\n        listener();\n      }\n      return unsubscribe;\n    }, []);\n    const sliceToReturn = hasNewStateSlice ? newStateSlice : currentSliceRef.current;\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useDebugValue)(sliceToReturn);\n    return sliceToReturn;\n  };\n  Object.assign(useStore, api);\n  useStore[Symbol.iterator] = function() {\n    console.warn(\"[useStore, api] = create() is deprecated and will be removed in v4\");\n    const items = [useStore, api];\n    return {\n      next() {\n        const done = items.length <= 0;\n        return { value: items.shift(), done };\n      }\n    };\n  };\n  return useStore;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHJlYWN0LXRocmVlL2ZpYmVyL25vZGVfbW9kdWxlcy96dXN0YW5kL2VzbS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0Y7O0FBRXRGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDBDQUEwQyw0Q0FBUyxHQUFHLGtEQUFlO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixpREFBVTtBQUN0QztBQUNBLHFCQUFxQiw2Q0FBTTtBQUMzQix3QkFBd0IsNkNBQU07QUFDOUIsMEJBQTBCLDZDQUFNO0FBQ2hDLHVCQUF1Qiw2Q0FBTTtBQUM3Qiw0QkFBNEIsNkNBQU07QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCx1Q0FBdUMsNkNBQU07QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsSUFBSSxvREFBYTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW5qeW90aS1sZWFybmluZy8uL25vZGVfbW9kdWxlcy9AcmVhY3QtdGhyZWUvZmliZXIvbm9kZV9tb2R1bGVzL3p1c3RhbmQvZXNtL2luZGV4LmpzPzlhNTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUmVkdWNlciwgdXNlUmVmLCB1c2VEZWJ1Z1ZhbHVlLCB1c2VFZmZlY3QsIHVzZUxheW91dEVmZmVjdCB9IGZyb20gJ3JlYWN0JztcblxuZnVuY3Rpb24gY3JlYXRlU3RvcmUoY3JlYXRlU3RhdGUpIHtcbiAgbGV0IHN0YXRlO1xuICBjb25zdCBsaXN0ZW5lcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCBzZXRTdGF0ZSA9IChwYXJ0aWFsLCByZXBsYWNlKSA9PiB7XG4gICAgY29uc3QgbmV4dFN0YXRlID0gdHlwZW9mIHBhcnRpYWwgPT09IFwiZnVuY3Rpb25cIiA/IHBhcnRpYWwoc3RhdGUpIDogcGFydGlhbDtcbiAgICBpZiAobmV4dFN0YXRlICE9PSBzdGF0ZSkge1xuICAgICAgY29uc3QgcHJldmlvdXNTdGF0ZSA9IHN0YXRlO1xuICAgICAgc3RhdGUgPSByZXBsYWNlID8gbmV4dFN0YXRlIDogT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIG5leHRTdGF0ZSk7XG4gICAgICBsaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKHN0YXRlLCBwcmV2aW91c1N0YXRlKSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBnZXRTdGF0ZSA9ICgpID0+IHN0YXRlO1xuICBjb25zdCBzdWJzY3JpYmVXaXRoU2VsZWN0b3IgPSAobGlzdGVuZXIsIHNlbGVjdG9yID0gZ2V0U3RhdGUsIGVxdWFsaXR5Rm4gPSBPYmplY3QuaXMpID0+IHtcbiAgICBjb25zb2xlLndhcm4oXCJbREVQUkVDQVRFRF0gUGxlYXNlIHVzZSBgc3Vic2NyaWJlV2l0aFNlbGVjdG9yYCBtaWRkbGV3YXJlXCIpO1xuICAgIGxldCBjdXJyZW50U2xpY2UgPSBzZWxlY3RvcihzdGF0ZSk7XG4gICAgZnVuY3Rpb24gbGlzdGVuZXJUb0FkZCgpIHtcbiAgICAgIGNvbnN0IG5leHRTbGljZSA9IHNlbGVjdG9yKHN0YXRlKTtcbiAgICAgIGlmICghZXF1YWxpdHlGbihjdXJyZW50U2xpY2UsIG5leHRTbGljZSkpIHtcbiAgICAgICAgY29uc3QgcHJldmlvdXNTbGljZSA9IGN1cnJlbnRTbGljZTtcbiAgICAgICAgbGlzdGVuZXIoY3VycmVudFNsaWNlID0gbmV4dFNsaWNlLCBwcmV2aW91c1NsaWNlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgbGlzdGVuZXJzLmFkZChsaXN0ZW5lclRvQWRkKTtcbiAgICByZXR1cm4gKCkgPT4gbGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lclRvQWRkKTtcbiAgfTtcbiAgY29uc3Qgc3Vic2NyaWJlID0gKGxpc3RlbmVyLCBzZWxlY3RvciwgZXF1YWxpdHlGbikgPT4ge1xuICAgIGlmIChzZWxlY3RvciB8fCBlcXVhbGl0eUZuKSB7XG4gICAgICByZXR1cm4gc3Vic2NyaWJlV2l0aFNlbGVjdG9yKGxpc3RlbmVyLCBzZWxlY3RvciwgZXF1YWxpdHlGbik7XG4gICAgfVxuICAgIGxpc3RlbmVycy5hZGQobGlzdGVuZXIpO1xuICAgIHJldHVybiAoKSA9PiBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgfTtcbiAgY29uc3QgZGVzdHJveSA9ICgpID0+IGxpc3RlbmVycy5jbGVhcigpO1xuICBjb25zdCBhcGkgPSB7IHNldFN0YXRlLCBnZXRTdGF0ZSwgc3Vic2NyaWJlLCBkZXN0cm95IH07XG4gIHN0YXRlID0gY3JlYXRlU3RhdGUoc2V0U3RhdGUsIGdldFN0YXRlLCBhcGkpO1xuICByZXR1cm4gYXBpO1xufVxuXG5jb25zdCBpc1NTUiA9IHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgfHwgIXdpbmRvdy5uYXZpZ2F0b3IgfHwgL1NlcnZlclNpZGVSZW5kZXJpbmd8XkRlbm9cXC8vLnRlc3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xuY29uc3QgdXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdCA9IGlzU1NSID8gdXNlRWZmZWN0IDogdXNlTGF5b3V0RWZmZWN0O1xuZnVuY3Rpb24gY3JlYXRlKGNyZWF0ZVN0YXRlKSB7XG4gIGNvbnN0IGFwaSA9IHR5cGVvZiBjcmVhdGVTdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gY3JlYXRlU3RvcmUoY3JlYXRlU3RhdGUpIDogY3JlYXRlU3RhdGU7XG4gIGNvbnN0IHVzZVN0b3JlID0gKHNlbGVjdG9yID0gYXBpLmdldFN0YXRlLCBlcXVhbGl0eUZuID0gT2JqZWN0LmlzKSA9PiB7XG4gICAgY29uc3QgWywgZm9yY2VVcGRhdGVdID0gdXNlUmVkdWNlcigoYykgPT4gYyArIDEsIDApO1xuICAgIGNvbnN0IHN0YXRlID0gYXBpLmdldFN0YXRlKCk7XG4gICAgY29uc3Qgc3RhdGVSZWYgPSB1c2VSZWYoc3RhdGUpO1xuICAgIGNvbnN0IHNlbGVjdG9yUmVmID0gdXNlUmVmKHNlbGVjdG9yKTtcbiAgICBjb25zdCBlcXVhbGl0eUZuUmVmID0gdXNlUmVmKGVxdWFsaXR5Rm4pO1xuICAgIGNvbnN0IGVycm9yZWRSZWYgPSB1c2VSZWYoZmFsc2UpO1xuICAgIGNvbnN0IGN1cnJlbnRTbGljZVJlZiA9IHVzZVJlZigpO1xuICAgIGlmIChjdXJyZW50U2xpY2VSZWYuY3VycmVudCA9PT0gdm9pZCAwKSB7XG4gICAgICBjdXJyZW50U2xpY2VSZWYuY3VycmVudCA9IHNlbGVjdG9yKHN0YXRlKTtcbiAgICB9XG4gICAgbGV0IG5ld1N0YXRlU2xpY2U7XG4gICAgbGV0IGhhc05ld1N0YXRlU2xpY2UgPSBmYWxzZTtcbiAgICBpZiAoc3RhdGVSZWYuY3VycmVudCAhPT0gc3RhdGUgfHwgc2VsZWN0b3JSZWYuY3VycmVudCAhPT0gc2VsZWN0b3IgfHwgZXF1YWxpdHlGblJlZi5jdXJyZW50ICE9PSBlcXVhbGl0eUZuIHx8IGVycm9yZWRSZWYuY3VycmVudCkge1xuICAgICAgbmV3U3RhdGVTbGljZSA9IHNlbGVjdG9yKHN0YXRlKTtcbiAgICAgIGhhc05ld1N0YXRlU2xpY2UgPSAhZXF1YWxpdHlGbihjdXJyZW50U2xpY2VSZWYuY3VycmVudCwgbmV3U3RhdGVTbGljZSk7XG4gICAgfVxuICAgIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgICAgaWYgKGhhc05ld1N0YXRlU2xpY2UpIHtcbiAgICAgICAgY3VycmVudFNsaWNlUmVmLmN1cnJlbnQgPSBuZXdTdGF0ZVNsaWNlO1xuICAgICAgfVxuICAgICAgc3RhdGVSZWYuY3VycmVudCA9IHN0YXRlO1xuICAgICAgc2VsZWN0b3JSZWYuY3VycmVudCA9IHNlbGVjdG9yO1xuICAgICAgZXF1YWxpdHlGblJlZi5jdXJyZW50ID0gZXF1YWxpdHlGbjtcbiAgICAgIGVycm9yZWRSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgIH0pO1xuICAgIGNvbnN0IHN0YXRlQmVmb3JlU3Vic2NyaXB0aW9uUmVmID0gdXNlUmVmKHN0YXRlKTtcbiAgICB1c2VJc29tb3JwaGljTGF5b3V0RWZmZWN0KCgpID0+IHtcbiAgICAgIGNvbnN0IGxpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IG5leHRTdGF0ZSA9IGFwaS5nZXRTdGF0ZSgpO1xuICAgICAgICAgIGNvbnN0IG5leHRTdGF0ZVNsaWNlID0gc2VsZWN0b3JSZWYuY3VycmVudChuZXh0U3RhdGUpO1xuICAgICAgICAgIGlmICghZXF1YWxpdHlGblJlZi5jdXJyZW50KGN1cnJlbnRTbGljZVJlZi5jdXJyZW50LCBuZXh0U3RhdGVTbGljZSkpIHtcbiAgICAgICAgICAgIHN0YXRlUmVmLmN1cnJlbnQgPSBuZXh0U3RhdGU7XG4gICAgICAgICAgICBjdXJyZW50U2xpY2VSZWYuY3VycmVudCA9IG5leHRTdGF0ZVNsaWNlO1xuICAgICAgICAgICAgZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgZXJyb3JlZFJlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgICBmb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSBhcGkuc3Vic2NyaWJlKGxpc3RlbmVyKTtcbiAgICAgIGlmIChhcGkuZ2V0U3RhdGUoKSAhPT0gc3RhdGVCZWZvcmVTdWJzY3JpcHRpb25SZWYuY3VycmVudCkge1xuICAgICAgICBsaXN0ZW5lcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVuc3Vic2NyaWJlO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBzbGljZVRvUmV0dXJuID0gaGFzTmV3U3RhdGVTbGljZSA/IG5ld1N0YXRlU2xpY2UgOiBjdXJyZW50U2xpY2VSZWYuY3VycmVudDtcbiAgICB1c2VEZWJ1Z1ZhbHVlKHNsaWNlVG9SZXR1cm4pO1xuICAgIHJldHVybiBzbGljZVRvUmV0dXJuO1xuICB9O1xuICBPYmplY3QuYXNzaWduKHVzZVN0b3JlLCBhcGkpO1xuICB1c2VTdG9yZVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS53YXJuKFwiW3VzZVN0b3JlLCBhcGldID0gY3JlYXRlKCkgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHY0XCIpO1xuICAgIGNvbnN0IGl0ZW1zID0gW3VzZVN0b3JlLCBhcGldO1xuICAgIHJldHVybiB7XG4gICAgICBuZXh0KCkge1xuICAgICAgICBjb25zdCBkb25lID0gaXRlbXMubGVuZ3RoIDw9IDA7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiBpdGVtcy5zaGlmdCgpLCBkb25lIH07XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgcmV0dXJuIHVzZVN0b3JlO1xufVxuXG5leHBvcnQgeyBjcmVhdGUgYXMgZGVmYXVsdCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@react-three/fiber/node_modules/zustand/esm/index.js\n");

/***/ })

};
;